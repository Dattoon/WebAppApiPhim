2025-05-24 14:54:12.132 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 14:54:15.848 +07:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 14:54:15.938 +07:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 14:54:15.949 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 14:54:15.959 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 14:54:15.999 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 14:54:16.041 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 14:54:16.386 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 14:54:16.434 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 14:54:16.446 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 14:54:16.611 +07:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 14:54:16.703 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 14:54:16.710 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 14:54:16.746 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 14:54:17.193 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 14:54:17.198 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 14:54:17.203 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 14:54:17.217 +07:00 [INF] Performance Metrics - WorkingSet: 133.79MB, PrivateMemory: 72.81MB, GC Memory: 20.96MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 14:54:17.224 +07:00 [INF] MovieCacheService is starting.
2025-05-24 14:54:17.227 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 14:54:17.633 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 14:54:17.635 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 14:54:17.637 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 14:54:17.638 +07:00 [INF] Hosting environment: Development
2025-05-24 14:54:17.640 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 14:54:19.417 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 14:54:19.830 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 425.7546ms
2025-05-24 14:54:19.941 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 14:54:19.941 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 14:54:19.941 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 14:54:19.966 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 26.9878ms
2025-05-24 14:54:20.003 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 62.0661ms
2025-05-24 14:54:20.090 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 151.0264ms
2025-05-24 14:54:20.174 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 14:54:20.467 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 293.7864ms
2025-05-24 14:54:36.523 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - null null
2025-05-24 14:54:36.548 +07:00 [INF] HTTP Request - RequestId: d6a42a0f-829a-433e-9d8c-2874b3bfe547, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:54:36.743 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 14:54:36.787 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:54:36.863 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=2
2025-05-24 14:54:36.876 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:54:36.907 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:54:37.244 +07:00 [INF] Received HTTP response headers after 329.7611ms - 200
2025-05-24 14:54:37.255 +07:00 [INF] End processing HTTP request after 386.1363ms - 200
2025-05-24 14:54:37.360 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:54:37.365 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:54:37.367 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:54:37.475 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:54:37.480 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:54:37.482 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:54:37.691 +07:00 [INF] Received HTTP response headers after 321.324ms - 200
2025-05-24 14:54:37.693 +07:00 [INF] End processing HTTP request after 328.629ms - 200
2025-05-24 14:54:37.702 +07:00 [INF] Fetched image for trieu-duong-chi-vu-da from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:54:37.799 +07:00 [INF] Received HTTP response headers after 314.3279ms - 200
2025-05-24 14:54:37.802 +07:00 [INF] End processing HTTP request after 322.0159ms - 200
2025-05-24 14:54:37.804 +07:00 [INF] Fetched image for ba-lan-ga-cho-ma-quan from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:54:37.807 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 14:54:37.819 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:54:37.869 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 1073.6326ms
2025-05-24 14:54:37.872 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 14:54:37.879 +07:00 [INF] HTTP Response - RequestId: d6a42a0f-829a-433e-9d8c-2874b3bfe547, StatusCode: 200, ContentLength: null, ElapsedMs: 1338
2025-05-24 14:54:37.886 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - 200 null application/json; charset=utf-8 1362.8515ms
2025-05-24 14:54:47.546 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Health - null null
2025-05-24 14:54:47.556 +07:00 [INF] HTTP Request - RequestId: 64dd9cd9-408e-4461-8d5b-ff12964989af, Method: GET, Path: /api/Health, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:54:47.564 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.HealthController.GetHealth (WebAppApiPhim)'
2025-05-24 14:54:47.571 +07:00 [INF] Route matched with {action = "GetHealth", controller = "Health"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHealth() on controller WebAppApiPhim.Controllers.HealthController (WebAppApiPhim).
2025-05-24 14:54:47.619 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:54:47.635 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:54:47.638 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 14:54:47.662 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1
2025-05-24 14:54:47.666 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1
2025-05-24 14:54:47.676 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 14:54:47.780 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [CachedMovies] AS [c]
2025-05-24 14:54:47.885 +07:00 [INF] Received HTTP response headers after 237.8371ms - 200
2025-05-24 14:54:47.889 +07:00 [INF] End processing HTTP request after 269.9686ms - 200
2025-05-24 14:54:47.900 +07:00 [INF] Received HTTP response headers after 229.829ms - 200
2025-05-24 14:54:47.903 +07:00 [INF] End processing HTTP request after 240.5628ms - 200
2025-05-24 14:54:48.060 +07:00 [INF] Executed action WebAppApiPhim.Controllers.HealthController.GetHealth (WebAppApiPhim) in 485.279ms
2025-05-24 14:54:48.064 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.HealthController.GetHealth (WebAppApiPhim)'
2025-05-24 14:54:48.279 +07:00 [ERR] Unhandled exception occurred. RequestId: 64dd9cd9-408e-4461-8d5b-ff12964989af
System.InvalidOperationException: Unable to resolve service for type 'Microsoft.Extensions.Caching.Distributed.IDistributedCache' while attempting to activate 'WebAppApiPhim.HealthChecks.RedisHealthCheck'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance[T](IServiceProvider provider)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.RunCheckAsync(HealthCheckRegistration registration, CancellationToken cancellationToken)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.RunCheckAsync(HealthCheckRegistration registration, CancellationToken cancellationToken)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.CheckHealthAsync(Func`2 predicate, CancellationToken cancellationToken)
   at WebAppApiPhim.Controllers.HealthController.GetHealth() in C:\D\Leaning\API\APICode\WebAppApiPhim\Controllers\HealthController.cs:line 25
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at WebAppApiPhim.Middleware.RateLimitingMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\RateLimitingMiddleware.cs:line 47
   at WebAppApiPhim.Middleware.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\RequestLoggingMiddleware.cs:line 44
2025-05-24 14:54:48.412 +07:00 [INF] HTTP Response - RequestId: 64dd9cd9-408e-4461-8d5b-ff12964989af, StatusCode: 200, ContentLength: null, ElapsedMs: 857
2025-05-24 14:54:48.695 +07:00 [ERR] An unhandled exception occurred
System.InvalidOperationException: Unable to resolve service for type 'Microsoft.Extensions.Caching.Distributed.IDistributedCache' while attempting to activate 'WebAppApiPhim.HealthChecks.RedisHealthCheck'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance(IServiceProvider provider, Type type)
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetServiceOrCreateInstance[T](IServiceProvider provider)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.RunCheckAsync(HealthCheckRegistration registration, CancellationToken cancellationToken)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.RunCheckAsync(HealthCheckRegistration registration, CancellationToken cancellationToken)
   at Microsoft.Extensions.Diagnostics.HealthChecks.DefaultHealthCheckService.CheckHealthAsync(Func`2 predicate, CancellationToken cancellationToken)
   at WebAppApiPhim.Controllers.HealthController.GetHealth() in C:\D\Leaning\API\APICode\WebAppApiPhim\Controllers\HealthController.cs:line 25
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at WebAppApiPhim.Middleware.RateLimitingMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\RateLimitingMiddleware.cs:line 47
   at WebAppApiPhim.Middleware.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\RequestLoggingMiddleware.cs:line 44
   at WebAppApiPhim.Middleware.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\RequestLoggingMiddleware.cs:line 61
   at WebAppApiPhim.Middleware.PerformanceMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\PerformanceMiddleware.cs:line 28
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 26
2025-05-24 14:54:48.924 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.HandleExceptionAsync(HttpContext context, Exception exception) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 111
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 31
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-24 14:54:48.941 +07:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-24 14:54:48.949 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.HandleExceptionAsync(HttpContext context, Exception exception) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 111
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 31
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-24 14:54:48.962 +07:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-24 14:54:48.973 +07:00 [ERR] Connection id "0HNCQJ0NP9TNQ", Request id "0HNCQJ0NP9TNQ:00000001": An unhandled exception was thrown by the application.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.HandleExceptionAsync(HttpContext context, Exception exception) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 111
   at WebAppApiPhim.Middleware.GlobalExceptionMiddleware.InvokeAsync(HttpContext context) in C:\D\Leaning\API\APICode\WebAppApiPhim\Middleware\GlobalExceptionMiddleware.cs:line 31
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.WebTools.BrowserLink.Net.BrowserLinkMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-24 14:54:49.010 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Health - 500 0 null 1463.766ms
2025-05-24 14:55:04.793 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Health/ping - null null
2025-05-24 14:55:04.801 +07:00 [INF] HTTP Request - RequestId: 6707d6e7-8289-4285-8e22-098458501955, Method: GET, Path: /api/Health/ping, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:04.809 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.HealthController.Ping (WebAppApiPhim)'
2025-05-24 14:55:04.812 +07:00 [INF] Route matched with {action = "Ping", controller = "Health"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Ping() on controller WebAppApiPhim.Controllers.HealthController (WebAppApiPhim).
2025-05-24 14:55:04.817 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:55:04.830 +07:00 [INF] Executed action WebAppApiPhim.Controllers.HealthController.Ping (WebAppApiPhim) in 14.4526ms
2025-05-24 14:55:04.833 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.HealthController.Ping (WebAppApiPhim)'
2025-05-24 14:55:04.835 +07:00 [INF] HTTP Response - RequestId: 6707d6e7-8289-4285-8e22-098458501955, StatusCode: 200, ContentLength: null, ElapsedMs: 33
2025-05-24 14:55:04.838 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Health/ping - 200 null application/json; charset=utf-8 46.293ms
2025-05-24 14:55:16.250 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Metadata/genres - null null
2025-05-24 14:55:16.257 +07:00 [INF] HTTP Request - RequestId: 1b87338d-cef6-41dc-b607-76c339bb8b36, Method: GET, Path: /api/Metadata/genres, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:16.262 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MetadataController.GetGenres (WebAppApiPhim)'
2025-05-24 14:55:16.270 +07:00 [INF] Route matched with {action = "GetGenres", controller = "Metadata"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[System.String]]]] GetGenres() on controller WebAppApiPhim.Controllers.MetadataController (WebAppApiPhim).
2025-05-24 14:55:16.304 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[Name]
FROM [Genres] AS [g]
WHERE [g].[IsActive] = CAST(1 AS bit)
2025-05-24 14:55:16.311 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:55:16.316 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MetadataController.GetGenres (WebAppApiPhim) in 42.1571ms
2025-05-24 14:55:16.318 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MetadataController.GetGenres (WebAppApiPhim)'
2025-05-24 14:55:16.321 +07:00 [INF] HTTP Response - RequestId: 1b87338d-cef6-41dc-b607-76c339bb8b36, StatusCode: 200, ContentLength: null, ElapsedMs: 63
2025-05-24 14:55:16.324 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Metadata/genres - 200 null application/json; charset=utf-8 75.2147ms
2025-05-24 14:55:25.407 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Metadata/countries - null null
2025-05-24 14:55:25.417 +07:00 [INF] HTTP Request - RequestId: 7c13d1fa-9ff9-4af2-834a-fed475678509, Method: GET, Path: /api/Metadata/countries, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:25.423 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MetadataController.GetCountries (WebAppApiPhim)'
2025-05-24 14:55:25.431 +07:00 [INF] Route matched with {action = "GetCountries", controller = "Metadata"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[System.String]]]] GetCountries() on controller WebAppApiPhim.Controllers.MetadataController (WebAppApiPhim).
2025-05-24 14:55:25.449 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name]
FROM [Countries] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-05-24 14:55:25.457 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:55:25.460 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MetadataController.GetCountries (WebAppApiPhim) in 25.9571ms
2025-05-24 14:55:25.464 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MetadataController.GetCountries (WebAppApiPhim)'
2025-05-24 14:55:25.467 +07:00 [INF] HTTP Response - RequestId: 7c13d1fa-9ff9-4af2-834a-fed475678509, StatusCode: 200, ContentLength: null, ElapsedMs: 49
2025-05-24 14:55:25.471 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Metadata/countries - 200 null application/json; charset=utf-8 64.3652ms
2025-05-24 14:55:32.319 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Metadata/years - null null
2025-05-24 14:55:32.325 +07:00 [INF] HTTP Request - RequestId: 37a915ee-61ad-4b30-b748-bb6a5be995cb, Method: GET, Path: /api/Metadata/years, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:32.330 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MetadataController.GetYears (WebAppApiPhim)'
2025-05-24 14:55:32.338 +07:00 [INF] Route matched with {action = "GetYears", controller = "Metadata"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[System.String]]]] GetYears() on controller WebAppApiPhim.Controllers.MetadataController (WebAppApiPhim).
2025-05-24 14:55:32.345 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:55:32.349 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MetadataController.GetYears (WebAppApiPhim) in 7.3153ms
2025-05-24 14:55:32.352 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MetadataController.GetYears (WebAppApiPhim)'
2025-05-24 14:55:32.355 +07:00 [INF] HTTP Response - RequestId: 37a915ee-61ad-4b30-b748-bb6a5be995cb, StatusCode: 200, ContentLength: null, ElapsedMs: 30
2025-05-24 14:55:32.359 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Metadata/years - 200 null application/json; charset=utf-8 40.234ms
2025-05-24 14:55:39.469 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Metadata/types - null null
2025-05-24 14:55:39.475 +07:00 [INF] HTTP Request - RequestId: 95b662c4-9402-4a74-8525-440fb7c55dba, Method: GET, Path: /api/Metadata/types, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:39.480 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MetadataController.GetMovieTypes (WebAppApiPhim)'
2025-05-24 14:55:39.486 +07:00 [INF] Route matched with {action = "GetMovieTypes", controller = "Metadata"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[System.String]]]] GetMovieTypes() on controller WebAppApiPhim.Controllers.MetadataController (WebAppApiPhim).
2025-05-24 14:55:39.502 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Name]
FROM [MovieTypes] AS [m]
WHERE [m].[IsActive] = CAST(1 AS bit)
2025-05-24 14:55:39.510 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:55:39.513 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MetadataController.GetMovieTypes (WebAppApiPhim) in 22.5148ms
2025-05-24 14:55:39.515 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MetadataController.GetMovieTypes (WebAppApiPhim)'
2025-05-24 14:55:39.518 +07:00 [INF] HTTP Response - RequestId: 95b662c4-9402-4a74-8525-440fb7c55dba, StatusCode: 200, ContentLength: null, ElapsedMs: 43
2025-05-24 14:55:39.522 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Metadata/types - 200 null application/json; charset=utf-8 53.0359ms
2025-05-24 14:55:48.123 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Metadata/all - null null
2025-05-24 14:55:48.130 +07:00 [INF] HTTP Request - RequestId: c742cecc-09f6-4e0a-ba43-614ccdbfde6a, Method: GET, Path: /api/Metadata/all, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:48.134 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MetadataController.GetAllMetadata (WebAppApiPhim)'
2025-05-24 14:55:48.141 +07:00 [INF] Route matched with {action = "GetAllMetadata", controller = "Metadata"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Controllers.MetadataResponse]]] GetAllMetadata() on controller WebAppApiPhim.Controllers.MetadataController (WebAppApiPhim).
2025-05-24 14:55:48.148 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Controllers.MetadataResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:55:48.155 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MetadataController.GetAllMetadata (WebAppApiPhim) in 9.9699ms
2025-05-24 14:55:48.157 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MetadataController.GetAllMetadata (WebAppApiPhim)'
2025-05-24 14:55:48.159 +07:00 [INF] HTTP Response - RequestId: c742cecc-09f6-4e0a-ba43-614ccdbfde6a, StatusCode: 200, ContentLength: null, ElapsedMs: 29
2025-05-24 14:55:48.163 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Metadata/all - 200 null application/json; charset=utf-8 40.2598ms
2025-05-24 14:55:58.157 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - null null
2025-05-24 14:55:58.164 +07:00 [INF] HTTP Request - RequestId: 504459db-8b5c-4f09-9341-035d90448766, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:55:58.169 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 14:55:58.171 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:55:58.177 +07:00 [INF] Cache hit for latest_movies_1_2
2025-05-24 14:55:58.179 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:55:58.182 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 7.0691ms
2025-05-24 14:55:58.184 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 14:55:58.186 +07:00 [INF] HTTP Response - RequestId: 504459db-8b5c-4f09-9341-035d90448766, StatusCode: 200, ContentLength: null, ElapsedMs: 21
2025-05-24 14:55:58.189 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - 200 null application/json; charset=utf-8 32.4219ms
2025-05-24 14:56:19.585 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me - null null
2025-05-24 14:56:19.591 +07:00 [INF] HTTP Request - RequestId: 9204ae11-7c29-42c4-92d1-611d285adde9, Method: GET, Path: /api/Movies/con-trai-ban-me, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:56:19.596 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 14:56:19.605 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:56:19.642 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:56:19.647 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=con-trai-ban-me
2025-05-24 14:56:19.649 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:56:19.651 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:56:21.960 +07:00 [INF] Received HTTP response headers after 2306.5857ms - 200
2025-05-24 14:56:21.963 +07:00 [INF] End processing HTTP request after 2314.0343ms - 200
2025-05-24 14:56:22.100 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 939.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 939.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:56:22.109 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=con-trai-ban-me
2025-05-24 14:56:22.111 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:56:22.113 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:56:22.442 +07:00 [INF] Received HTTP response headers after 326.3497ms - 200
2025-05-24 14:56:22.444 +07:00 [INF] End processing HTTP request after 333.423ms - 200
2025-05-24 14:56:22.619 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:56:23.003 +07:00 [INF] Executed DbCommand (46ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (DbType = Double), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32), @p21='?' (DbType = DateTime2), @p22='?' (Size = 500), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-05-24 14:56:23.057 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:56:23.178 +07:00 [ERR] Error storing movie con-trai-ban-me in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:56:23.294 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:56:23.312 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=con-trai-ban-me
2025-05-24 14:56:23.314 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:56:23.317 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:56:23.643 +07:00 [INF] Received HTTP response headers after 324.0127ms - 200
2025-05-24 14:56:23.646 +07:00 [INF] End processing HTTP request after 332.0543ms - 200
2025-05-24 14:56:23.657 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:56:23.730 +07:00 [ERR] Error storing movie con-trai-ban-me in database
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:56:23.823 +07:00 [WRN] Error fetching movie detail with v2: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:56:23.831 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: con-trai-ban-me
2025-05-24 14:56:23.833 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:56:23.848 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 4239.3169ms
2025-05-24 14:56:23.851 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 14:56:23.853 +07:00 [INF] HTTP Response - RequestId: 9204ae11-7c29-42c4-92d1-611d285adde9, StatusCode: 404, ContentLength: null, ElapsedMs: 4261
2025-05-24 14:56:23.857 +07:00 [WRN] Error Response - RequestId: 9204ae11-7c29-42c4-92d1-611d285adde9, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 14:56:23.861 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/con-trai-ban-me, StatusCode: 404, ElapsedMs: 4269, Category: Very Slow
2025-05-24 14:56:23.865 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me - 404 null application/json; charset=utf-8 4280.8459ms
2025-05-24 14:57:01.304 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - null null
2025-05-24 14:57:01.319 +07:00 [INF] HTTP Request - RequestId: 98d0ee8d-883a-4f22-a042-8cb12e507d6f, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:57:01.324 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 14:57:01.326 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:57:01.338 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:57:01.344 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trieu-duong-chi-vu-da
2025-05-24 14:57:01.346 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:57:01.348 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:57:01.815 +07:00 [INF] Received HTTP response headers after 464.8894ms - 200
2025-05-24 14:57:01.818 +07:00 [INF] End processing HTTP request after 472.2978ms - 200
2025-05-24 14:57:01.897 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:57:01.906 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=trieu-duong-chi-vu-da
2025-05-24 14:57:01.908 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:57:01.911 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:57:02.259 +07:00 [INF] Received HTTP response headers after 344.9558ms - 200
2025-05-24 14:57:02.262 +07:00 [INF] End processing HTTP request after 353.9006ms - 200
2025-05-24 14:57:02.271 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:57:02.285 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (DbType = Double), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32), @p21='?' (DbType = DateTime2), @p22='?' (Size = 500), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-05-24 14:57:02.298 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:57:02.372 +07:00 [ERR] Error storing movie trieu-duong-chi-vu-da in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:57:02.503 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:57:02.520 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=trieu-duong-chi-vu-da
2025-05-24 14:57:02.523 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:57:02.525 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:57:02.850 +07:00 [INF] Received HTTP response headers after 321.9325ms - 200
2025-05-24 14:57:02.853 +07:00 [INF] End processing HTTP request after 330.379ms - 200
2025-05-24 14:57:02.941 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:57:02.950 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: trieu-duong-chi-vu-da
2025-05-24 14:57:02.953 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:57:02.956 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 1626.5343ms
2025-05-24 14:57:02.959 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 14:57:02.962 +07:00 [INF] HTTP Response - RequestId: 98d0ee8d-883a-4f22-a042-8cb12e507d6f, StatusCode: 404, ContentLength: null, ElapsedMs: 1643
2025-05-24 14:57:02.966 +07:00 [WRN] Error Response - RequestId: 98d0ee8d-883a-4f22-a042-8cb12e507d6f, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 14:57:02.969 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, StatusCode: 404, ElapsedMs: 1650, Category: Slow
2025-05-24 14:57:02.974 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - 404 null application/json; charset=utf-8 1670.9086ms
2025-05-24 14:57:28.357 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/search?query=con&page=1&limit=2 - null null
2025-05-24 14:57:28.377 +07:00 [INF] HTTP Request - RequestId: 3d121ea7-49b0-4673-821e-923c7c99571c, Method: GET, Path: /api/Movies/search, QueryString: ?query=con&page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:57:28.382 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 14:57:28.389 +07:00 [INF] Route matched with {action = "SearchMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] SearchMovies(System.String, Int32, Int32) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:57:28.398 +07:00 [INF] Searching movies from https://api.dulieuphim.ink/phim-data/v1?name=con&page=1&limit=2
2025-05-24 14:57:28.399 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 14:57:28.402 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 14:57:29.120 +07:00 [INF] Received HTTP response headers after 716.2355ms - 200
2025-05-24 14:57:29.123 +07:00 [INF] End processing HTTP request after 723.7168ms - 200
2025-05-24 14:57:29.131 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:57:29.133 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:57:29.137 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:29.141 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:29.142 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:29.145 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:29.662 +07:00 [INF] Received HTTP response headers after 514.2874ms - 200
2025-05-24 14:57:29.664 +07:00 [INF] Received HTTP response headers after 509.8359ms - 200
2025-05-24 14:57:29.665 +07:00 [INF] End processing HTTP request after 527.6953ms - 200
2025-05-24 14:57:29.667 +07:00 [INF] End processing HTTP request after 526.1323ms - 200
2025-05-24 14:57:29.669 +07:00 [INF] Fetched image for du-ngoan-chau-au-voi-paul-hollywood from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:57:29.671 +07:00 [INF] Fetched image for song-con from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:57:29.676 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:57:29.679 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim) in 1286.4214ms
2025-05-24 14:57:29.682 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 14:57:29.684 +07:00 [INF] HTTP Response - RequestId: 3d121ea7-49b0-4673-821e-923c7c99571c, StatusCode: 200, ContentLength: null, ElapsedMs: 1306
2025-05-24 14:57:29.688 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/search?query=con&page=1&limit=2 - 200 null application/json; charset=utf-8 1331.4272ms
2025-05-24 14:57:48.214 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/filter?page=1&limit=2 - null null
2025-05-24 14:57:48.220 +07:00 [INF] HTTP Request - RequestId: 0b0ec9e6-152d-46c0-a14d-51befb92253f, Method: GET, Path: /api/Movies/filter, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:57:48.225 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.FilterMovies (WebAppApiPhim)'
2025-05-24 14:57:48.232 +07:00 [INF] Route matched with {action = "FilterMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] FilterMovies(System.String, System.String, System.String, System.String, Int32, Int32) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:57:48.239 +07:00 [INF] Filtering movies from https://api.dulieuphim.ink/phim-data/v1?page=1&limit=2
2025-05-24 14:57:48.240 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 14:57:48.243 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 14:57:48.367 +07:00 [INF] Received HTTP response headers after 122.6998ms - 200
2025-05-24 14:57:48.370 +07:00 [INF] End processing HTTP request after 129.7872ms - 200
2025-05-24 14:57:48.378 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:57:48.379 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:57:48.384 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:48.387 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:48.389 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:48.391 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:57:48.598 +07:00 [INF] Received HTTP response headers after 205.3186ms - 200
2025-05-24 14:57:48.601 +07:00 [INF] End processing HTTP request after 217.6095ms - 200
2025-05-24 14:57:48.604 +07:00 [INF] Fetched image for dj-hiep-si-than-thanh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:57:48.639 +07:00 [INF] Received HTTP response headers after 238.951ms - 200
2025-05-24 14:57:48.642 +07:00 [INF] End processing HTTP request after 254.5728ms - 200
2025-05-24 14:57:48.644 +07:00 [INF] Fetched image for tuoi-noi-loan-phan-3 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:57:48.646 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:57:48.649 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.FilterMovies (WebAppApiPhim) in 413.8629ms
2025-05-24 14:57:48.652 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.FilterMovies (WebAppApiPhim)'
2025-05-24 14:57:48.654 +07:00 [INF] HTTP Response - RequestId: 0b0ec9e6-152d-46c0-a14d-51befb92253f, StatusCode: 200, ContentLength: null, ElapsedMs: 433
2025-05-24 14:57:48.658 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/filter?page=1&limit=2 - 200 null application/json; charset=utf-8 444.3519ms
2025-05-24 14:58:09.981 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da/related?limit=6 - null null
2025-05-24 14:58:09.992 +07:00 [INF] HTTP Request - RequestId: c13d5ca8-3860-4c83-8f35-dd0bc4cf3dca, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da/related, QueryString: ?limit=6, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:09.998 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetRelatedMovies (WebAppApiPhim)'
2025-05-24 14:58:10.005 +07:00 [INF] Route matched with {action = "GetRelatedMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetRelatedMovies(System.String, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 14:58:10.013 +07:00 [INF] Cache hit for movie_detail_trieu-duong-chi-vu-da
2025-05-24 14:58:10.015 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=7
2025-05-24 14:58:10.016 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:58:10.018 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:58:10.145 +07:00 [INF] Received HTTP response headers after 124.2374ms - 200
2025-05-24 14:58:10.148 +07:00 [INF] End processing HTTP request after 131.4617ms - 200
2025-05-24 14:58:10.154 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:58:10.157 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:58:10.182 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:58:10.170 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.190 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.195 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.197 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.199 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.201 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.395 +07:00 [INF] Received HTTP response headers after 192.0491ms - 200
2025-05-24 14:58:10.398 +07:00 [INF] End processing HTTP request after 227.9411ms - 200
2025-05-24 14:58:10.401 +07:00 [INF] Fetched image for thieu-dot-con-tim from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:58:10.498 +07:00 [INF] Received HTTP response headers after 288.2742ms - 200
2025-05-24 14:58:10.501 +07:00 [INF] End processing HTTP request after 311.0411ms - 200
2025-05-24 14:58:10.503 +07:00 [INF] Fetched image for 2099 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:58:10.573 +07:00 [INF] Received HTTP response headers after 356.7737ms - 200
2025-05-24 14:58:10.575 +07:00 [INF] End processing HTTP request after 380.2632ms - 200
2025-05-24 14:58:10.578 +07:00 [INF] Fetched image for muon-duoc-o-gan-em from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:58:10.583 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:58:10.587 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:58:10.590 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.594 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.597 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.599 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:58:10.789 +07:00 [INF] Received HTTP response headers after 187.3503ms - 200
2025-05-24 14:58:10.792 +07:00 [INF] End processing HTTP request after 202.4913ms - 200
2025-05-24 14:58:10.795 +07:00 [INF] Fetched image for am-duong-su-thi-than-lenh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:58:10.801 +07:00 [INF] Received HTTP response headers after 192.8034ms - 200
2025-05-24 14:58:10.804 +07:00 [INF] End processing HTTP request after 209.2655ms - 200
2025-05-24 14:58:10.806 +07:00 [INF] Fetched image for chainsaw-man from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:58:10.808 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 14:58:10.811 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:58:10.814 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetRelatedMovies (WebAppApiPhim) in 805.0449ms
2025-05-24 14:58:10.817 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetRelatedMovies (WebAppApiPhim)'
2025-05-24 14:58:10.819 +07:00 [INF] HTTP Response - RequestId: c13d5ca8-3860-4c83-8f35-dd0bc4cf3dca, StatusCode: 200, ContentLength: null, ElapsedMs: 826
2025-05-24 14:58:10.822 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da/related?limit=6 - 200 null application/json; charset=utf-8 841.0951ms
2025-05-24 14:58:24.675 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Statistics - null null
2025-05-24 14:58:24.691 +07:00 [INF] HTTP Request - RequestId: d176745b-c68d-4358-b91f-4f80c1a4a44b, Method: GET, Path: /api/Statistics, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:24.702 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetStatistics (WebAppApiPhim)'
2025-05-24 14:58:24.710 +07:00 [INF] Route matched with {action = "GetStatistics", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.StatisticsViewModel]]] GetStatistics() on controller WebAppApiPhim.Controllers.StatisticsController (WebAppApiPhim).
2025-05-24 14:58:24.726 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [CachedMovies] AS [c]
2025-05-24 14:58:24.741 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [CachedEpisodes] AS [c]
2025-05-24 14:58:24.753 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-05-24 14:58:24.771 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[ViewCount]), 0)
FROM [CachedMovies] AS [c]
2025-05-24 14:58:24.846 +07:00 [ERR] Error getting total views
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetTotalViewsAsync() in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 165
2025-05-24 14:58:24.866 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__today_0='?' (DbType = DateTime2), @__tomorrow_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([m].[ViewCount]), 0)
FROM [MovieStatistics] AS [m]
WHERE [m].[LastUpdated] >= @__today_0 AND [m].[LastUpdated] < @__tomorrow_1
2025-05-24 14:58:24.934 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Slug], [t].[Name], [t].[OriginalName], [t].[Year], [t].[ThumbUrl], [t].[PosterUrl], [t].[Type], [t].[Quality], [t].[ViewCount], CASE
    WHEN [m].[Id] IS NOT NULL THEN [m].[AverageRating]
    ELSE 0.0E0
END AS [AverageRating], CAST(0 AS bit) AS [IsFavorite], NULL AS [WatchedPercentage]
FROM (
    SELECT TOP(@__p_0) [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
    FROM [CachedMovies] AS [c]
    ORDER BY [c].[ViewCount] DESC
) AS [t]
LEFT JOIN [MovieStatistics] AS [m] ON [t].[Slug] = [m].[MovieSlug]
ORDER BY [t].[ViewCount] DESC
2025-05-24 14:58:24.982 +07:00 [ERR] Error getting popular movies
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetPopularMoviesAsync(Int32 count) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 102
2025-05-24 14:58:25.004 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Slug], [t].[Name], [t].[OriginalName], [t].[Year], [t].[ThumbUrl], [t].[PosterUrl], [t].[Type], [t].[Quality], [t].[ViewCount], CASE
    WHEN [m].[Id] IS NOT NULL THEN [m].[AverageRating]
    ELSE 0.0E0
END AS [AverageRating], CAST(0 AS bit) AS [IsFavorite], NULL AS [WatchedPercentage]
FROM (
    SELECT TOP(@__p_0) [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
    FROM [CachedMovies] AS [c]
    ORDER BY [c].[LastUpdated] DESC
) AS [t]
LEFT JOIN [MovieStatistics] AS [m] ON [t].[Slug] = [m].[MovieSlug]
ORDER BY [t].[LastUpdated] DESC
2025-05-24 14:58:25.045 +07:00 [ERR] Error getting recent movies
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetRecentMoviesAsync(Int32 count) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 143
2025-05-24 14:58:25.085 +07:00 [ERR] Error getting statistics
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetStatisticsAsync() in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 61
2025-05-24 14:58:25.088 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.StatisticsViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 14:58:25.096 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StatisticsController.GetStatistics (WebAppApiPhim) in 380.7921ms
2025-05-24 14:58:25.098 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetStatistics (WebAppApiPhim)'
2025-05-24 14:58:25.100 +07:00 [INF] HTTP Response - RequestId: d176745b-c68d-4358-b91f-4f80c1a4a44b, StatusCode: 200, ContentLength: null, ElapsedMs: 409
2025-05-24 14:58:25.103 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Statistics - 200 null application/json; charset=utf-8 428.6933ms
2025-05-24 14:58:32.281 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Statistics/popular?count=10 - null null
2025-05-24 14:58:32.288 +07:00 [INF] HTTP Request - RequestId: ec72cec8-0aa7-46bb-8800-aa699b7403f6, Method: GET, Path: /api/Statistics/popular, QueryString: ?count=10, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:32.293 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim)'
2025-05-24 14:58:32.300 +07:00 [INF] Route matched with {action = "GetPopularMovies", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[WebAppApiPhim.Models.MovieListItemViewModel]]]] GetPopularMovies(Int32) on controller WebAppApiPhim.Controllers.StatisticsController (WebAppApiPhim).
2025-05-24 14:58:32.313 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Slug], [t].[Name], [t].[OriginalName], [t].[Year], [t].[ThumbUrl], [t].[PosterUrl], [t].[Type], [t].[Quality], [t].[ViewCount], CASE
    WHEN [m].[Id] IS NOT NULL THEN [m].[AverageRating]
    ELSE 0.0E0
END AS [AverageRating], CAST(0 AS bit) AS [IsFavorite], NULL AS [WatchedPercentage]
FROM (
    SELECT TOP(@__p_0) [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
    FROM [CachedMovies] AS [c]
    ORDER BY [c].[ViewCount] DESC
) AS [t]
LEFT JOIN [MovieStatistics] AS [m] ON [t].[Slug] = [m].[MovieSlug]
ORDER BY [t].[ViewCount] DESC
2025-05-24 14:58:32.361 +07:00 [ERR] Error getting popular movies
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetPopularMoviesAsync(Int32 count) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 102
2025-05-24 14:58:32.364 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[WebAppApiPhim.Models.MovieListItemViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:58:32.368 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim) in 64.5127ms
2025-05-24 14:58:32.371 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim)'
2025-05-24 14:58:32.373 +07:00 [INF] HTTP Response - RequestId: ec72cec8-0aa7-46bb-8800-aa699b7403f6, StatusCode: 200, ContentLength: null, ElapsedMs: 85
2025-05-24 14:58:32.376 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Statistics/popular?count=10 - 200 null application/json; charset=utf-8 96.061ms
2025-05-24 14:58:33.956 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Statistics/popular?count=10 - null null
2025-05-24 14:58:33.978 +07:00 [INF] HTTP Request - RequestId: 1f59a25d-7b1f-4c3a-a3ac-f3633417ba2d, Method: GET, Path: /api/Statistics/popular, QueryString: ?count=10, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:33.984 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim)'
2025-05-24 14:58:33.986 +07:00 [INF] Route matched with {action = "GetPopularMovies", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[WebAppApiPhim.Models.MovieListItemViewModel]]]] GetPopularMovies(Int32) on controller WebAppApiPhim.Controllers.StatisticsController (WebAppApiPhim).
2025-05-24 14:58:33.995 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Slug], [t].[Name], [t].[OriginalName], [t].[Year], [t].[ThumbUrl], [t].[PosterUrl], [t].[Type], [t].[Quality], [t].[ViewCount], CASE
    WHEN [m].[Id] IS NOT NULL THEN [m].[AverageRating]
    ELSE 0.0E0
END AS [AverageRating], CAST(0 AS bit) AS [IsFavorite], NULL AS [WatchedPercentage]
FROM (
    SELECT TOP(@__p_0) [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
    FROM [CachedMovies] AS [c]
    ORDER BY [c].[ViewCount] DESC
) AS [t]
LEFT JOIN [MovieStatistics] AS [m] ON [t].[Slug] = [m].[MovieSlug]
ORDER BY [t].[ViewCount] DESC
2025-05-24 14:58:34.048 +07:00 [ERR] Error getting popular movies
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetPopularMoviesAsync(Int32 count) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 102
2025-05-24 14:58:34.052 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[WebAppApiPhim.Models.MovieListItemViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:58:34.054 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim) in 64.9564ms
2025-05-24 14:58:34.057 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetPopularMovies (WebAppApiPhim)'
2025-05-24 14:58:34.059 +07:00 [INF] HTTP Response - RequestId: 1f59a25d-7b1f-4c3a-a3ac-f3633417ba2d, StatusCode: 200, ContentLength: null, ElapsedMs: 80
2025-05-24 14:58:34.062 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Statistics/popular?count=10 - 200 null application/json; charset=utf-8 106.6649ms
2025-05-24 14:58:40.192 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Statistics/recent?count=10 - null null
2025-05-24 14:58:40.199 +07:00 [INF] HTTP Request - RequestId: f9bd6d60-b238-40f8-a72f-6dfb7e0391c1, Method: GET, Path: /api/Statistics/recent, QueryString: ?count=10, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:40.204 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetRecentMovies (WebAppApiPhim)'
2025-05-24 14:58:40.211 +07:00 [INF] Route matched with {action = "GetRecentMovies", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[WebAppApiPhim.Models.MovieListItemViewModel]]]] GetRecentMovies(Int32) on controller WebAppApiPhim.Controllers.StatisticsController (WebAppApiPhim).
2025-05-24 14:58:40.220 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Slug], [t].[Name], [t].[OriginalName], [t].[Year], [t].[ThumbUrl], [t].[PosterUrl], [t].[Type], [t].[Quality], [t].[ViewCount], CASE
    WHEN [m].[Id] IS NOT NULL THEN [m].[AverageRating]
    ELSE 0.0E0
END AS [AverageRating], CAST(0 AS bit) AS [IsFavorite], NULL AS [WatchedPercentage]
FROM (
    SELECT TOP(@__p_0) [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
    FROM [CachedMovies] AS [c]
    ORDER BY [c].[LastUpdated] DESC
) AS [t]
LEFT JOIN [MovieStatistics] AS [m] ON [t].[Slug] = [m].[MovieSlug]
ORDER BY [t].[LastUpdated] DESC
2025-05-24 14:58:40.261 +07:00 [ERR] Error getting recent movies
System.InvalidOperationException: Cache entry must specify a value for Size when SizeLimit is set.
   at Microsoft.Extensions.Caching.Memory.MemoryCache.SetEntry(CacheEntry entry)
   at Microsoft.Extensions.Caching.Memory.CacheExtensions.Set[TItem](IMemoryCache cache, Object key, TItem value, TimeSpan absoluteExpirationRelativeToNow)
   at WebAppApiPhim.Services.StatisticsService.GetRecentMoviesAsync(Int32 count) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StatisticsService.cs:line 143
2025-05-24 14:58:40.266 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[WebAppApiPhim.Models.MovieListItemViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:58:40.269 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StatisticsController.GetRecentMovies (WebAppApiPhim) in 54.1052ms
2025-05-24 14:58:40.271 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StatisticsController.GetRecentMovies (WebAppApiPhim)'
2025-05-24 14:58:40.273 +07:00 [INF] HTTP Response - RequestId: f9bd6d60-b238-40f8-a72f-6dfb7e0391c1, StatusCode: 200, ContentLength: null, ElapsedMs: 74
2025-05-24 14:58:40.276 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Statistics/recent?count=10 - 200 null application/json; charset=utf-8 84.3882ms
2025-05-24 14:58:54.289 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Streaming/trieu-duong-chi-vu-da/episodes - null null
2025-05-24 14:58:54.295 +07:00 [INF] HTTP Request - RequestId: 0b38c653-f71d-4559-8f79-2e3847d11b2b, Method: GET, Path: /api/Streaming/trieu-duong-chi-vu-da/episodes, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:58:54.300 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim)'
2025-05-24 14:58:54.310 +07:00 [INF] Route matched with {action = "GetEpisodes", controller = "Streaming"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[WebAppApiPhim.Models.ServerViewModel]]]] GetEpisodes(System.String) on controller WebAppApiPhim.Controllers.StreamingController (WebAppApiPhim).
2025-05-24 14:58:54.331 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 14:58:54.338 +07:00 [INF] Cache hit for movie_detail_trieu-duong-chi-vu-da
2025-05-24 14:58:54.354 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 14:58:54.369 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 14:58:54.425 +07:00 [ERR] Error processing episode data for movie trieu-duong-chi-vu-da
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 14:58:54.435 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-05-24 14:58:54.446 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:58:54.518 +07:00 [ERR] Error caching movie trieu-duong-chi-vu-da
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.StreamingService.CacheMovieAsync(MovieDetailResponse movieDetail) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 114
2025-05-24 14:58:54.635 +07:00 [ERR] Error getting episodes for movie trieu-duong-chi-vu-da
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4e05be5c-0175-45f2-8661-682e84e4a828
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.StreamingService.CacheMovieAsync(MovieDetailResponse movieDetail) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 114
   at WebAppApiPhim.Services.StreamingService.GetEpisodesAsync(String slug) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 140
2025-05-24 14:58:54.655 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[WebAppApiPhim.Models.ServerViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 14:58:54.660 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim) in 345.7055ms
2025-05-24 14:58:54.662 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim)'
2025-05-24 14:58:54.667 +07:00 [INF] HTTP Response - RequestId: 0b38c653-f71d-4559-8f79-2e3847d11b2b, StatusCode: 200, ContentLength: null, ElapsedMs: 372
2025-05-24 14:58:54.678 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Streaming/trieu-duong-chi-vu-da/episodes - 200 null application/json; charset=utf-8 390.2828ms
2025-05-24 14:59:11.736 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/profile - null null
2025-05-24 14:59:11.746 +07:00 [INF] HTTP Request - RequestId: c71759af-19e5-4914-abb7-4001e3f31b27, Method: GET, Path: /api/User/profile, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:59:11.761 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 14:59:11.769 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 14:59:11.771 +07:00 [INF] HTTP Response - RequestId: c71759af-19e5-4914-abb7-4001e3f31b27, StatusCode: 401, ContentLength: null, ElapsedMs: 25
2025-05-24 14:59:11.774 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/profile, StatusCode: 401, ElapsedMs: 28, Category: Excellent
2025-05-24 14:59:11.778 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/profile - 401 0 null 43.7486ms
2025-05-24 14:59:17.195 +07:00 [INF] Enhanced Movie Cache Service is running at: "2025-05-24T14:59:17.1951343+07:00"
2025-05-24 14:59:17.199 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=50
2025-05-24 14:59:17.201 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:59:17.203 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:59:17.226 +07:00 [INF] MovieCacheService is running at: "2025-05-24T14:59:17.2268440+07:00"
2025-05-24 14:59:17.233 +07:00 [INF] Performance Metrics - WorkingSet: 177.19MB, PrivateMemory: 119.61MB, GC Memory: 52.78MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 14:59:17.233 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=50
2025-05-24 14:59:17.239 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:59:17.241 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 14:59:17.445 +07:00 [INF] Received HTTP response headers after 239.9451ms - 200
2025-05-24 14:59:17.445 +07:00 [INF] Received HTTP response headers after 201.935ms - 200
2025-05-24 14:59:17.448 +07:00 [INF] End processing HTTP request after 247.2041ms - 200
2025-05-24 14:59:17.450 +07:00 [INF] End processing HTTP request after 211.6962ms - 200
2025-05-24 14:59:17.458 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.461 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.482 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.505 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.513 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.526 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.499 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.517 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.518 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.493 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.544 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.548 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.552 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.555 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.557 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.559 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.561 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.564 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.720 +07:00 [INF] Received HTTP response headers after 190.3152ms - 200
2025-05-24 14:59:17.723 +07:00 [INF] End processing HTTP request after 241.3591ms - 200
2025-05-24 14:59:17.725 +07:00 [INF] Received HTTP response headers after 188.6737ms - 200
2025-05-24 14:59:17.726 +07:00 [INF] Fetched image for van-gioi-doc-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.728 +07:00 [INF] End processing HTTP request after 222.8686ms - 200
2025-05-24 14:59:17.732 +07:00 [INF] Fetched image for tuyet-the-chien-hon-3d from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.808 +07:00 [INF] Received HTTP response headers after 226.8975ms - 200
2025-05-24 14:59:17.810 +07:00 [INF] End processing HTTP request after 258.9865ms - 200
2025-05-24 14:59:17.813 +07:00 [INF] Received HTTP response headers after 224.2287ms - 200
2025-05-24 14:59:17.814 +07:00 [INF] Fetched image for tuyet-the-chien-hon-3d from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.816 +07:00 [INF] End processing HTTP request after 260.546ms - 200
2025-05-24 14:59:17.820 +07:00 [INF] Fetched image for van-gioi-doc-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.911 +07:00 [INF] Received HTTP response headers after 337.5213ms - 200
2025-05-24 14:59:17.911 +07:00 [INF] Received HTTP response headers after 345.518ms - 200
2025-05-24 14:59:17.914 +07:00 [INF] End processing HTTP request after 366.3385ms - 200
2025-05-24 14:59:17.917 +07:00 [INF] End processing HTTP request after 372.1981ms - 200
2025-05-24 14:59:17.919 +07:00 [INF] Fetched image for tien-vo-de-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.921 +07:00 [INF] Fetched image for tien-vo-de-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:17.927 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.930 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.945 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.963 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.960 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.994 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.002 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.979 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.012 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.930 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.021 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.981 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.033 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.938 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:17.935 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.000 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.961 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:17.981 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.044 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.046 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.048 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.067 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.052 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.056 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.060 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.065 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.091 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.093 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.096 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.098 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.372 +07:00 [INF] Received HTTP response headers after 303.1824ms - 200
2025-05-24 14:59:18.375 +07:00 [INF] End processing HTTP request after 342.2161ms - 200
2025-05-24 14:59:18.378 +07:00 [INF] Fetched image for thang-cap-manh-nhat from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.397 +07:00 [INF] Received HTTP response headers after 361.9727ms - 200
2025-05-24 14:59:18.400 +07:00 [INF] End processing HTTP request after 421.2951ms - 200
2025-05-24 14:59:18.402 +07:00 [INF] Fetched image for pham-nhan-tu-tien-3 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.417 +07:00 [INF] Received HTTP response headers after 402.4921ms - 200
2025-05-24 14:59:18.420 +07:00 [INF] Received HTTP response headers after 395.945ms - 200
2025-05-24 14:59:18.420 +07:00 [INF] End processing HTTP request after 460.3362ms - 200
2025-05-24 14:59:18.422 +07:00 [INF] End processing HTTP request after 428.7833ms - 200
2025-05-24 14:59:18.425 +07:00 [INF] Fetched image for thai-co-chien-hon from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.430 +07:00 [INF] Fetched image for tuyet-chung-2018 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.503 +07:00 [INF] Received HTTP response headers after 427.0218ms - 200
2025-05-24 14:59:18.505 +07:00 [INF] End processing HTTP request after 567.0644ms - 200
2025-05-24 14:59:18.508 +07:00 [INF] Received HTTP response headers after 424.9691ms - 200
2025-05-24 14:59:18.508 +07:00 [INF] Fetched image for thang-cap-manh-nhat from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.510 +07:00 [INF] End processing HTTP request after 466.3129ms - 200
2025-05-24 14:59:18.514 +07:00 [INF] Fetched image for bu-nhin from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.580 +07:00 [INF] Received HTTP response headers after 462.4156ms - 200
2025-05-24 14:59:18.583 +07:00 [INF] End processing HTTP request after 522.7699ms - 200
2025-05-24 14:59:18.586 +07:00 [INF] Fetched image for pham-nhan-tu-tien-3 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.592 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.595 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.602 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.604 +07:00 [INF] Received HTTP response headers after 502.7357ms - 200
2025-05-24 14:59:18.599 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.606 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.600 +07:00 [INF] Received HTTP response headers after 490.1966ms - 200
2025-05-24 14:59:18.600 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.606 +07:00 [INF] Received HTTP response headers after 479.5312ms - 200
2025-05-24 14:59:18.607 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.612 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.615 +07:00 [INF] End processing HTTP request after 562.4011ms - 200
2025-05-24 14:59:18.620 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.624 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.626 +07:00 [INF] End processing HTTP request after 569.6368ms - 200
2025-05-24 14:59:18.628 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.631 +07:00 [INF] End processing HTTP request after 566.0338ms - 200
2025-05-24 14:59:18.635 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.638 +07:00 [INF] Fetched image for thai-co-chien-hon from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.655 +07:00 [INF] Fetched image for tuyet-chung-2018 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.633 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.641 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.643 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.646 +07:00 [INF] Fetched image for bu-nhin from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:18.695 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.702 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.703 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.706 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.699 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.710 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:18.711 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.712 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.717 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.728 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.721 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.738 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.726 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.748 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:18.759 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.112 +07:00 [INF] Received HTTP response headers after 454.5984ms - 200
2025-05-24 14:59:19.115 +07:00 [INF] End processing HTTP request after 502.7381ms - 200
2025-05-24 14:59:19.117 +07:00 [INF] Fetched image for nhat-the-doc-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.162 +07:00 [INF] Received HTTP response headers after 485.5925ms - 200
2025-05-24 14:59:19.165 +07:00 [INF] End processing HTTP request after 545.297ms - 200
2025-05-24 14:59:19.167 +07:00 [INF] Fetched image for trong-tong-mon-tru-ta-ra-tat-ca-deu-la-gian-diep from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.170 +07:00 [INF] Received HTTP response headers after 521.9391ms - 200
2025-05-24 14:59:19.173 +07:00 [INF] End processing HTTP request after 573.1177ms - 200
2025-05-24 14:59:19.176 +07:00 [INF] Fetched image for trung-thien-than from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.185 +07:00 [INF] Received HTTP response headers after 500.4702ms - 200
2025-05-24 14:59:19.187 +07:00 [INF] End processing HTTP request after 562.9722ms - 200
2025-05-24 14:59:19.189 +07:00 [INF] Fetched image for ve-dep-cuoc-song from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.191 +07:00 [INF] Received HTTP response headers after 440.6013ms - 200
2025-05-24 14:59:19.194 +07:00 [INF] End processing HTTP request after 476.7327ms - 200
2025-05-24 14:59:19.196 +07:00 [INF] Fetched image for nhat-the-doc-ton from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.202 +07:00 [INF] Received HTTP response headers after 532.8775ms - 200
2025-05-24 14:59:19.204 +07:00 [INF] End processing HTTP request after 596.6972ms - 200
2025-05-24 14:59:19.206 +07:00 [INF] Fetched image for luyen-khi-muoi-van-nam from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.211 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.217 +07:00 [INF] Received HTTP response headers after 476.4488ms - 200
2025-05-24 14:59:19.218 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.217 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.220 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.222 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.215 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.223 +07:00 [INF] End processing HTTP request after 512.6219ms - 200
2025-05-24 14:59:19.225 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.226 +07:00 [INF] Received HTTP response headers after 457.3703ms - 200
2025-05-24 14:59:19.243 +07:00 [INF] Fetched image for trong-tong-mon-tru-ta-ra-tat-ca-deu-la-gian-diep from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.229 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.233 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.236 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.230 +07:00 [INF] Received HTTP response headers after 469.6561ms - 200
2025-05-24 14:59:19.240 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.238 +07:00 [INF] Received HTTP response headers after 507.2563ms - 200
2025-05-24 14:59:19.251 +07:00 [INF] End processing HTTP request after 525.5739ms - 200
2025-05-24 14:59:19.255 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.257 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.259 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.268 +07:00 [INF] Fetched image for ve-dep-cuoc-song from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.261 +07:00 [INF] End processing HTTP request after 539.8583ms - 200
2025-05-24 14:59:19.263 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.266 +07:00 [INF] End processing HTTP request after 562.6173ms - 200
2025-05-24 14:59:19.292 +07:00 [INF] Fetched image for luyen-khi-muoi-van-nam from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.302 +07:00 [INF] Fetched image for trung-thien-than from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.307 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.310 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.315 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.314 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.320 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.317 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.322 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.324 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.327 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.337 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.331 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.347 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.335 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.356 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.365 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.457 +07:00 [INF] Received HTTP response headers after 212.6368ms - 200
2025-05-24 14:59:19.460 +07:00 [INF] End processing HTTP request after 241.7881ms - 200
2025-05-24 14:59:19.462 +07:00 [INF] Fetched image for khong-gia-dinh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.577 +07:00 [INF] Received HTTP response headers after 300.2186ms - 200
2025-05-24 14:59:19.580 +07:00 [INF] End processing HTTP request after 346.8689ms - 200
2025-05-24 14:59:19.582 +07:00 [INF] Fetched image for vi-em-da-den from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.633 +07:00 [INF] Received HTTP response headers after 363.3859ms - 200
2025-05-24 14:59:19.636 +07:00 [INF] End processing HTTP request after 407.1977ms - 200
2025-05-24 14:59:19.639 +07:00 [INF] Fetched image for khong-chun-buoc from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.656 +07:00 [INF] Received HTTP response headers after 298.0045ms - 200
2025-05-24 14:59:19.659 +07:00 [INF] End processing HTTP request after 331.4249ms - 200
2025-05-24 14:59:19.661 +07:00 [INF] Fetched image for khong-chun-buoc from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.706 +07:00 [INF] Received HTTP response headers after 366.7399ms - 200
2025-05-24 14:59:19.709 +07:00 [INF] End processing HTTP request after 393.6664ms - 200
2025-05-24 14:59:19.711 +07:00 [INF] Fetched image for khong-gia-dinh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.735 +07:00 [INF] Received HTTP response headers after 450.8144ms - 200
2025-05-24 14:59:19.738 +07:00 [INF] Received HTTP response headers after 388.9112ms - 200
2025-05-24 14:59:19.738 +07:00 [INF] End processing HTTP request after 501.3082ms - 200
2025-05-24 14:59:19.740 +07:00 [INF] End processing HTTP request after 418.4806ms - 200
2025-05-24 14:59:19.741 +07:00 [INF] Received HTTP response headers after 447.0851ms - 200
2025-05-24 14:59:19.743 +07:00 [INF] Fetched image for ke-an-danh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.746 +07:00 [INF] Fetched image for les-possedees-du-diable from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.748 +07:00 [INF] End processing HTTP request after 507.7259ms - 200
2025-05-24 14:59:19.749 +07:00 [INF] Received HTTP response headers after 381.2147ms - 200
2025-05-24 14:59:19.755 +07:00 [INF] Fetched image for les-possedees-du-diable from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.757 +07:00 [INF] End processing HTTP request after 426.0483ms - 200
2025-05-24 14:59:19.762 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.768 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.772 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.772 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.763 +07:00 [INF] Fetched image for ke-an-danh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.765 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.769 +07:00 [INF] Received HTTP response headers after 393.5247ms - 200
2025-05-24 14:59:19.776 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.779 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.783 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.786 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.792 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.804 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.801 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.799 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.814 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.795 +07:00 [INF] End processing HTTP request after 459.753ms - 200
2025-05-24 14:59:19.831 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.842 +07:00 [INF] Fetched image for vi-em-da-den from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:19.855 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.861 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.863 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.865 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.868 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.858 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:19.870 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.873 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.878 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.882 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.889 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.887 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.898 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.900 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:19.910 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.043 +07:00 [INF] Received HTTP response headers after 236.7359ms - 200
2025-05-24 14:59:20.046 +07:00 [INF] End processing HTTP request after 273.8857ms - 200
2025-05-24 14:59:20.050 +07:00 [INF] Fetched image for bach-yeu-pho from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.204 +07:00 [INF] Received HTTP response headers after 379.8875ms - 200
2025-05-24 14:59:20.206 +07:00 [INF] End processing HTTP request after 427.7709ms - 200
2025-05-24 14:59:20.208 +07:00 [INF] Fetched image for sup-do-2020 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.214 +07:00 [INF] Received HTTP response headers after 379.8739ms - 200
2025-05-24 14:59:20.216 +07:00 [INF] End processing HTTP request after 424.3485ms - 200
2025-05-24 14:59:20.218 +07:00 [INF] Fetched image for duoc-su-tu-su-phan-2 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.240 +07:00 [INF] Received HTTP response headers after 423.1803ms - 200
2025-05-24 14:59:20.243 +07:00 [INF] End processing HTTP request after 459.585ms - 200
2025-05-24 14:59:20.245 +07:00 [INF] Received HTTP response headers after 325.3339ms - 200
2025-05-24 14:59:20.245 +07:00 [INF] Received HTTP response headers after 333.1178ms - 200
2025-05-24 14:59:20.246 +07:00 [INF] Fetched image for chuyen-doi-bac-si-noi-tru from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.248 +07:00 [INF] End processing HTTP request after 366.2325ms - 200
2025-05-24 14:59:20.251 +07:00 [INF] End processing HTTP request after 372.8329ms - 200
2025-05-24 14:59:20.258 +07:00 [INF] Received HTTP response headers after 366.8173ms - 200
2025-05-24 14:59:20.257 +07:00 [INF] Received HTTP response headers after 413.0953ms - 200
2025-05-24 14:59:20.255 +07:00 [INF] Fetched image for thuong-nguyen-do from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.258 +07:00 [INF] Fetched image for chuyen-doi-bac-si-noi-tru from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.261 +07:00 [INF] End processing HTTP request after 397.7122ms - 200
2025-05-24 14:59:20.263 +07:00 [INF] End processing HTTP request after 463.6891ms - 200
2025-05-24 14:59:20.269 +07:00 [INF] Fetched image for bach-yeu-pho from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.271 +07:00 [INF] Fetched image for thuong-nguyen-do from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.276 +07:00 [INF] Received HTTP response headers after 373.1855ms - 200
2025-05-24 14:59:20.277 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.280 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.288 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.290 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.287 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.284 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.282 +07:00 [INF] End processing HTTP request after 411.332ms - 200
2025-05-24 14:59:20.279 +07:00 [INF] Received HTTP response headers after 351.6866ms - 200
2025-05-24 14:59:20.294 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.296 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.299 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.313 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.303 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.322 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.307 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.330 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.309 +07:00 [INF] Fetched image for sup-do-2020 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.339 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.311 +07:00 [INF] End processing HTTP request after 423.9413ms - 200
2025-05-24 14:59:20.358 +07:00 [INF] Fetched image for duoc-su-tu-su-phan-2 from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.362 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.365 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.369 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.368 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.370 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.374 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.376 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.378 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.382 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.391 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.386 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.400 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.389 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.410 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.419 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.454 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=20 - null null
2025-05-24 14:59:20.473 +07:00 [INF] HTTP Request - RequestId: cdf13efd-6d27-4c02-9e2f-6cc5eb708f44, Method: GET, Path: /api/User/favorites, QueryString: ?page=1&limit=20, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:59:20.481 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 14:59:20.484 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 14:59:20.486 +07:00 [INF] HTTP Response - RequestId: cdf13efd-6d27-4c02-9e2f-6cc5eb708f44, StatusCode: 401, ContentLength: null, ElapsedMs: 14
2025-05-24 14:59:20.490 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/favorites, StatusCode: 401, ElapsedMs: 18, Category: Excellent
2025-05-24 14:59:20.494 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=20 - 401 0 null 40.8928ms
2025-05-24 14:59:20.666 +07:00 [INF] Received HTTP response headers after 351.1418ms - 200
2025-05-24 14:59:20.670 +07:00 [INF] End processing HTTP request after 381.2329ms - 200
2025-05-24 14:59:20.673 +07:00 [INF] Fetched image for cung-dien-ma-am from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.805 +07:00 [INF] Received HTTP response headers after 402.1381ms - 200
2025-05-24 14:59:20.808 +07:00 [INF] End processing HTTP request after 431.42ms - 200
2025-05-24 14:59:20.810 +07:00 [INF] Fetched image for ninja-to-koroshiya-no-futarigurashi from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.811 +07:00 [INF] Received HTTP response headers after 469.2702ms - 200
2025-05-24 14:59:20.814 +07:00 [INF] End processing HTTP request after 510.6146ms - 200
2025-05-24 14:59:20.817 +07:00 [INF] Fetched image for mono from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.824 +07:00 [INF] Received HTTP response headers after 473.72ms - 200
2025-05-24 14:59:20.824 +07:00 [INF] Received HTTP response headers after 491.9996ms - 200
2025-05-24 14:59:20.827 +07:00 [INF] End processing HTTP request after 519.9264ms - 200
2025-05-24 14:59:20.829 +07:00 [INF] End processing HTTP request after 529.4466ms - 200
2025-05-24 14:59:20.831 +07:00 [INF] Fetched image for nguoi-yeu-ma-cac-nha-si-khuyen-dung from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.833 +07:00 [INF] Fetched image for enen-no-shouboutai-san-no-shou from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.835 +07:00 [INF] Received HTTP response headers after 511.3178ms - 200
2025-05-24 14:59:20.838 +07:00 [INF] Received HTTP response headers after 409.0285ms - 200
2025-05-24 14:59:20.839 +07:00 [INF] Received HTTP response headers after 445.6838ms - 200
2025-05-24 14:59:20.839 +07:00 [INF] Received HTTP response headers after 417.9022ms - 200
2025-05-24 14:59:20.839 +07:00 [INF] Received HTTP response headers after 427.4274ms - 200
2025-05-24 14:59:20.840 +07:00 [INF] End processing HTTP request after 545.9015ms - 200
2025-05-24 14:59:20.842 +07:00 [INF] End processing HTTP request after 452.0725ms - 200
2025-05-24 14:59:20.844 +07:00 [INF] End processing HTTP request after 474.8097ms - 200
2025-05-24 14:59:20.846 +07:00 [INF] End processing HTTP request after 460.151ms - 200
2025-05-24 14:59:20.848 +07:00 [INF] End processing HTTP request after 466.258ms - 200
2025-05-24 14:59:20.850 +07:00 [INF] Fetched image for ninja-to-koroshiya-no-futarigurashi from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.852 +07:00 [INF] Fetched image for enen-no-shouboutai-san-no-shou from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.857 +07:00 [INF] Fetched image for mono from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.867 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.876 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.864 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.859 +07:00 [INF] Fetched image for nguoi-yeu-ma-cac-nha-si-khuyen-dung from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.870 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.873 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.855 +07:00 [INF] Fetched image for cung-dien-ma-am from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:20.877 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.881 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.902 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.906 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.919 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.908 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.901 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.885 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.929 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.933 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.942 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.900 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.951 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.906 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.962 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.911 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:20.891 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.895 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.973 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.976 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.980 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.987 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.982 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.997 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:20.985 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.298 +07:00 [INF] Received HTTP response headers after 354.1757ms - 200
2025-05-24 14:59:21.301 +07:00 [INF] End processing HTTP request after 382.7125ms - 200
2025-05-24 14:59:21.304 +07:00 [INF] Fetched image for tang-hai-truyen from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.346 +07:00 [INF] Received HTTP response headers after 381.9611ms - 200
2025-05-24 14:59:21.349 +07:00 [INF] End processing HTTP request after 415.7279ms - 200
2025-05-24 14:59:21.351 +07:00 [INF] Fetched image for compass-20-sentou-setsuri-kaiseki-system from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.369 +07:00 [INF] Received HTTP response headers after 433.5911ms - 200
2025-05-24 14:59:21.371 +07:00 [INF] End processing HTTP request after 494.7887ms - 200
2025-05-24 14:59:21.374 +07:00 [INF] Received HTTP response headers after 450.9074ms - 200
2025-05-24 14:59:21.374 +07:00 [INF] Fetched image for tang-hai-truyen from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.376 +07:00 [INF] End processing HTTP request after 494.7797ms - 200
2025-05-24 14:59:21.380 +07:00 [INF] Fetched image for bye-bye-earth-2nd-season from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.383 +07:00 [INF] Received HTTP response headers after 376.887ms - 200
2025-05-24 14:59:21.386 +07:00 [INF] End processing HTTP request after 494.6113ms - 200
2025-05-24 14:59:21.388 +07:00 [INF] Fetched image for danjo-no-yuujou-wa-seiritsu-suru-iya-shinai from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.401 +07:00 [INF] Received HTTP response headers after 386.2942ms - 200
2025-05-24 14:59:21.403 +07:00 [INF] End processing HTTP request after 423.1676ms - 200
2025-05-24 14:59:21.405 +07:00 [INF] Received HTTP response headers after 415.0422ms - 200
2025-05-24 14:59:21.405 +07:00 [INF] Fetched image for bye-bye-earth-2nd-season from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.406 +07:00 [INF] Received HTTP response headers after 384.2669ms - 200
2025-05-24 14:59:21.408 +07:00 [INF] End processing HTTP request after 445.2999ms - 200
2025-05-24 14:59:21.411 +07:00 [INF] End processing HTTP request after 515.7524ms - 200
2025-05-24 14:59:21.413 +07:00 [INF] Fetched image for knock-out from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.414 +07:00 [INF] Received HTTP response headers after 414.818ms - 200
2025-05-24 14:59:21.415 +07:00 [INF] Fetched image for compass-20-sentou-setsuri-kaiseki-system from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.419 +07:00 [INF] End processing HTTP request after 445.5389ms - 200
2025-05-24 14:59:21.423 +07:00 [INF] Fetched image for danjo-no-yuujou-wa-seiritsu-suru-iya-shinai from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.427 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.434 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.438 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.432 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.430 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.435 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.433 +07:00 [INF] Received HTTP response headers after 479.1083ms - 200
2025-05-24 14:59:21.440 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.444 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.448 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.452 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.454 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.456 +07:00 [INF] End processing HTTP request after 570.3542ms - 200
2025-05-24 14:59:21.458 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.461 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.463 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.465 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.474 +07:00 [INF] Fetched image for knock-out from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.507 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.509 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.516 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.516 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.513 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.519 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.522 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.527 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.529 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.533 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.541 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.539 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.550 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.537 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.574 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.730 +07:00 [INF] Received HTTP response headers after 263.0604ms - 200
2025-05-24 14:59:21.733 +07:00 [INF] End processing HTTP request after 297.584ms - 200
2025-05-24 14:59:21.736 +07:00 [INF] Fetched image for vun-vo from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.859 +07:00 [INF] Received HTTP response headers after 382.8368ms - 200
2025-05-24 14:59:21.860 +07:00 [INF] Received HTTP response headers after 362.9192ms - 200
2025-05-24 14:59:21.861 +07:00 [INF] End processing HTTP request after 421.0113ms - 200
2025-05-24 14:59:21.863 +07:00 [INF] Received HTTP response headers after 311.0566ms - 200
2025-05-24 14:59:21.864 +07:00 [INF] End processing HTTP request after 412.0304ms - 200
2025-05-24 14:59:21.865 +07:00 [INF] Fetched image for nguc-toi-rong-danh-du-cua-ke-trom from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.867 +07:00 [INF] End processing HTTP request after 340.2528ms - 200
2025-05-24 14:59:21.868 +07:00 [INF] Received HTTP response headers after 378.1775ms - 200
2025-05-24 14:59:21.869 +07:00 [INF] Fetched image for tinh-chi-duyen-em from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.872 +07:00 [INF] Fetched image for nguc-toi-rong-danh-du-cua-ke-trom from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.874 +07:00 [INF] Received HTTP response headers after 391.7725ms - 200
2025-05-24 14:59:21.874 +07:00 [INF] End processing HTTP request after 426.7542ms - 200
2025-05-24 14:59:21.880 +07:00 [INF] End processing HTTP request after 435.4606ms - 200
2025-05-24 14:59:21.881 +07:00 [INF] Fetched image for tan-phong-than-na-tra-trung-sinh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.884 +07:00 [INF] Fetched image for neu-khong-gap-em from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.889 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.894 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.900 +07:00 [INF] Received HTTP response headers after 324.4784ms - 200
2025-05-24 14:59:21.900 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.897 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.898 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.898 +07:00 [INF] Received HTTP response headers after 331.9019ms - 200
2025-05-24 14:59:21.892 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.903 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.906 +07:00 [INF] End processing HTTP request after 369.1392ms - 200
2025-05-24 14:59:21.910 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.912 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.916 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.926 +07:00 [INF] Fetched image for neu-khong-gap-em from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.928 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.918 +07:00 [INF] End processing HTTP request after 385.6017ms - 200
2025-05-24 14:59:21.942 +07:00 [INF] Received HTTP response headers after 383.2576ms - 200
2025-05-24 14:59:21.937 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.924 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.951 +07:00 [INF] End processing HTTP request after 428.3787ms - 200
2025-05-24 14:59:21.949 +07:00 [INF] Fetched image for tan-phong-than-na-tra-trung-sinh from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.928 +07:00 [INF] Received HTTP response headers after 385.026ms - 200
2025-05-24 14:59:21.922 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.965 +07:00 [INF] Fetched image for tinh-chi-duyen-em from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.969 +07:00 [INF] End processing HTTP request after 453.3579ms - 200
2025-05-24 14:59:21.971 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.975 +07:00 [INF] Fetched image for vun-vo from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:21.987 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.992 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.995 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:21.998 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.996 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:21.990 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:22.001 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.003 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.007 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.016 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.011 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.025 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.014 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.034 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.044 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 14:59:22.125 +07:00 [INF] Received HTTP response headers after 193.9287ms - 200
2025-05-24 14:59:22.127 +07:00 [INF] End processing HTTP request after 230.2377ms - 200
2025-05-24 14:59:22.130 +07:00 [INF] Fetched image for hien-tuong-di-thuong from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.278 +07:00 [INF] Received HTTP response headers after 325.6054ms - 200
2025-05-24 14:59:22.281 +07:00 [INF] End processing HTTP request after 364.6671ms - 200
2025-05-24 14:59:22.283 +07:00 [INF] Fetched image for hon-di-hon-di from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.303 +07:00 [INF] Received HTTP response headers after 284.9702ms - 200
2025-05-24 14:59:22.305 +07:00 [INF] End processing HTTP request after 310.1677ms - 200
2025-05-24 14:59:22.307 +07:00 [INF] Fetched image for hien-tuong-di-thuong from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.334 +07:00 [INF] Received HTTP response headers after 374.8666ms - 200
2025-05-24 14:59:22.336 +07:00 [INF] End processing HTTP request after 432.9989ms - 200
2025-05-24 14:59:22.338 +07:00 [INF] Fetched image for khom-lung from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.339 +07:00 [INF] Received HTTP response headers after 362.1388ms - 200
2025-05-24 14:59:22.342 +07:00 [INF] End processing HTTP request after 420.528ms - 200
2025-05-24 14:59:22.343 +07:00 [INF] Received HTTP response headers after 401.2564ms - 200
2025-05-24 14:59:22.345 +07:00 [INF] Fetched image for thieu-hoa-nhuoc-cam from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.347 +07:00 [INF] End processing HTTP request after 436.7004ms - 200
2025-05-24 14:59:22.351 +07:00 [INF] Fetched image for pho-fear-nu-hoang-da-hoi from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.353 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 14:59:22.355 +07:00 [INF] Movie cache updated successfully
2025-05-24 14:59:22.357 +07:00 [INF] Enhanced Movie Cache Service is waiting for next run at: "2025-05-24T14:59:22.3569955+07:00"
2025-05-24 14:59:22.384 +07:00 [INF] Received HTTP response headers after 331.1256ms - 200
2025-05-24 14:59:22.384 +07:00 [INF] Received HTTP response headers after 357.0413ms - 200
2025-05-24 14:59:22.387 +07:00 [INF] End processing HTTP request after 372.3302ms - 200
2025-05-24 14:59:22.389 +07:00 [INF] End processing HTTP request after 388.2217ms - 200
2025-05-24 14:59:22.391 +07:00 [INF] Fetched image for thieu-hoa-nhuoc-cam from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.394 +07:00 [INF] Fetched image for khom-lung from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.395 +07:00 [INF] Received HTTP response headers after 359.0608ms - 200
2025-05-24 14:59:22.399 +07:00 [INF] Received HTTP response headers after 353.6255ms - 200
2025-05-24 14:59:22.400 +07:00 [INF] End processing HTTP request after 393.3187ms - 200
2025-05-24 14:59:22.403 +07:00 [INF] End processing HTTP request after 392.1621ms - 200
2025-05-24 14:59:22.405 +07:00 [INF] Fetched image for pho-fear-nu-hoang-da-hoi from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.407 +07:00 [INF] Fetched image for hon-di-hon-di from vv2: {"Success":true,"SubThumb":null,"SubPoster":null}
2025-05-24 14:59:22.411 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 14:59:22.412 +07:00 [INF] Found 50 latest movies from API
2025-05-24 14:59:22.417 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:22.421 +07:00 [INF] Caching movie: trieu-duong-chi-vu-da
2025-05-24 14:59:22.423 +07:00 [INF] Cache hit for movie_detail_trieu-duong-chi-vu-da
2025-05-24 14:59:22.926 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:22.931 +07:00 [INF] Caching movie: ba-lan-ga-cho-ma-quan
2025-05-24 14:59:22.936 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:22.940 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=ba-lan-ga-cho-ma-quan
2025-05-24 14:59:22.941 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:22.943 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:23.291 +07:00 [INF] Received HTTP response headers after 345.228ms - 200
2025-05-24 14:59:23.294 +07:00 [INF] End processing HTTP request after 352.5816ms - 200
2025-05-24 14:59:23.386 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:23.394 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=ba-lan-ga-cho-ma-quan
2025-05-24 14:59:23.395 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:23.398 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:23.715 +07:00 [INF] Received HTTP response headers after 314.8418ms - 200
2025-05-24 14:59:23.718 +07:00 [INF] End processing HTTP request after 322.2179ms - 200
2025-05-24 14:59:23.727 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:23.743 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (DbType = Double), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32), @p21='?' (DbType = DateTime2), @p22='?' (Size = 500), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-05-24 14:59:23.755 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:23.821 +07:00 [ERR] Error storing movie ba-lan-ga-cho-ma-quan in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:23.936 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Description', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:23.952 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=ba-lan-ga-cho-ma-quan
2025-05-24 14:59:23.953 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:23.956 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:24.280 +07:00 [INF] Received HTTP response headers after 321.7869ms - 200
2025-05-24 14:59:24.283 +07:00 [INF] End processing HTTP request after 329.4083ms - 200
2025-05-24 14:59:24.342 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:24.349 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: ba-lan-ga-cho-ma-quan
2025-05-24 14:59:24.854 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:24.858 +07:00 [INF] Caching movie: thieu-dot-con-tim
2025-05-24 14:59:24.861 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:24.865 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=thieu-dot-con-tim
2025-05-24 14:59:24.867 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:24.869 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:25.188 +07:00 [INF] Received HTTP response headers after 316.867ms - 200
2025-05-24 14:59:25.190 +07:00 [INF] End processing HTTP request after 323.5198ms - 200
2025-05-24 14:59:25.245 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:25.251 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=thieu-dot-con-tim
2025-05-24 14:59:25.253 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:25.255 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:25.585 +07:00 [INF] Received HTTP response headers after 328.1429ms - 200
2025-05-24 14:59:25.588 +07:00 [INF] End processing HTTP request after 335.427ms - 200
2025-05-24 14:59:25.593 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:25.660 +07:00 [INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (Size = 1000), @p19='?' (Size = 200), @p20='?' (Size = 4000), @p21='?' (Size = 500), @p22='?' (Size = 50), @p23='?' (Size = 500), @p24='?' (Size = 50), @p25='?' (DbType = DateTime2), @p26='?' (Size = 500), @p27='?' (Size = 500), @p28='?' (Size = 1000), @p29='?' (Size = 50), @p30='?' (Size = -1), @p31='?' (Size = 500), @p32='?' (Size = 1000), @p33='?' (Size = 100), @p34='?' (DbType = Int32), @p35='?' (Size = 10), @p36='?' (DbType = Double), @p37='?' (DbType = Int32), @p38='?' (DbType = Int32), @p39='?' (DbType = DateTime2), @p40='?' (Size = 500), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = Double), @p44='?' (DbType = Int32), @p45='?' (DbType = Int32), @p46='?' (DbType = DateTime2), @p47='?' (Size = 500), @p48='?' (DbType = Int32), @p49='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [CachedMovies] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 0),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 1)) AS i ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
VALUES (i.[Actors], i.[Country], i.[Description], i.[Director], i.[Duration], i.[Genres], i.[Language], i.[LastUpdated], i.[Name], i.[OriginalName], i.[PosterUrl], i.[Quality], i.[RawData], i.[Slug], i.[ThumbUrl], i.[Type], i.[ViewCount], i.[Year])
OUTPUT INSERTED.[Id], i._Position;
MERGE [MovieStatistics] USING (
VALUES (@p36, @p37, @p38, @p39, @p40, @p41, @p42, 0),
(@p43, @p44, @p45, @p46, @p47, @p48, @p49, 1)) AS i ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
VALUES (i.[AverageRating], i.[CommentCount], i.[FavoriteCount], i.[LastUpdated], i.[MovieSlug], i.[RatingCount], i.[ViewCount])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 14:59:25.674 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:25.743 +07:00 [ERR] Error storing movie thieu-dot-con-tim in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:25.865 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:25.881 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=thieu-dot-con-tim
2025-05-24 14:59:25.882 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:25.885 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:26.206 +07:00 [INF] Received HTTP response headers after 318.9867ms - 200
2025-05-24 14:59:26.208 +07:00 [INF] End processing HTTP request after 325.9705ms - 200
2025-05-24 14:59:26.272 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:26.279 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: thieu-dot-con-tim
2025-05-24 14:59:26.783 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:26.787 +07:00 [INF] Caching movie: 2099
2025-05-24 14:59:26.790 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:26.794 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=2099
2025-05-24 14:59:26.796 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:26.798 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:27.119 +07:00 [INF] Received HTTP response headers after 318.5535ms - 200
2025-05-24 14:59:27.121 +07:00 [INF] End processing HTTP request after 325.1176ms - 200
2025-05-24 14:59:27.178 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1608.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1608.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:27.185 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=2099
2025-05-24 14:59:27.187 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:27.190 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:27.512 +07:00 [INF] Received HTTP response headers after 319.7594ms - 200
2025-05-24 14:59:27.515 +07:00 [INF] End processing HTTP request after 327.2426ms - 200
2025-05-24 14:59:27.519 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:27.548 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (Size = 1000), @p19='?' (Size = 200), @p20='?' (Size = 4000), @p21='?' (Size = 500), @p22='?' (Size = 50), @p23='?' (Size = 500), @p24='?' (Size = 50), @p25='?' (DbType = DateTime2), @p26='?' (Size = 500), @p27='?' (Size = 500), @p28='?' (Size = 1000), @p29='?' (Size = 50), @p30='?' (Size = -1), @p31='?' (Size = 500), @p32='?' (Size = 1000), @p33='?' (Size = 100), @p34='?' (DbType = Int32), @p35='?' (Size = 10), @p36='?' (Size = 1000), @p37='?' (Size = 200), @p38='?' (Size = 4000), @p39='?' (Size = 500), @p40='?' (Size = 50), @p41='?' (Size = 500), @p42='?' (Size = 50), @p43='?' (DbType = DateTime2), @p44='?' (Size = 500), @p45='?' (Size = 500), @p46='?' (Size = 1000), @p47='?' (Size = 50), @p48='?' (Size = -1), @p49='?' (Size = 500), @p50='?' (Size = 1000), @p51='?' (Size = 100), @p52='?' (DbType = Int32), @p53='?' (Size = 10), @p54='?' (DbType = Double), @p55='?' (DbType = Int32), @p56='?' (DbType = Int32), @p57='?' (DbType = DateTime2), @p58='?' (Size = 500), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = Double), @p62='?' (DbType = Int32), @p63='?' (DbType = Int32), @p64='?' (DbType = DateTime2), @p65='?' (Size = 500), @p66='?' (DbType = Int32), @p67='?' (DbType = Int32), @p68='?' (DbType = Double), @p69='?' (DbType = Int32), @p70='?' (DbType = Int32), @p71='?' (DbType = DateTime2), @p72='?' (Size = 500), @p73='?' (DbType = Int32), @p74='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [CachedMovies] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 0),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 1),
(@p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, 2)) AS i ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
VALUES (i.[Actors], i.[Country], i.[Description], i.[Director], i.[Duration], i.[Genres], i.[Language], i.[LastUpdated], i.[Name], i.[OriginalName], i.[PosterUrl], i.[Quality], i.[RawData], i.[Slug], i.[ThumbUrl], i.[Type], i.[ViewCount], i.[Year])
OUTPUT INSERTED.[Id], i._Position;
MERGE [MovieStatistics] USING (
VALUES (@p54, @p55, @p56, @p57, @p58, @p59, @p60, 0),
(@p61, @p62, @p63, @p64, @p65, @p66, @p67, 1),
(@p68, @p69, @p70, @p71, @p72, @p73, @p74, 2)) AS i ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
VALUES (i.[AverageRating], i.[CommentCount], i.[FavoriteCount], i.[LastUpdated], i.[MovieSlug], i.[RatingCount], i.[ViewCount])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 14:59:27.560 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:27.628 +07:00 [ERR] Error storing movie 2099 in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:27.743 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:27.758 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=2099
2025-05-24 14:59:27.759 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:27.762 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:28.095 +07:00 [INF] Received HTTP response headers after 331.3962ms - 200
2025-05-24 14:59:28.098 +07:00 [INF] End processing HTTP request after 338.296ms - 200
2025-05-24 14:59:28.165 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:28.171 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: 2099
2025-05-24 14:59:28.676 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:28.680 +07:00 [INF] Caching movie: muon-duoc-o-gan-em
2025-05-24 14:59:28.685 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:28.689 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=muon-duoc-o-gan-em
2025-05-24 14:59:28.690 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:28.692 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:29.025 +07:00 [INF] Received HTTP response headers after 329.7127ms - 200
2025-05-24 14:59:29.027 +07:00 [INF] End processing HTTP request after 336.5062ms - 200
2025-05-24 14:59:29.086 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2037.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2037.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:29.092 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=muon-duoc-o-gan-em
2025-05-24 14:59:29.094 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:29.097 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:29.450 +07:00 [INF] Received HTTP response headers after 351.0345ms - 200
2025-05-24 14:59:29.452 +07:00 [INF] End processing HTTP request after 358.0602ms - 200
2025-05-24 14:59:29.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:29.487 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (Size = 1000), @p19='?' (Size = 200), @p20='?' (Size = 4000), @p21='?' (Size = 500), @p22='?' (Size = 50), @p23='?' (Size = 500), @p24='?' (Size = 50), @p25='?' (DbType = DateTime2), @p26='?' (Size = 500), @p27='?' (Size = 500), @p28='?' (Size = 1000), @p29='?' (Size = 50), @p30='?' (Size = -1), @p31='?' (Size = 500), @p32='?' (Size = 1000), @p33='?' (Size = 100), @p34='?' (DbType = Int32), @p35='?' (Size = 10), @p36='?' (Size = 1000), @p37='?' (Size = 200), @p38='?' (Size = 4000), @p39='?' (Size = 500), @p40='?' (Size = 50), @p41='?' (Size = 500), @p42='?' (Size = 50), @p43='?' (DbType = DateTime2), @p44='?' (Size = 500), @p45='?' (Size = 500), @p46='?' (Size = 1000), @p47='?' (Size = 50), @p48='?' (Size = -1), @p49='?' (Size = 500), @p50='?' (Size = 1000), @p51='?' (Size = 100), @p52='?' (DbType = Int32), @p53='?' (Size = 10), @p54='?' (Size = 1000), @p55='?' (Size = 200), @p56='?' (Size = 4000), @p57='?' (Size = 500), @p58='?' (Size = 50), @p59='?' (Size = 500), @p60='?' (Size = 50), @p61='?' (DbType = DateTime2), @p62='?' (Size = 500), @p63='?' (Size = 500), @p64='?' (Size = 1000), @p65='?' (Size = 50), @p66='?' (Size = -1), @p67='?' (Size = 500), @p68='?' (Size = 1000), @p69='?' (Size = 100), @p70='?' (DbType = Int32), @p71='?' (Size = 10), @p72='?' (DbType = Double), @p73='?' (DbType = Int32), @p74='?' (DbType = Int32), @p75='?' (DbType = DateTime2), @p76='?' (Size = 500), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = Double), @p80='?' (DbType = Int32), @p81='?' (DbType = Int32), @p82='?' (DbType = DateTime2), @p83='?' (Size = 500), @p84='?' (DbType = Int32), @p85='?' (DbType = Int32), @p86='?' (DbType = Double), @p87='?' (DbType = Int32), @p88='?' (DbType = Int32), @p89='?' (DbType = DateTime2), @p90='?' (Size = 500), @p91='?' (DbType = Int32), @p92='?' (DbType = Int32), @p93='?' (DbType = Double), @p94='?' (DbType = Int32), @p95='?' (DbType = Int32), @p96='?' (DbType = DateTime2), @p97='?' (Size = 500), @p98='?' (DbType = Int32), @p99='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [CachedMovies] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 0),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 1),
(@p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, 2),
(@p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69, @p70, @p71, 3)) AS i ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
VALUES (i.[Actors], i.[Country], i.[Description], i.[Director], i.[Duration], i.[Genres], i.[Language], i.[LastUpdated], i.[Name], i.[OriginalName], i.[PosterUrl], i.[Quality], i.[RawData], i.[Slug], i.[ThumbUrl], i.[Type], i.[ViewCount], i.[Year])
OUTPUT INSERTED.[Id], i._Position;
MERGE [MovieStatistics] USING (
VALUES (@p72, @p73, @p74, @p75, @p76, @p77, @p78, 0),
(@p79, @p80, @p81, @p82, @p83, @p84, @p85, 1),
(@p86, @p87, @p88, @p89, @p90, @p91, @p92, 2),
(@p93, @p94, @p95, @p96, @p97, @p98, @p99, 3)) AS i ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
VALUES (i.[AverageRating], i.[CommentCount], i.[FavoriteCount], i.[LastUpdated], i.[MovieSlug], i.[RatingCount], i.[ViewCount])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 14:59:29.499 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:29.572 +07:00 [ERR] Error storing movie muon-duoc-o-gan-em in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:29.685 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:29.699 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=muon-duoc-o-gan-em
2025-05-24 14:59:29.700 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:29.703 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:30.040 +07:00 [INF] Received HTTP response headers after 335.0821ms - 200
2025-05-24 14:59:30.042 +07:00 [INF] End processing HTTP request after 341.9572ms - 200
2025-05-24 14:59:30.104 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:30.111 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: muon-duoc-o-gan-em
2025-05-24 14:59:30.614 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:30.619 +07:00 [INF] Caching movie: am-duong-su-thi-than-lenh
2025-05-24 14:59:30.623 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:30.627 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=am-duong-su-thi-than-lenh
2025-05-24 14:59:30.629 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:30.631 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:30.978 +07:00 [INF] Received HTTP response headers after 343.6229ms - 200
2025-05-24 14:59:30.981 +07:00 [INF] End processing HTTP request after 351.97ms - 200
2025-05-24 14:59:31.035 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1077.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1077.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:31.042 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=am-duong-su-thi-than-lenh
2025-05-24 14:59:31.044 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:31.046 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:31.368 +07:00 [INF] Received HTTP response headers after 320.1513ms - 200
2025-05-24 14:59:31.371 +07:00 [INF] End processing HTTP request after 327.3534ms - 200
2025-05-24 14:59:31.376 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:31.407 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (Size = 1000), @p19='?' (Size = 200), @p20='?' (Size = 4000), @p21='?' (Size = 500), @p22='?' (Size = 50), @p23='?' (Size = 500), @p24='?' (Size = 50), @p25='?' (DbType = DateTime2), @p26='?' (Size = 500), @p27='?' (Size = 500), @p28='?' (Size = 1000), @p29='?' (Size = 50), @p30='?' (Size = -1), @p31='?' (Size = 500), @p32='?' (Size = 1000), @p33='?' (Size = 100), @p34='?' (DbType = Int32), @p35='?' (Size = 10), @p36='?' (Size = 1000), @p37='?' (Size = 200), @p38='?' (Size = 4000), @p39='?' (Size = 500), @p40='?' (Size = 50), @p41='?' (Size = 500), @p42='?' (Size = 50), @p43='?' (DbType = DateTime2), @p44='?' (Size = 500), @p45='?' (Size = 500), @p46='?' (Size = 1000), @p47='?' (Size = 50), @p48='?' (Size = -1), @p49='?' (Size = 500), @p50='?' (Size = 1000), @p51='?' (Size = 100), @p52='?' (DbType = Int32), @p53='?' (Size = 10), @p54='?' (Size = 1000), @p55='?' (Size = 200), @p56='?' (Size = 4000), @p57='?' (Size = 500), @p58='?' (Size = 50), @p59='?' (Size = 500), @p60='?' (Size = 50), @p61='?' (DbType = DateTime2), @p62='?' (Size = 500), @p63='?' (Size = 500), @p64='?' (Size = 1000), @p65='?' (Size = 50), @p66='?' (Size = -1), @p67='?' (Size = 500), @p68='?' (Size = 1000), @p69='?' (Size = 100), @p70='?' (DbType = Int32), @p71='?' (Size = 10), @p72='?' (Size = 1000), @p73='?' (Size = 200), @p74='?' (Size = 4000), @p75='?' (Size = 500), @p76='?' (Size = 50), @p77='?' (Size = 500), @p78='?' (Size = 50), @p79='?' (DbType = DateTime2), @p80='?' (Size = 500), @p81='?' (Size = 500), @p82='?' (Size = 1000), @p83='?' (Size = 50), @p84='?' (Size = 4000), @p85='?' (Size = 500), @p86='?' (Size = 1000), @p87='?' (Size = 100), @p88='?' (DbType = Int32), @p89='?' (Size = 10), @p90='?' (DbType = Double), @p91='?' (DbType = Int32), @p92='?' (DbType = Int32), @p93='?' (DbType = DateTime2), @p94='?' (Size = 500), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = Double), @p98='?' (DbType = Int32), @p99='?' (DbType = Int32), @p100='?' (DbType = DateTime2), @p101='?' (Size = 500), @p102='?' (DbType = Int32), @p103='?' (DbType = Int32), @p104='?' (DbType = Double), @p105='?' (DbType = Int32), @p106='?' (DbType = Int32), @p107='?' (DbType = DateTime2), @p108='?' (Size = 500), @p109='?' (DbType = Int32), @p110='?' (DbType = Int32), @p111='?' (DbType = Double), @p112='?' (DbType = Int32), @p113='?' (DbType = Int32), @p114='?' (DbType = DateTime2), @p115='?' (Size = 500), @p116='?' (DbType = Int32), @p117='?' (DbType = Int32), @p118='?' (DbType = Double), @p119='?' (DbType = Int32), @p120='?' (DbType = Int32), @p121='?' (DbType = DateTime2), @p122='?' (Size = 500), @p123='?' (DbType = Int32), @p124='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [CachedMovies] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 0),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 1),
(@p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, 2),
(@p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69, @p70, @p71, 3),
(@p72, @p73, @p74, @p75, @p76, @p77, @p78, @p79, @p80, @p81, @p82, @p83, @p84, @p85, @p86, @p87, @p88, @p89, 4)) AS i ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
VALUES (i.[Actors], i.[Country], i.[Description], i.[Director], i.[Duration], i.[Genres], i.[Language], i.[LastUpdated], i.[Name], i.[OriginalName], i.[PosterUrl], i.[Quality], i.[RawData], i.[Slug], i.[ThumbUrl], i.[Type], i.[ViewCount], i.[Year])
OUTPUT INSERTED.[Id], i._Position;
MERGE [MovieStatistics] USING (
VALUES (@p90, @p91, @p92, @p93, @p94, @p95, @p96, 0),
(@p97, @p98, @p99, @p100, @p101, @p102, @p103, 1),
(@p104, @p105, @p106, @p107, @p108, @p109, @p110, 2),
(@p111, @p112, @p113, @p114, @p115, @p116, @p117, 3),
(@p118, @p119, @p120, @p121, @p122, @p123, @p124, 4)) AS i ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
VALUES (i.[AverageRating], i.[CommentCount], i.[FavoriteCount], i.[LastUpdated], i.[MovieSlug], i.[RatingCount], i.[ViewCount])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 14:59:31.422 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:31.494 +07:00 [ERR] Error storing movie am-duong-su-thi-than-lenh in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:31.610 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:31.626 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=am-duong-su-thi-than-lenh
2025-05-24 14:59:31.627 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:31.630 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:31.965 +07:00 [INF] Received HTTP response headers after 332.1154ms - 200
2025-05-24 14:59:31.968 +07:00 [INF] End processing HTTP request after 340.1221ms - 200
2025-05-24 14:59:31.972 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:32.017 +07:00 [ERR] Error storing movie am-duong-su-thi-than-lenh in database
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:32.093 +07:00 [WRN] Error fetching movie detail with v2: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:32.100 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: am-duong-su-thi-than-lenh
2025-05-24 14:59:32.603 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:32.608 +07:00 [INF] Caching movie: chainsaw-man
2025-05-24 14:59:32.611 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:32.616 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=chainsaw-man
2025-05-24 14:59:32.618 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:32.620 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:32.935 +07:00 [INF] Received HTTP response headers after 312.5119ms - 200
2025-05-24 14:59:32.938 +07:00 [INF] End processing HTTP request after 320.114ms - 200
2025-05-24 14:59:33.003 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1357.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1357.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:33.009 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=chainsaw-man
2025-05-24 14:59:33.011 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:33.013 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:33.342 +07:00 [INF] Received HTTP response headers after 326.1939ms - 200
2025-05-24 14:59:33.344 +07:00 [INF] End processing HTTP request after 333.5358ms - 200
2025-05-24 14:59:33.350 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:33.385 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p18='?' (Size = 1000), @p19='?' (Size = 200), @p20='?' (Size = 4000), @p21='?' (Size = 500), @p22='?' (Size = 50), @p23='?' (Size = 500), @p24='?' (Size = 50), @p25='?' (DbType = DateTime2), @p26='?' (Size = 500), @p27='?' (Size = 500), @p28='?' (Size = 1000), @p29='?' (Size = 50), @p30='?' (Size = -1), @p31='?' (Size = 500), @p32='?' (Size = 1000), @p33='?' (Size = 100), @p34='?' (DbType = Int32), @p35='?' (Size = 10), @p36='?' (Size = 1000), @p37='?' (Size = 200), @p38='?' (Size = 4000), @p39='?' (Size = 500), @p40='?' (Size = 50), @p41='?' (Size = 500), @p42='?' (Size = 50), @p43='?' (DbType = DateTime2), @p44='?' (Size = 500), @p45='?' (Size = 500), @p46='?' (Size = 1000), @p47='?' (Size = 50), @p48='?' (Size = -1), @p49='?' (Size = 500), @p50='?' (Size = 1000), @p51='?' (Size = 100), @p52='?' (DbType = Int32), @p53='?' (Size = 10), @p54='?' (Size = 1000), @p55='?' (Size = 200), @p56='?' (Size = 4000), @p57='?' (Size = 500), @p58='?' (Size = 50), @p59='?' (Size = 500), @p60='?' (Size = 50), @p61='?' (DbType = DateTime2), @p62='?' (Size = 500), @p63='?' (Size = 500), @p64='?' (Size = 1000), @p65='?' (Size = 50), @p66='?' (Size = -1), @p67='?' (Size = 500), @p68='?' (Size = 1000), @p69='?' (Size = 100), @p70='?' (DbType = Int32), @p71='?' (Size = 10), @p72='?' (Size = 1000), @p73='?' (Size = 200), @p74='?' (Size = 4000), @p75='?' (Size = 500), @p76='?' (Size = 50), @p77='?' (Size = 500), @p78='?' (Size = 50), @p79='?' (DbType = DateTime2), @p80='?' (Size = 500), @p81='?' (Size = 500), @p82='?' (Size = 1000), @p83='?' (Size = 50), @p84='?' (Size = 4000), @p85='?' (Size = 500), @p86='?' (Size = 1000), @p87='?' (Size = 100), @p88='?' (DbType = Int32), @p89='?' (Size = 10), @p90='?' (Size = 1000), @p91='?' (Size = 200), @p92='?' (Size = 4000), @p93='?' (Size = 500), @p94='?' (Size = 50), @p95='?' (Size = 500), @p96='?' (Size = 50), @p97='?' (DbType = DateTime2), @p98='?' (Size = 500), @p99='?' (Size = 500), @p100='?' (Size = 1000), @p101='?' (Size = 50), @p102='?' (Size = 4000), @p103='?' (Size = 500), @p104='?' (Size = 1000), @p105='?' (Size = 100), @p106='?' (DbType = Int32), @p107='?' (Size = 10), @p108='?' (Size = 1000), @p109='?' (Size = 200), @p110='?' (Size = 4000), @p111='?' (Size = 500), @p112='?' (Size = 50), @p113='?' (Size = 500), @p114='?' (Size = 50), @p115='?' (DbType = DateTime2), @p116='?' (Size = 500), @p117='?' (Size = 500), @p118='?' (Size = 1000), @p119='?' (Size = 50), @p120='?' (Size = 4000), @p121='?' (Size = 500), @p122='?' (Size = 1000), @p123='?' (Size = 100), @p124='?' (DbType = Int32), @p125='?' (Size = 10), @p126='?' (DbType = Double), @p127='?' (DbType = Int32), @p128='?' (DbType = Int32), @p129='?' (DbType = DateTime2), @p130='?' (Size = 500), @p131='?' (DbType = Int32), @p132='?' (DbType = Int32), @p133='?' (DbType = Double), @p134='?' (DbType = Int32), @p135='?' (DbType = Int32), @p136='?' (DbType = DateTime2), @p137='?' (Size = 500), @p138='?' (DbType = Int32), @p139='?' (DbType = Int32), @p140='?' (DbType = Double), @p141='?' (DbType = Int32), @p142='?' (DbType = Int32), @p143='?' (DbType = DateTime2), @p144='?' (Size = 500), @p145='?' (DbType = Int32), @p146='?' (DbType = Int32), @p147='?' (DbType = Double), @p148='?' (DbType = Int32), @p149='?' (DbType = Int32), @p150='?' (DbType = DateTime2), @p151='?' (Size = 500), @p152='?' (DbType = Int32), @p153='?' (DbType = Int32), @p154='?' (DbType = Double), @p155='?' (DbType = Int32), @p156='?' (DbType = Int32), @p157='?' (DbType = DateTime2), @p158='?' (Size = 500), @p159='?' (DbType = Int32), @p160='?' (DbType = Int32), @p161='?' (DbType = Double), @p162='?' (DbType = Int32), @p163='?' (DbType = Int32), @p164='?' (DbType = DateTime2), @p165='?' (Size = 500), @p166='?' (DbType = Int32), @p167='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [CachedMovies] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 0),
(@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 1),
(@p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, 2),
(@p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69, @p70, @p71, 3),
(@p72, @p73, @p74, @p75, @p76, @p77, @p78, @p79, @p80, @p81, @p82, @p83, @p84, @p85, @p86, @p87, @p88, @p89, 4),
(@p90, @p91, @p92, @p93, @p94, @p95, @p96, @p97, @p98, @p99, @p100, @p101, @p102, @p103, @p104, @p105, @p106, @p107, 5),
(@p108, @p109, @p110, @p111, @p112, @p113, @p114, @p115, @p116, @p117, @p118, @p119, @p120, @p121, @p122, @p123, @p124, @p125, 6)) AS i ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [Type], [ViewCount], [Year])
VALUES (i.[Actors], i.[Country], i.[Description], i.[Director], i.[Duration], i.[Genres], i.[Language], i.[LastUpdated], i.[Name], i.[OriginalName], i.[PosterUrl], i.[Quality], i.[RawData], i.[Slug], i.[ThumbUrl], i.[Type], i.[ViewCount], i.[Year])
OUTPUT INSERTED.[Id], i._Position;
MERGE [MovieStatistics] USING (
VALUES (@p126, @p127, @p128, @p129, @p130, @p131, @p132, 0),
(@p133, @p134, @p135, @p136, @p137, @p138, @p139, 1),
(@p140, @p141, @p142, @p143, @p144, @p145, @p146, 2),
(@p147, @p148, @p149, @p150, @p151, @p152, @p153, 3),
(@p154, @p155, @p156, @p157, @p158, @p159, @p160, 4),
(@p161, @p162, @p163, @p164, @p165, @p166, @p167, 5)) AS i ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
VALUES (i.[AverageRating], i.[CommentCount], i.[FavoriteCount], i.[LastUpdated], i.[MovieSlug], i.[RatingCount], i.[ViewCount])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 14:59:33.400 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:33.466 +07:00 [ERR] Error storing movie chainsaw-man in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:33.591 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Language', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edeacf19-aceb-4144-8af1-7155b1049e08
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:33.608 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=chainsaw-man
2025-05-24 14:59:33.609 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:33.611 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:33.990 +07:00 [INF] Received HTTP response headers after 376.8793ms - 200
2025-05-24 14:59:33.993 +07:00 [INF] End processing HTTP request after 384.063ms - 200
2025-05-24 14:59:34.000 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:34.038 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:34.109 +07:00 [WRN] Error fetching movie detail with v2: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:34.115 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: chainsaw-man
2025-05-24 14:59:34.617 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:34.622 +07:00 [INF] Caching movie: van-gioi-doc-ton
2025-05-24 14:59:34.625 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:34.629 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=van-gioi-doc-ton
2025-05-24 14:59:34.631 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:34.633 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:34.966 +07:00 [INF] Received HTTP response headers after 330.756ms - 200
2025-05-24 14:59:34.968 +07:00 [INF] End processing HTTP request after 337.5569ms - 200
2025-05-24 14:59:35.042 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1352.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1352.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:35.048 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=van-gioi-doc-ton
2025-05-24 14:59:35.049 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:35.051 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:35.387 +07:00 [INF] Received HTTP response headers after 333.0589ms - 200
2025-05-24 14:59:35.389 +07:00 [INF] End processing HTTP request after 339.9402ms - 200
2025-05-24 14:59:35.393 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:35.433 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:35.507 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:35.513 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=van-gioi-doc-ton
2025-05-24 14:59:35.514 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:35.516 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:35.575 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - null null
2025-05-24 14:59:35.582 +07:00 [INF] HTTP Request - RequestId: 6a3ba4db-31c5-432c-b67b-999876b1c334, Method: GET, Path: /api/User/history, QueryString: ?page=1&limit=20, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 14:59:35.588 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 14:59:35.590 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 14:59:35.592 +07:00 [INF] HTTP Response - RequestId: 6a3ba4db-31c5-432c-b67b-999876b1c334, StatusCode: 401, ContentLength: null, ElapsedMs: 9
2025-05-24 14:59:35.595 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/history, StatusCode: 401, ElapsedMs: 13, Category: Excellent
2025-05-24 14:59:35.599 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - 401 0 null 24.7841ms
2025-05-24 14:59:35.863 +07:00 [INF] Received HTTP response headers after 343.9428ms - 200
2025-05-24 14:59:35.866 +07:00 [INF] End processing HTTP request after 351.259ms - 200
2025-05-24 14:59:35.937 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:35.943 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: van-gioi-doc-ton
2025-05-24 14:59:36.447 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:36.451 +07:00 [INF] Caching movie: tuyet-the-chien-hon-3d
2025-05-24 14:59:36.454 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:36.458 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=tuyet-the-chien-hon-3d
2025-05-24 14:59:36.460 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:36.462 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:36.780 +07:00 [INF] Received HTTP response headers after 315.9928ms - 200
2025-05-24 14:59:36.783 +07:00 [INF] End processing HTTP request after 322.9739ms - 200
2025-05-24 14:59:36.849 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1596.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1596.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:36.856 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=tuyet-the-chien-hon-3d
2025-05-24 14:59:36.857 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:36.860 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:37.194 +07:00 [INF] Received HTTP response headers after 331.4539ms - 200
2025-05-24 14:59:37.196 +07:00 [INF] End processing HTTP request after 338.6406ms - 200
2025-05-24 14:59:37.201 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:37.238 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:37.314 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:37.320 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=tuyet-the-chien-hon-3d
2025-05-24 14:59:37.322 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:37.324 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:37.656 +07:00 [INF] Received HTTP response headers after 329.3256ms - 200
2025-05-24 14:59:37.658 +07:00 [INF] End processing HTTP request after 336.4892ms - 200
2025-05-24 14:59:37.662 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:37.701 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:37.779 +07:00 [WRN] Error fetching movie detail with v2: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:37.785 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: tuyet-the-chien-hon-3d
2025-05-24 14:59:38.287 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:38.292 +07:00 [INF] Caching movie: tien-vo-de-ton
2025-05-24 14:59:38.296 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:38.300 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=tien-vo-de-ton
2025-05-24 14:59:38.301 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:38.303 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:38.635 +07:00 [INF] Received HTTP response headers after 330.3029ms - 200
2025-05-24 14:59:38.638 +07:00 [INF] End processing HTTP request after 337.046ms - 200
2025-05-24 14:59:38.701 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1481.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1481.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:38.708 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=tien-vo-de-ton
2025-05-24 14:59:38.710 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:38.712 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:39.041 +07:00 [INF] Received HTTP response headers after 325.3936ms - 200
2025-05-24 14:59:39.043 +07:00 [INF] End processing HTTP request after 333.6945ms - 200
2025-05-24 14:59:39.047 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:39.084 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:39.172 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:39.179 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=tien-vo-de-ton
2025-05-24 14:59:39.181 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:39.184 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:39.517 +07:00 [INF] Received HTTP response headers after 330.337ms - 200
2025-05-24 14:59:39.520 +07:00 [INF] End processing HTTP request after 338.8466ms - 200
2025-05-24 14:59:39.524 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:39.567 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:39.656 +07:00 [WRN] Error fetching movie detail with v2: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:39.662 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: tien-vo-de-ton
2025-05-24 14:59:40.167 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:40.171 +07:00 [INF] Caching movie: thang-cap-manh-nhat
2025-05-24 14:59:40.176 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:40.181 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=thang-cap-manh-nhat
2025-05-24 14:59:40.182 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:40.185 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:40.516 +07:00 [INF] Received HTTP response headers after 329.1039ms - 200
2025-05-24 14:59:40.519 +07:00 [INF] End processing HTTP request after 336.4489ms - 200
2025-05-24 14:59:40.575 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1694.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1694.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:40.582 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=thang-cap-manh-nhat
2025-05-24 14:59:40.584 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:40.586 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:40.902 +07:00 [INF] Received HTTP response headers after 313.2894ms - 200
2025-05-24 14:59:40.904 +07:00 [INF] End processing HTTP request after 320.5288ms - 200
2025-05-24 14:59:40.911 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:40.950 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:41.028 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:41.034 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=thang-cap-manh-nhat
2025-05-24 14:59:41.036 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:41.039 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:41.387 +07:00 [INF] Received HTTP response headers after 346.5759ms - 200
2025-05-24 14:59:41.390 +07:00 [INF] End processing HTTP request after 353.8107ms - 200
2025-05-24 14:59:41.456 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:41.463 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: thang-cap-manh-nhat
2025-05-24 14:59:41.970 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:41.974 +07:00 [INF] Caching movie: thai-co-chien-hon
2025-05-24 14:59:41.978 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:41.982 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=thai-co-chien-hon
2025-05-24 14:59:41.983 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:41.985 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:42.369 +07:00 [INF] Received HTTP response headers after 381.7797ms - 200
2025-05-24 14:59:42.372 +07:00 [INF] End processing HTTP request after 388.8867ms - 200
2025-05-24 14:59:42.439 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1509.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1509.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:42.446 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=thai-co-chien-hon
2025-05-24 14:59:42.448 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:42.450 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:42.775 +07:00 [INF] Received HTTP response headers after 322.8998ms - 200
2025-05-24 14:59:42.777 +07:00 [INF] End processing HTTP request after 329.4218ms - 200
2025-05-24 14:59:42.783 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:42.826 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:42.911 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:42.917 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=thai-co-chien-hon
2025-05-24 14:59:42.918 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:42.920 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:43.244 +07:00 [INF] Received HTTP response headers after 321.7566ms - 200
2025-05-24 14:59:43.247 +07:00 [INF] End processing HTTP request after 328.8397ms - 200
2025-05-24 14:59:43.300 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:43.306 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: thai-co-chien-hon
2025-05-24 14:59:43.810 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:43.815 +07:00 [INF] Caching movie: pham-nhan-tu-tien-3
2025-05-24 14:59:43.820 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:43.824 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=pham-nhan-tu-tien-3
2025-05-24 14:59:43.825 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:43.827 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:44.174 +07:00 [INF] Received HTTP response headers after 344.4378ms - 200
2025-05-24 14:59:44.177 +07:00 [INF] End processing HTTP request after 351.6372ms - 200
2025-05-24 14:59:44.234 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 764.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 764.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:44.239 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=pham-nhan-tu-tien-3
2025-05-24 14:59:44.240 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:44.242 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:44.564 +07:00 [INF] Received HTTP response headers after 320.2191ms - 200
2025-05-24 14:59:44.567 +07:00 [INF] End processing HTTP request after 326.3402ms - 200
2025-05-24 14:59:44.571 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:44.612 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:44.693 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:44.699 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=pham-nhan-tu-tien-3
2025-05-24 14:59:44.700 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:44.703 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:45.032 +07:00 [INF] Received HTTP response headers after 327.1412ms - 200
2025-05-24 14:59:45.035 +07:00 [INF] End processing HTTP request after 334.8896ms - 200
2025-05-24 14:59:45.040 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:45.083 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:45.166 +07:00 [WRN] Error fetching movie detail with v2: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:45.173 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: pham-nhan-tu-tien-3
2025-05-24 14:59:45.678 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:45.682 +07:00 [INF] Caching movie: tuyet-chung-2018
2025-05-24 14:59:45.686 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:45.690 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=tuyet-chung-2018
2025-05-24 14:59:45.692 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:45.694 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:46.012 +07:00 [INF] Received HTTP response headers after 315.6766ms - 200
2025-05-24 14:59:46.015 +07:00 [INF] End processing HTTP request after 323.2401ms - 200
2025-05-24 14:59:46.070 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1014.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1014.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:46.077 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=tuyet-chung-2018
2025-05-24 14:59:46.079 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:46.081 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:46.394 +07:00 [INF] Received HTTP response headers after 310.6299ms - 200
2025-05-24 14:59:46.396 +07:00 [INF] End processing HTTP request after 317.4747ms - 200
2025-05-24 14:59:46.404 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:46.420 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:46.462 +07:00 [ERR] Error storing movie tuyet-chung-2018 in database
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:46.535 +07:00 [WRN] Error fetching movie detail with v3: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:46.543 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=tuyet-chung-2018
2025-05-24 14:59:46.545 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:46.547 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:46.860 +07:00 [INF] Received HTTP response headers after 311.2718ms - 200
2025-05-24 14:59:46.863 +07:00 [INF] End processing HTTP request after 317.8982ms - 200
2025-05-24 14:59:46.868 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:46.908 +07:00 [ERR] Error storing movie tuyet-chung-2018 in database
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:46.992 +07:00 [WRN] Error fetching movie detail with v2: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:47.001 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: tuyet-chung-2018
2025-05-24 14:59:47.507 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:47.511 +07:00 [INF] Caching movie: bu-nhin
2025-05-24 14:59:47.516 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:47.520 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=bu-nhin
2025-05-24 14:59:47.522 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:47.525 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:47.944 +07:00 [INF] Received HTTP response headers after 416.2437ms - 200
2025-05-24 14:59:47.946 +07:00 [INF] End processing HTTP request after 424.2251ms - 200
2025-05-24 14:59:48.005 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 993.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 993.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:48.012 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=bu-nhin
2025-05-24 14:59:48.013 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:48.016 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:48.341 +07:00 [INF] Received HTTP response headers after 322.4892ms - 200
2025-05-24 14:59:48.343 +07:00 [INF] End processing HTTP request after 329.8458ms - 200
2025-05-24 14:59:48.348 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:48.359 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:48.407 +07:00 [ERR] Error storing movie bu-nhin in database
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:48.485 +07:00 [WRN] Error fetching movie detail with v3: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:48.494 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=bu-nhin
2025-05-24 14:59:48.495 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:48.497 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:48.827 +07:00 [INF] Received HTTP response headers after 327.4425ms - 200
2025-05-24 14:59:48.830 +07:00 [INF] End processing HTTP request after 334.2964ms - 200
2025-05-24 14:59:48.834 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:48.877 +07:00 [ERR] Error storing movie bu-nhin in database
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:48.959 +07:00 [WRN] Error fetching movie detail with v2: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:48.966 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: bu-nhin
2025-05-24 14:59:49.470 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:49.475 +07:00 [INF] Caching movie: trung-thien-than
2025-05-24 14:59:49.479 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:49.484 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trung-thien-than
2025-05-24 14:59:49.486 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:49.489 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:49.811 +07:00 [INF] Received HTTP response headers after 320.2976ms - 200
2025-05-24 14:59:49.814 +07:00 [INF] End processing HTTP request after 328.8076ms - 200
2025-05-24 14:59:49.877 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 865.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 865.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 163
2025-05-24 14:59:49.885 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=trung-thien-than
2025-05-24 14:59:49.886 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:49.889 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 14:59:50.233 +07:00 [INF] Received HTTP response headers after 341.6637ms - 200
2025-05-24 14:59:50.236 +07:00 [INF] End processing HTTP request after 349.1761ms - 200
2025-05-24 14:59:50.240 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:50.251 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 14:59:50.299 +07:00 [ERR] Error storing movie trung-thien-than in database
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
2025-05-24 14:59:50.390 +07:00 [WRN] Error fetching movie detail with v3: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 761
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:50.400 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=trung-thien-than
2025-05-24 14:59:50.402 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:50.404 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 14:59:50.741 +07:00 [INF] Received HTTP response headers after 334.0509ms - 200
2025-05-24 14:59:50.744 +07:00 [INF] End processing HTTP request after 342.2942ms - 200
2025-05-24 14:59:50.749 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 14:59:50.798 +07:00 [ERR] Error storing movie trung-thien-than in database
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
2025-05-24 14:59:50.883 +07:00 [WRN] Error fetching movie detail with v2: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'CachedMovie' cannot be tracked because another instance with the same key value for {'Slug'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 691
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 173
2025-05-24 14:59:50.891 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: trung-thien-than
2025-05-24 14:59:51.396 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 14:59:51.401 +07:00 [INF] Caching movie: luyen-khi-muoi-van-nam
2025-05-24 14:59:51.405 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 14:59:51.411 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=luyen-khi-muoi-van-nam
2025-05-24 14:59:51.413 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:51.415 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 14:59:51.740 +07:00 [INF] Received HTTP response headers after 321.586ms - 200
2025-05-24 14:59:51.744 +07:00 [INF] End processing HTTP request after 330.9017ms - 200
2025-05-24 15:25:51.705 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:25:54.803 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:25:54.879 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:25:54.897 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:25:54.904 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:25:54.936 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:25:54.972 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:25:55.320 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:25:55.369 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:25:55.381 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:25:55.578 +07:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:25:55.664 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:25:55.672 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:25:55.712 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:25:55.898 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:25:55.904 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:25:55.909 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:25:55.924 +07:00 [INF] Performance Metrics - WorkingSet: 135.50MB, PrivateMemory: 72.74MB, GC Memory: 20.86MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:25:55.932 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:25:55.935 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:25:56.393 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:25:56.395 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:25:56.398 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:25:56.399 +07:00 [INF] Hosting environment: Development
2025-05-24 15:25:56.401 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:25:57.329 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:25:57.734 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 420.8387ms
2025-05-24 15:25:57.838 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:25:57.838 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:25:57.838 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:25:57.849 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 11.9811ms
2025-05-24 15:25:57.880 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 42.7758ms
2025-05-24 15:25:57.961 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 123.9966ms
2025-05-24 15:25:58.043 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:25:58.354 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 311.6112ms
2025-05-24 15:26:13.513 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - null null
2025-05-24 15:26:13.536 +07:00 [INF] HTTP Request - RequestId: 0ee4c7d4-00da-401c-937d-37a37375dfc0, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:26:13.718 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:26:13.766 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:26:13.856 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=1
2025-05-24 15:26:13.869 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:26:13.916 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:26:14.266 +07:00 [INF] Received HTTP response headers after 343.3286ms - 200
2025-05-24 15:26:14.274 +07:00 [INF] End processing HTTP request after 412.6786ms - 200
2025-05-24 15:26:14.359 +07:00 [ERR] Failed executing DbCommand (11ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:26:14.391 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
2025-05-24 15:26:14.516 +07:00 [ERR] Error enriching movie trieu-duong-chi-vu-da with images
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.EnrichMovieWithImageAsync(MovieItem movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 557
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
2025-05-24 15:26:14.565 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:26:14.579 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:26:14.639 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 861.8093ms
2025-05-24 15:26:14.643 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:26:14.652 +07:00 [INF] HTTP Response - RequestId: 0ee4c7d4-00da-401c-937d-37a37375dfc0, StatusCode: 200, ContentLength: null, ElapsedMs: 1122
2025-05-24 15:26:14.661 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - 200 null application/json; charset=utf-8 1148.3616ms
2025-05-24 15:26:36.313 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - null null
2025-05-24 15:26:36.339 +07:00 [INF] HTTP Request - RequestId: 63270356-bf43-4f88-9765-82b7c1b1665b, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:26:36.345 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:26:36.355 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:26:36.504 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:26:36.513 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
2025-05-24 15:26:36.646 +07:00 [ERR] Error getting movie detail for slug: trieu-duong-chi-vu-da
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TrailerUrl'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 134
   at WebAppApiPhim.Controllers.MoviesController.GetMovieDetail(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Controllers\MoviesController.cs:line 91
ClientConnectionId:7902f110-8e3e-4632-9a0b-e7f0dab96d0e
Error Number:207,State:1,Class:16
2025-05-24 15:26:36.662 +07:00 [INF] Executing ObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:26:36.688 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 329.1824ms
2025-05-24 15:26:36.691 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:26:36.694 +07:00 [INF] HTTP Response - RequestId: 63270356-bf43-4f88-9765-82b7c1b1665b, StatusCode: 500, ContentLength: null, ElapsedMs: 355
2025-05-24 15:26:36.698 +07:00 [WRN] Error Response - RequestId: 63270356-bf43-4f88-9765-82b7c1b1665b, StatusCode: 500, Body: 5  t]zj *bj1:CC1X(6LVxEuSFv=WD
q6X3-}
2025-05-24 15:26:36.703 +07:00 [ERR] Performance Metric - Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, StatusCode: 500, ElapsedMs: 364, Category: Good
2025-05-24 15:26:36.712 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - 500 null application/json; charset=utf-8 400.1035ms
2025-05-24 15:29:08.639 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:29:08.759 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:29:08.764 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:29:08.766 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:29:08.794 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:29:08.822 +07:00 [INF] Applying migration '20250524082854_AddTrailerUrlToCachedMovie'.
2025-05-24 15:29:09.092 +07:00 [INF] Executed DbCommand (147ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Type');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Type] nvarchar(100) NULL;
2025-05-24 15:29:09.117 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'RawData');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [RawData] ntext NULL;
2025-05-24 15:29:09.145 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Quality');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Quality] nvarchar(50) NULL;
2025-05-24 15:29:09.170 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Language');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Language] nvarchar(50) NULL;
2025-05-24 15:29:09.196 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Genres');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Genres] nvarchar(500) NULL;
2025-05-24 15:29:09.221 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Duration');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Duration] nvarchar(50) NULL;
2025-05-24 15:29:09.246 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Director');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Director] nvarchar(500) NULL;
2025-05-24 15:29:09.271 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Description');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Description] ntext NULL;
2025-05-24 15:29:09.295 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Country');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Country] nvarchar(200) NULL;
2025-05-24 15:29:09.408 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Actors');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var9 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Actors] nvarchar(1000) NULL;
2025-05-24 15:29:09.413 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [CachedMovies] ADD [TrailerUrl] nvarchar(1000) NULL;
2025-05-24 15:29:09.424 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250524082854_AddTrailerUrlToCachedMovie', N'8.0.0');
2025-05-24 15:29:29.035 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:29:30.835 +07:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:29:30.913 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:29:30.923 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:29:30.935 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:29:30.962 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:29:30.994 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:29:31.330 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:29:31.368 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:29:31.380 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:29:31.561 +07:00 [INF] Executed DbCommand (53ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:29:31.648 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:29:31.655 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:29:31.687 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:29:31.847 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:29:31.852 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:29:31.856 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:29:31.872 +07:00 [INF] Performance Metrics - WorkingSet: 131.55MB, PrivateMemory: 71.54MB, GC Memory: 20.85MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:29:31.878 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:29:31.881 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:29:32.251 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:29:32.253 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:29:32.255 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:29:32.257 +07:00 [INF] Hosting environment: Development
2025-05-24 15:29:32.259 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:29:33.272 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:29:33.578 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 316.2271ms
2025-05-24 15:29:33.642 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:29:33.641 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:29:33.642 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:29:33.675 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 35.0763ms
2025-05-24 15:29:33.681 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 41.3594ms
2025-05-24 15:29:33.760 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.9694ms
2025-05-24 15:29:33.845 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:29:34.083 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 238.729ms
2025-05-24 15:29:48.970 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - null null
2025-05-24 15:29:48.994 +07:00 [INF] HTTP Request - RequestId: dc801eb4-cbdf-4d9e-a894-208e9bb7f687, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:29:49.120 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:29:49.163 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:29:49.244 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=1
2025-05-24 15:29:49.256 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:29:49.285 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:29:49.568 +07:00 [INF] Received HTTP response headers after 276.1011ms - 200
2025-05-24 15:29:49.579 +07:00 [INF] End processing HTTP request after 329.7949ms - 200
2025-05-24 15:29:49.691 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:29:49.697 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:29:49.700 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:29:49.908 +07:00 [INF] Received HTTP response headers after 204.8101ms - 200
2025-05-24 15:29:49.911 +07:00 [INF] End processing HTTP request after 214.3246ms - 200
2025-05-24 15:29:49.926 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:29:49.940 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:29:50.001 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 827.2085ms
2025-05-24 15:29:50.005 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:29:50.012 +07:00 [INF] HTTP Response - RequestId: dc801eb4-cbdf-4d9e-a894-208e9bb7f687, StatusCode: 200, ContentLength: null, ElapsedMs: 1026
2025-05-24 15:29:50.021 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - 200 null application/json; charset=utf-8 1051.8608ms
2025-05-24 15:30:07.495 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - null null
2025-05-24 15:30:07.504 +07:00 [INF] HTTP Request - RequestId: 23cf336b-5853-4816-9c8b-a7aff0f2cd26, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:30:07.512 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:30:07.521 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:30:07.662 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:30:07.667 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trieu-duong-chi-vu-da
2025-05-24 15:30:07.669 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:30:07.671 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:30:08.595 +07:00 [INF] Received HTTP response headers after 921.5174ms - 200
2025-05-24 15:30:08.598 +07:00 [INF] End processing HTTP request after 928.9981ms - 200
2025-05-24 15:30:08.775 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:30:08.841 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=trieu-duong-chi-vu-da
2025-05-24 15:30:08.843 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:30:08.846 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:30:09.828 +07:00 [INF] Received HTTP response headers after 979.4739ms - 200
2025-05-24 15:30:09.831 +07:00 [INF] End processing HTTP request after 988.1124ms - 200
2025-05-24 15:30:10.068 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:30:10.480 +07:00 [INF] Executed DbCommand (57ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:30:10.533 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8fa9cb7e-5577-4966-8083-0038fd7944f8
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8fa9cb7e-5577-4966-8083-0038fd7944f8
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 15:30:10.645 +07:00 [ERR] Error storing movie trieu-duong-chi-vu-da in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8fa9cb7e-5577-4966-8083-0038fd7944f8
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
2025-05-24 15:30:10.764 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8fa9cb7e-5577-4966-8083-0038fd7944f8
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 183
2025-05-24 15:30:10.784 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=trieu-duong-chi-vu-da
2025-05-24 15:30:10.786 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:30:10.789 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:30:12.007 +07:00 [INF] Received HTTP response headers after 1216.2517ms - 200
2025-05-24 15:30:12.011 +07:00 [INF] End processing HTTP request after 1224.8452ms - 200
2025-05-24 15:30:12.088 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:30:12.096 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: trieu-duong-chi-vu-da
2025-05-24 15:30:12.100 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:30:12.113 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 4588.0632ms
2025-05-24 15:30:12.116 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:30:12.118 +07:00 [INF] HTTP Response - RequestId: 23cf336b-5853-4816-9c8b-a7aff0f2cd26, StatusCode: 404, ContentLength: null, ElapsedMs: 4614
2025-05-24 15:30:12.122 +07:00 [WRN] Error Response - RequestId: 23cf336b-5853-4816-9c8b-a7aff0f2cd26, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 15:30:12.126 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, StatusCode: 404, ElapsedMs: 4621, Category: Very Slow
2025-05-24 15:30:12.135 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - 404 null application/json; charset=utf-8 4640.001ms
2025-05-24 15:32:27.118 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:32:28.882 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:32:28.955 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:32:28.963 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:32:28.969 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:32:29.003 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:32:29.035 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:32:29.344 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:32:29.385 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:32:29.397 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:32:29.546 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:32:29.629 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:32:29.639 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:32:29.671 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:32:29.836 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:32:29.842 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:32:29.847 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:32:29.863 +07:00 [INF] Performance Metrics - WorkingSet: 131.34MB, PrivateMemory: 71.47MB, GC Memory: 20.81MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:32:29.871 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:32:29.875 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:32:30.263 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:32:30.265 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:32:30.267 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:32:30.269 +07:00 [INF] Hosting environment: Development
2025-05-24 15:32:30.271 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:32:30.922 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:32:31.263 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 355.2031ms
2025-05-24 15:32:31.323 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:32:31.323 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:32:31.323 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:32:31.367 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 45.2394ms
2025-05-24 15:32:31.392 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 70.5011ms
2025-05-24 15:32:31.434 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 111.6012ms
2025-05-24 15:32:31.508 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:32:31.783 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 275.6156ms
2025-05-24 15:32:43.616 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - null null
2025-05-24 15:32:43.636 +07:00 [INF] HTTP Request - RequestId: 0b06622c-5e9c-4fa3-ae3a-9121cc3b9bbb, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:32:43.754 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:32:43.790 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:32:43.858 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=1
2025-05-24 15:32:43.869 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:32:43.894 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:32:44.211 +07:00 [INF] Received HTTP response headers after 312.0054ms - 200
2025-05-24 15:32:44.221 +07:00 [INF] End processing HTTP request after 357.7935ms - 200
2025-05-24 15:32:44.314 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:32:44.321 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:32:44.323 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:32:44.744 +07:00 [INF] Received HTTP response headers after 417.9612ms - 200
2025-05-24 15:32:44.747 +07:00 [INF] End processing HTTP request after 426.355ms - 200
2025-05-24 15:32:44.760 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:32:44.773 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:32:44.827 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 1027.6764ms
2025-05-24 15:32:44.831 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:32:44.838 +07:00 [INF] HTTP Response - RequestId: 0b06622c-5e9c-4fa3-ae3a-9121cc3b9bbb, StatusCode: 200, ContentLength: null, ElapsedMs: 1206
2025-05-24 15:32:44.845 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=1 - 200 null application/json; charset=utf-8 1229.7264ms
2025-05-24 15:33:18.686 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - null null
2025-05-24 15:33:18.703 +07:00 [INF] HTTP Request - RequestId: 3f96afef-431c-4648-961a-f629ff7bfcd6, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:33:18.711 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:33:18.719 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:33:18.849 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:33:18.855 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trieu-duong-chi-vu-da
2025-05-24 15:33:18.856 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:33:18.859 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:33:20.010 +07:00 [INF] Received HTTP response headers after 1148.6736ms - 200
2025-05-24 15:33:20.013 +07:00 [INF] End processing HTTP request after 1156.724ms - 200
2025-05-24 15:33:20.181 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1719.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:33:20.235 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=trieu-duong-chi-vu-da
2025-05-24 15:33:20.237 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:33:20.239 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:33:20.586 +07:00 [INF] Received HTTP response headers after 344.3017ms - 200
2025-05-24 15:33:20.589 +07:00 [INF] End processing HTTP request after 352.3752ms - 200
2025-05-24 15:33:20.792 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:33:21.109 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:33:21.170 +07:00 [INF] Successfully stored movie trieu-duong-chi-vu-da in database
2025-05-24 15:33:21.173 +07:00 [INF] Successfully fetched movie detail using v3
2025-05-24 15:33:21.213 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:33:21.254 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:33:21.260 +07:00 [INF] Cache hit for movie_detail_trieu-duong-chi-vu-da
2025-05-24 15:33:21.282 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:33:21.309 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:33:21.385 +07:00 [ERR] Error processing episode data for movie trieu-duong-chi-vu-da
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:33:21.411 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
2025-05-24 15:33:21.419 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:33:21.431 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:33:21.448 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 15:33:21.470 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p26='?' (DbType = Int32), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [MovieStatistics] SET [AverageRating] = @p19, [CommentCount] = @p20, [FavoriteCount] = @p21, [LastUpdated] = @p22, [MovieSlug] = @p23, [RatingCount] = @p24, [ViewCount] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-05-24 15:33:21.476 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:33:21.495 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 2772.2197ms
2025-05-24 15:33:21.498 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:33:21.501 +07:00 [INF] HTTP Response - RequestId: 3f96afef-431c-4648-961a-f629ff7bfcd6, StatusCode: 200, ContentLength: null, ElapsedMs: 2798
2025-05-24 15:33:21.504 +07:00 [INF] Performance Metric - Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, StatusCode: 200, ElapsedMs: 2801, Category: Very Slow
2025-05-24 15:33:21.512 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - 200 null application/json; charset=utf-8 2826.2684ms
2025-05-24 15:41:44.762 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:41:46.776 +07:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:41:46.852 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:41:46.862 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:41:46.876 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:41:46.922 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:41:46.958 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:41:47.320 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:41:47.353 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:41:47.364 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:41:47.558 +07:00 [INF] Executed DbCommand (63ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:41:47.646 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:41:47.653 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:41:47.690 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:41:47.854 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:41:47.860 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:41:47.866 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:41:47.880 +07:00 [INF] Performance Metrics - WorkingSet: 133.04MB, PrivateMemory: 72.46MB, GC Memory: 20.96MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:41:47.888 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:41:47.892 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:41:48.486 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:41:48.490 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:41:48.493 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:41:48.496 +07:00 [INF] Hosting environment: Development
2025-05-24 15:41:48.499 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:41:49.605 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/ - null null
2025-05-24 15:41:49.964 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/ - 301 0 null 382.9525ms
2025-05-24 15:41:49.976 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:41:50.140 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 162.6263ms
2025-05-24 15:41:50.153 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui-standalone-preset.js - null null
2025-05-24 15:41:50.152 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui-bundle.js - null null
2025-05-24 15:41:50.153 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:41:50.151 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui.css - null null
2025-05-24 15:41:50.152 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.css - null null
2025-05-24 15:41:50.236 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 83.9686ms
2025-05-24 15:41:50.265 +07:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-05-24 15:41:50.170 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:41:50.278 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.css - 200 202 text/css 126.2085ms
2025-05-24 15:41:50.184 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:41:50.320 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-05-24 15:41:50.320 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-24 15:41:50.336 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui.css - 200 154948 text/css 184.6883ms
2025-05-24 15:41:50.347 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui-standalone-preset.js - 200 229223 text/javascript 193.7089ms
2025-05-24 15:41:50.315 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 148.51ms
2025-05-24 15:41:50.423 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-24 15:41:50.428 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui-bundle.js - 200 1466324 text/javascript 276.3644ms
2025-05-24 15:41:50.457 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 272.978ms
2025-05-24 15:41:50.779 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:41:50.813 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/favicon-32x32.png - null null
2025-05-24 15:41:50.822 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-05-24 15:41:50.826 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/favicon-32x32.png - 200 628 image/png 13.0331ms
2025-05-24 15:41:51.085 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 306.8439ms
2025-05-24 15:42:15.905 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:42:17.639 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:42:17.707 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:42:17.717 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:42:17.723 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:42:17.749 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:42:17.783 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:42:18.086 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:42:18.118 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:42:18.128 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:42:18.277 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:42:18.357 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:42:18.367 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:42:18.402 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:42:18.575 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:42:18.581 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:42:18.587 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:42:18.601 +07:00 [INF] Performance Metrics - WorkingSet: 131.95MB, PrivateMemory: 71.58MB, GC Memory: 20.94MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:42:18.608 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:42:18.611 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:42:19.060 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:42:19.062 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:42:19.065 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:42:19.067 +07:00 [INF] Hosting environment: Development
2025-05-24 15:42:19.069 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:42:19.859 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:42:20.281 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 438.9496ms
2025-05-24 15:42:20.290 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:42:20.291 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:42:20.308 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:42:20.311 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 20.259ms
2025-05-24 15:42:20.319 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 28.9903ms
2025-05-24 15:42:20.438 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 131.0371ms
2025-05-24 15:42:20.634 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:42:20.924 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 290.1481ms
2025-05-24 15:43:51.413 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - null null
2025-05-24 15:43:51.436 +07:00 [INF] HTTP Request - RequestId: 7604ad33-44cb-411a-a5ca-5134e41f4836, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:43:51.564 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:43:51.608 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:43:52.253 +07:00 [ERR] Error fetching latest movies using : Response status code does not indicate success: 404 (Not Found).
System.Net.Http.HttpRequestException: Response status code does not indicate success: 404 (Not Found).
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at WebAppApiPhim.Services.MovieApiService.GetLatestMoviesAsync(Int32 page, Int32 limit, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 62
2025-05-24 15:43:52.339 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:43:52.426 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 807.5573ms
2025-05-24 15:43:52.430 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:43:52.438 +07:00 [INF] HTTP Response - RequestId: 7604ad33-44cb-411a-a5ca-5134e41f4836, StatusCode: 200, ContentLength: null, ElapsedMs: 1008
2025-05-24 15:43:52.447 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - 200 null application/json; charset=utf-8 1034.2046ms
2025-05-24 15:44:00.265 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2&version=1 - null null
2025-05-24 15:44:00.274 +07:00 [INF] HTTP Request - RequestId: 3dd0935f-9dd2-442a-9c15-a4197af4ce18, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2&version=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:44:00.281 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:44:00.284 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:44:00.572 +07:00 [ERR] Error fetching latest movies using 1: Response status code does not indicate success: 400 (Bad Request).
System.Net.Http.HttpRequestException: Response status code does not indicate success: 400 (Bad Request).
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at WebAppApiPhim.Services.MovieApiService.GetLatestMoviesAsync(Int32 page, Int32 limit, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 62
2025-05-24 15:44:00.577 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:44:00.581 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 293.4073ms
2025-05-24 15:44:00.585 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:44:00.588 +07:00 [INF] HTTP Response - RequestId: 3dd0935f-9dd2-442a-9c15-a4197af4ce18, StatusCode: 200, ContentLength: null, ElapsedMs: 314
2025-05-24 15:44:00.593 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2&version=1 - 200 null application/json; charset=utf-8 327.9671ms
2025-05-24 15:44:19.623 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:44:21.273 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:44:21.340 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:44:21.350 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:44:21.355 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:44:21.381 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:44:21.412 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:44:21.747 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:44:21.780 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:44:21.791 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:44:21.949 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:44:22.029 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:44:22.038 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:44:22.074 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:44:22.219 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:44:22.224 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:44:22.229 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:44:22.242 +07:00 [INF] Performance Metrics - WorkingSet: 132.11MB, PrivateMemory: 71.65MB, GC Memory: 20.81MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:44:22.251 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:44:22.254 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:44:22.607 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:44:22.609 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:44:22.611 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:44:22.612 +07:00 [INF] Hosting environment: Development
2025-05-24 15:44:22.614 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:44:23.158 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:44:23.551 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 411.0973ms
2025-05-24 15:44:23.556 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:44:23.556 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:44:23.569 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:44:23.575 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 18.7878ms
2025-05-24 15:44:23.603 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 47.4977ms
2025-05-24 15:44:23.667 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 98.6969ms
2025-05-24 15:44:23.739 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:44:24.020 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 280.9894ms
2025-05-24 15:44:34.237 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - null null
2025-05-24 15:44:34.256 +07:00 [INF] HTTP Request - RequestId: 0014f636-408c-47e6-8ea8-cb11e1733bb8, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:44:34.364 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:44:34.398 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:44:34.458 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=2
2025-05-24 15:44:34.468 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:44:34.494 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:44:34.772 +07:00 [INF] Received HTTP response headers after 271.9137ms - 200
2025-05-24 15:44:34.782 +07:00 [INF] End processing HTTP request after 319.2317ms - 200
2025-05-24 15:44:34.883 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:44:34.956 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:44:34.961 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:44:34.963 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:44:35.175 +07:00 [INF] Received HTTP response headers after 210.4568ms - 200
2025-05-24 15:44:35.178 +07:00 [INF] End processing HTTP request after 216.8338ms - 200
2025-05-24 15:44:35.190 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:44:35.201 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:44:35.243 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 836.5177ms
2025-05-24 15:44:35.246 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:44:35.252 +07:00 [INF] HTTP Response - RequestId: 0014f636-408c-47e6-8ea8-cb11e1733bb8, StatusCode: 200, ContentLength: null, ElapsedMs: 1001
2025-05-24 15:44:35.259 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - 200 null application/json; charset=utf-8 1022.7235ms
2025-05-24 15:45:14.607 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan - null null
2025-05-24 15:45:14.623 +07:00 [INF] HTTP Request - RequestId: b4f51938-43b8-4a74-8f57-7a6cfdee2c1e, Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:45:14.630 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:45:14.639 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:45:14.678 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:45:14.682 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:45:14.684 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:45:14.686 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:45:16.207 +07:00 [INF] Received HTTP response headers after 1518.0125ms - 200
2025-05-24 15:45:16.210 +07:00 [INF] End processing HTTP request after 1525.9684ms - 200
2025-05-24 15:45:16.367 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:45:16.422 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:45:16.425 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:45:16.428 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:45:17.989 +07:00 [INF] Received HTTP response headers after 1558.9718ms - 200
2025-05-24 15:45:17.992 +07:00 [INF] End processing HTTP request after 1567.3271ms - 200
2025-05-24 15:45:18.174 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:45:18.484 +07:00 [INF] Executed DbCommand (60ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:45:18.533 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f5451fc-ff6e-44db-970e-3dc7ed1dc39b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f5451fc-ff6e-44db-970e-3dc7ed1dc39b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 15:45:18.651 +07:00 [ERR] Error storing movie ba-lan-ga-cho-ma-quan in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f5451fc-ff6e-44db-970e-3dc7ed1dc39b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
2025-05-24 15:45:18.763 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f5451fc-ff6e-44db-970e-3dc7ed1dc39b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 183
2025-05-24 15:45:18.780 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:45:18.782 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:45:18.784 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:45:20.542 +07:00 [INF] Received HTTP response headers after 1754.642ms - 200
2025-05-24 15:45:20.544 +07:00 [INF] End processing HTTP request after 1762.7489ms - 200
2025-05-24 15:45:20.624 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:45:20.632 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: ba-lan-ga-cho-ma-quan
2025-05-24 15:45:20.635 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:45:20.649 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 6005.0958ms
2025-05-24 15:45:20.652 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:45:20.655 +07:00 [INF] HTTP Response - RequestId: b4f51938-43b8-4a74-8f57-7a6cfdee2c1e, StatusCode: 404, ContentLength: null, ElapsedMs: 6031
2025-05-24 15:45:20.659 +07:00 [WRN] Slow Request Detected - RequestId: b4f51938-43b8-4a74-8f57-7a6cfdee2c1e, ElapsedMs: 6031, Path: /api/Movies/ba-lan-ga-cho-ma-quan, Method: GET
2025-05-24 15:45:20.664 +07:00 [WRN] Error Response - RequestId: b4f51938-43b8-4a74-8f57-7a6cfdee2c1e, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 15:45:20.668 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, StatusCode: 404, ElapsedMs: 6045, Category: Critical
2025-05-24 15:45:20.677 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan - 404 null application/json; charset=utf-8 6070.9699ms
2025-05-24 15:45:55.757 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:45:57.825 +07:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:45:57.911 +07:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:45:57.921 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:45:57.928 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:45:57.961 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:45:58.002 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:45:58.424 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:45:58.465 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:45:58.477 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:45:58.657 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:45:58.747 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:45:58.755 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:45:58.791 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:45:58.962 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:45:58.970 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:45:58.976 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:45:58.991 +07:00 [INF] Performance Metrics - WorkingSet: 131.57MB, PrivateMemory: 71.57MB, GC Memory: 20.96MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:45:58.997 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:45:59.001 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:45:59.400 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:45:59.403 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:45:59.407 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:45:59.410 +07:00 [INF] Hosting environment: Development
2025-05-24 15:45:59.414 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:46:00.428 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:46:00.812 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 400.8303ms
2025-05-24 15:46:00.883 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:46:00.883 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:46:00.884 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:46:00.904 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 20.4444ms
2025-05-24 15:46:00.918 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 36.4959ms
2025-05-24 15:46:00.995 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 111.3623ms
2025-05-24 15:46:01.075 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:46:01.359 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 284.5276ms
2025-05-24 15:46:12.271 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=3 - null null
2025-05-24 15:46:12.292 +07:00 [INF] HTTP Request - RequestId: e7253300-cc90-4078-9b9c-509ee4ce6d94, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=3, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:46:12.408 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:46:12.443 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:46:12.511 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=3
2025-05-24 15:46:12.523 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:46:12.555 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:46:12.827 +07:00 [INF] Received HTTP response headers after 264.6602ms - 200
2025-05-24 15:46:12.838 +07:00 [INF] End processing HTTP request after 322.0966ms - 200
2025-05-24 15:46:12.929 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:46:13.040 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:46:13.057 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:46:13.060 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:46:13.069 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:46:13.079 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:46:13.082 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:46:13.910 +07:00 [INF] Received HTTP response headers after 841.0054ms - 200
2025-05-24 15:46:13.910 +07:00 [INF] Received HTTP response headers after 824.8542ms - 200
2025-05-24 15:46:13.913 +07:00 [INF] End processing HTTP request after 856.7761ms - 200
2025-05-24 15:46:13.915 +07:00 [INF] End processing HTTP request after 836.0981ms - 200
2025-05-24 15:46:13.930 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:46:13.944 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:46:13.993 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 1540.3055ms
2025-05-24 15:46:13.997 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:46:14.005 +07:00 [INF] HTTP Response - RequestId: e7253300-cc90-4078-9b9c-509ee4ce6d94, StatusCode: 200, ContentLength: null, ElapsedMs: 1718
2025-05-24 15:46:14.012 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=3 - 200 null application/json; charset=utf-8 1741.2865ms
2025-05-24 15:46:39.481 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim - null null
2025-05-24 15:46:39.502 +07:00 [INF] HTTP Request - RequestId: c511914f-d04e-4970-b621-649c6d3c2d82, Method: GET, Path: /api/Movies/thieu-dot-con-tim, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:46:39.509 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:46:39.519 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:46:39.562 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:46:39.568 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=thieu-dot-con-tim
2025-05-24 15:46:39.570 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:46:39.572 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:46:41.023 +07:00 [INF] Received HTTP response headers after 1448.3985ms - 200
2025-05-24 15:46:41.026 +07:00 [INF] End processing HTTP request after 1455.7068ms - 200
2025-05-24 15:46:41.186 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:46:41.221 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=thieu-dot-con-tim
2025-05-24 15:46:41.223 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:46:41.225 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:46:42.656 +07:00 [INF] Received HTTP response headers after 1429.5727ms - 200
2025-05-24 15:46:42.660 +07:00 [INF] End processing HTTP request after 1436.8221ms - 200
2025-05-24 15:46:42.841 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:46:43.106 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:46:43.164 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7b9e345d-80e3-4997-b148-a10a44989600
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7b9e345d-80e3-4997-b148-a10a44989600
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 15:46:43.282 +07:00 [ERR] Error storing movie thieu-dot-con-tim in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7b9e345d-80e3-4997-b148-a10a44989600
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
2025-05-24 15:46:43.386 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7b9e345d-80e3-4997-b148-a10a44989600
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 754
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 183
2025-05-24 15:46:43.403 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=thieu-dot-con-tim
2025-05-24 15:46:43.404 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:46:43.407 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:46:44.975 +07:00 [INF] Received HTTP response headers after 1566.1426ms - 200
2025-05-24 15:46:44.979 +07:00 [INF] End processing HTTP request after 1574.4981ms - 200
2025-05-24 15:46:45.046 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 172
2025-05-24 15:46:45.054 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: thieu-dot-con-tim
2025-05-24 15:46:45.056 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:46:45.069 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 5545.5178ms
2025-05-24 15:46:45.072 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:46:45.074 +07:00 [INF] HTTP Response - RequestId: c511914f-d04e-4970-b621-649c6d3c2d82, StatusCode: 404, ContentLength: null, ElapsedMs: 5572
2025-05-24 15:46:45.078 +07:00 [WRN] Slow Request Detected - RequestId: c511914f-d04e-4970-b621-649c6d3c2d82, ElapsedMs: 5572, Path: /api/Movies/thieu-dot-con-tim, Method: GET
2025-05-24 15:46:45.083 +07:00 [WRN] Error Response - RequestId: c511914f-d04e-4970-b621-649c6d3c2d82, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 15:46:45.086 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/thieu-dot-con-tim, StatusCode: 404, ElapsedMs: 5584, Category: Critical
2025-05-24 15:46:45.096 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim - 404 null application/json; charset=utf-8 5616.7585ms
2025-05-24 15:49:00.374 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:49:02.015 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:49:02.101 +07:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:49:02.110 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:49:02.117 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:49:02.154 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:49:02.207 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:49:02.574 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:49:02.609 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:49:02.619 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:49:02.787 +07:00 [INF] Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:49:02.870 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:49:02.878 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:49:02.911 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:49:03.052 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:49:03.057 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:49:03.061 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:49:03.075 +07:00 [INF] Performance Metrics - WorkingSet: 131.67MB, PrivateMemory: 71.68MB, GC Memory: 20.94MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:49:03.081 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:49:03.085 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:49:03.488 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:49:03.490 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:49:03.492 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:49:03.494 +07:00 [INF] Hosting environment: Development
2025-05-24 15:49:03.496 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:49:04.042 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:49:04.364 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 337.8853ms
2025-05-24 15:49:04.418 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:49:04.418 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:49:04.418 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:49:04.462 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 42.0607ms
2025-05-24 15:49:04.472 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 54.2389ms
2025-05-24 15:49:04.531 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 113.1288ms
2025-05-24 15:49:04.598 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:49:04.842 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 244.8965ms
2025-05-24 15:49:23.892 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=4 - null null
2025-05-24 15:49:23.914 +07:00 [INF] HTTP Request - RequestId: 0eb090d5-6df9-4e31-a8f0-cbcb599db5d6, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=4, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:49:24.023 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:49:24.056 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:49:24.125 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=4
2025-05-24 15:49:24.136 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:49:24.165 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 15:49:24.627 +07:00 [INF] Received HTTP response headers after 454.334ms - 200
2025-05-24 15:49:24.637 +07:00 [INF] End processing HTTP request after 506.5103ms - 200
2025-05-24 15:49:24.737 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:49:24.852 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:49:24.864 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.868 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:49:24.868 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.877 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 15:49:24.878 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.889 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.891 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.893 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 15:49:24.966 +07:00 [INF] Received HTTP response headers after 85.8782ms - 200
2025-05-24 15:49:24.969 +07:00 [INF] End processing HTTP request after 104.5826ms - 200
2025-05-24 15:49:25.112 +07:00 [INF] Received HTTP response headers after 209.1082ms - 200
2025-05-24 15:49:25.115 +07:00 [INF] End processing HTTP request after 225.8577ms - 200
2025-05-24 15:49:25.168 +07:00 [INF] Received HTTP response headers after 272.6021ms - 200
2025-05-24 15:49:25.171 +07:00 [INF] End processing HTTP request after 293.1149ms - 200
2025-05-24 15:49:25.180 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 15:49:25.191 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:49:25.233 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 1168.0747ms
2025-05-24 15:49:25.237 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 15:49:25.244 +07:00 [INF] HTTP Response - RequestId: 0eb090d5-6df9-4e31-a8f0-cbcb599db5d6, StatusCode: 200, ContentLength: null, ElapsedMs: 1336
2025-05-24 15:49:25.251 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=4 - 200 null application/json; charset=utf-8 1359.7455ms
2025-05-24 15:49:53.885 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim - null null
2025-05-24 15:49:53.902 +07:00 [INF] HTTP Request - RequestId: 7c65daeb-6d88-4ab8-8297-b9a229d8a3b6, Method: GET, Path: /api/Movies/thieu-dot-con-tim, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:49:53.909 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:49:53.918 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:49:53.955 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:49:53.962 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=thieu-dot-con-tim
2025-05-24 15:49:53.964 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:49:53.967 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:49:54.077 +07:00 [INF] Received HTTP response headers after 107.0329ms - 200
2025-05-24 15:49:54.080 +07:00 [INF] End processing HTTP request after 115.6613ms - 200
2025-05-24 15:49:54.255 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1477.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 15:49:54.294 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=thieu-dot-con-tim
2025-05-24 15:49:54.296 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:49:54.299 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:49:54.375 +07:00 [INF] Received HTTP response headers after 74.1548ms - 200
2025-05-24 15:49:54.378 +07:00 [INF] End processing HTTP request after 82.4052ms - 200
2025-05-24 15:49:54.597 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:49:54.908 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:49:54.955 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 15:49:55.057 +07:00 [ERR] Error storing movie thieu-dot-con-tim in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
2025-05-24 15:49:55.175 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 15:49:55.197 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=thieu-dot-con-tim
2025-05-24 15:49:55.199 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:49:55.202 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:49:55.289 +07:00 [INF] Received HTTP response headers after 84.7055ms - 200
2025-05-24 15:49:55.292 +07:00 [INF] End processing HTTP request after 92.9089ms - 200
2025-05-24 15:49:55.373 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 15:49:55.381 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: thieu-dot-con-tim
2025-05-24 15:49:55.384 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:49:55.400 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 1477.9845ms
2025-05-24 15:49:55.402 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:49:55.405 +07:00 [INF] HTTP Response - RequestId: 7c65daeb-6d88-4ab8-8297-b9a229d8a3b6, StatusCode: 404, ContentLength: null, ElapsedMs: 1502
2025-05-24 15:49:55.409 +07:00 [WRN] Error Response - RequestId: 7c65daeb-6d88-4ab8-8297-b9a229d8a3b6, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 15:49:55.412 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/thieu-dot-con-tim, StatusCode: 404, ElapsedMs: 1509, Category: Slow
2025-05-24 15:49:55.420 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim - 404 null application/json; charset=utf-8 1535.1633ms
2025-05-24 15:50:14.729 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - null null
2025-05-24 15:50:14.736 +07:00 [INF] HTTP Request - RequestId: 8d8f106a-4988-4b97-b6b2-381c01b98b9f, Method: GET, Path: /api/Movies/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:50:14.747 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:50:14.749 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:50:14.766 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:50:14.812 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:50:14.851 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:50:14.858 +07:00 [INF] Cache hit for movie_detail_trieu-duong-chi-vu-da
2025-05-24 15:50:14.877 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:50:14.911 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:50:14.985 +07:00 [ERR] Error processing episode data for movie trieu-duong-chi-vu-da
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:50:15.026 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
2025-05-24 15:50:15.041 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:50:15.054 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:50:15.072 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 15:50:15.095 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p26='?' (DbType = Int32), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [MovieStatistics] SET [AverageRating] = @p19, [CommentCount] = @p20, [FavoriteCount] = @p21, [LastUpdated] = @p22, [MovieSlug] = @p23, [RatingCount] = @p24, [ViewCount] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-05-24 15:50:15.108 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:50:15.118 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 364.303ms
2025-05-24 15:50:15.121 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:50:15.123 +07:00 [INF] HTTP Response - RequestId: 8d8f106a-4988-4b97-b6b2-381c01b98b9f, StatusCode: 200, ContentLength: null, ElapsedMs: 386
2025-05-24 15:50:15.127 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trieu-duong-chi-vu-da - 200 null application/json; charset=utf-8 398.4984ms
2025-05-24 15:50:59.617 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan - null null
2025-05-24 15:50:59.631 +07:00 [INF] HTTP Request - RequestId: 97d123c9-3bcc-4db0-ad95-f3a55172979d, Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:50:59.637 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:50:59.640 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:50:59.652 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:50:59.656 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:50:59.658 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:50:59.661 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 15:51:00.541 +07:00 [INF] Received HTTP response headers after 878.25ms - 200
2025-05-24 15:51:00.545 +07:00 [INF] End processing HTTP request after 886.5145ms - 200
2025-05-24 15:51:00.629 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1687.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 15:51:00.638 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:51:00.641 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:51:00.644 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 15:51:00.990 +07:00 [INF] Received HTTP response headers after 341.9513ms - 200
2025-05-24 15:51:00.993 +07:00 [INF] End processing HTTP request after 352.5602ms - 200
2025-05-24 15:51:01.008 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:51:01.031 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:51:01.048 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 15:51:01.127 +07:00 [ERR] Error storing movie ba-lan-ga-cho-ma-quan in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
2025-05-24 15:51:01.250 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c1ed594e-ec0a-4473-a5ec-60f6d80ad528
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 15:51:01.270 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=ba-lan-ga-cho-ma-quan
2025-05-24 15:51:01.272 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:51:01.275 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 15:51:02.188 +07:00 [INF] Received HTTP response headers after 910.8703ms - 200
2025-05-24 15:51:02.192 +07:00 [INF] End processing HTTP request after 919.9439ms - 200
2025-05-24 15:51:02.270 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 15:51:02.278 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: ba-lan-ga-cho-ma-quan
2025-05-24 15:51:02.281 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:51:02.285 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 2641.194ms
2025-05-24 15:51:02.288 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:02.291 +07:00 [INF] HTTP Response - RequestId: 97d123c9-3bcc-4db0-ad95-f3a55172979d, StatusCode: 404, ContentLength: null, ElapsedMs: 2660
2025-05-24 15:51:02.296 +07:00 [WRN] Error Response - RequestId: 97d123c9-3bcc-4db0-ad95-f3a55172979d, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 15:51:02.300 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, StatusCode: 404, ElapsedMs: 2668, Category: Very Slow
2025-05-24 15:51:02.306 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan - 404 null application/json; charset=utf-8 2689.3806ms
2025-05-24 15:51:08.450 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan?version=v1 - null null
2025-05-24 15:51:08.457 +07:00 [INF] HTTP Request - RequestId: c49d7af1-421f-46e3-9fa6-3142186cba66, Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:51:08.464 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:08.468 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:51:08.474 +07:00 [INF] Cache hit for movie_detail_ba-lan-ga-cho-ma-quan
2025-05-24 15:51:08.485 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:51:08.496 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:08.501 +07:00 [INF] Cache hit for movie_detail_ba-lan-ga-cho-ma-quan
2025-05-24 15:51:08.507 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:51:08.517 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:51:08.574 +07:00 [ERR] Error processing episode data for movie ba-lan-ga-cho-ma-quan
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:51:08.588 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-05-24 15:51:08.614 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:08.623 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:51:08.632 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 15:51:08.648 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:51:08.659 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:51:08.663 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 190.5023ms
2025-05-24 15:51:08.666 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:08.669 +07:00 [INF] HTTP Response - RequestId: c49d7af1-421f-46e3-9fa6-3142186cba66, StatusCode: 200, ContentLength: null, ElapsedMs: 212
2025-05-24 15:51:08.673 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan?version=v1 - 200 null application/json; charset=utf-8 224.1166ms
2025-05-24 15:51:14.981 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan?version=v2 - null null
2025-05-24 15:51:14.988 +07:00 [INF] HTTP Request - RequestId: a8269839-584c-4983-ac2e-281de74490aa, Method: GET, Path: /api/Movies/ba-lan-ga-cho-ma-quan, QueryString: ?version=v2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:51:14.995 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:14.998 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:51:15.003 +07:00 [INF] Cache hit for movie_detail_ba-lan-ga-cho-ma-quan
2025-05-24 15:51:15.014 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:51:15.026 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:15.032 +07:00 [INF] Cache hit for movie_detail_ba-lan-ga-cho-ma-quan
2025-05-24 15:51:15.037 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:51:15.048 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:51:15.098 +07:00 [ERR] Error processing episode data for movie ba-lan-ga-cho-ma-quan
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:51:15.108 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
2025-05-24 15:51:15.116 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:15.124 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:51:15.133 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 15:51:15.150 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p26='?' (DbType = Int32), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
UPDATE [MovieStatistics] SET [AverageRating] = @p19, [CommentCount] = @p20, [FavoriteCount] = @p21, [LastUpdated] = @p22, [MovieSlug] = @p23, [RatingCount] = @p24, [ViewCount] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2025-05-24 15:51:15.157 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:51:15.161 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 158.8038ms
2025-05-24 15:51:15.165 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:15.168 +07:00 [INF] HTTP Response - RequestId: a8269839-584c-4983-ac2e-281de74490aa, StatusCode: 200, ContentLength: null, ElapsedMs: 179
2025-05-24 15:51:15.174 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ba-lan-ga-cho-ma-quan?version=v2 - 200 null application/json; charset=utf-8 193.294ms
2025-05-24 15:51:46.264 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim?version=v1 - null null
2025-05-24 15:51:46.277 +07:00 [INF] HTTP Request - RequestId: bb868f59-724f-46e9-a4bb-cb78277ab546, Method: GET, Path: /api/Movies/thieu-dot-con-tim, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:51:46.284 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:46.286 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 15:51:46.292 +07:00 [INF] Cache hit for movie_detail_thieu-dot-con-tim
2025-05-24 15:51:46.303 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 15:51:46.313 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:46.319 +07:00 [INF] Cache hit for movie_detail_thieu-dot-con-tim
2025-05-24 15:51:46.324 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:51:46.333 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:51:46.389 +07:00 [ERR] Error processing episode data for movie thieu-dot-con-tim
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:51:46.397 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-05-24 15:51:46.404 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:51:46.413 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:51:46.422 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 15:51:46.438 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 15:51:46.447 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 15:51:46.450 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 159.4126ms
2025-05-24 15:51:46.453 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 15:51:46.456 +07:00 [INF] HTTP Response - RequestId: bb868f59-724f-46e9-a4bb-cb78277ab546, StatusCode: 200, ContentLength: null, ElapsedMs: 178
2025-05-24 15:51:46.460 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/thieu-dot-con-tim?version=v1 - 200 null application/json; charset=utf-8 196.8678ms
2025-05-24 15:53:27.777 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:53:30.052 +07:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:53:30.124 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:53:30.144 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:53:30.152 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:53:30.183 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:53:30.213 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:53:30.561 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:53:30.603 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:53:30.616 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:53:30.792 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:53:30.880 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:53:30.888 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:53:30.923 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:53:31.084 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:53:31.090 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:53:31.095 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:53:31.110 +07:00 [INF] Performance Metrics - WorkingSet: 133.83MB, PrivateMemory: 72.06MB, GC Memory: 20.83MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:53:31.117 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:53:31.120 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:53:31.558 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:53:31.560 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:53:31.563 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:53:31.564 +07:00 [INF] Hosting environment: Development
2025-05-24 15:53:31.566 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:53:32.065 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:53:32.387 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 337.658ms
2025-05-24 15:53:32.399 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:53:32.399 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:53:32.411 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:53:32.431 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 30.4536ms
2025-05-24 15:53:32.438 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 39.3255ms
2025-05-24 15:53:32.505 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 94.1745ms
2025-05-24 15:53:32.567 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:53:32.775 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 209.2659ms
2025-05-24 15:53:56.563 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Streaming/thieu-dot-con-tim/episodes - null null
2025-05-24 15:53:56.581 +07:00 [INF] HTTP Request - RequestId: e8581859-7d19-4e2e-9520-a5894fb162a5, Method: GET, Path: /api/Streaming/thieu-dot-con-tim/episodes, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:53:56.687 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim)'
2025-05-24 15:53:56.725 +07:00 [INF] Route matched with {action = "GetEpisodes", controller = "Streaming"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[System.Collections.Generic.List`1[WebAppApiPhim.Models.ServerViewModel]]]] GetEpisodes(System.String) on controller WebAppApiPhim.Controllers.StreamingController (WebAppApiPhim).
2025-05-24 15:53:56.829 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:53:56.863 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 15:53:57.009 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 15:53:57.042 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 15:53:57.126 +07:00 [ERR] Error processing episode data for movie thieu-dot-con-tim
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 15:53:57.266 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
2025-05-24 15:53:57.294 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 15:53:57.323 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Collections.Generic.List`1[[WebAppApiPhim.Models.ServerViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 15:53:57.373 +07:00 [INF] Executed action WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim) in 639.3203ms
2025-05-24 15:53:57.376 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.StreamingController.GetEpisodes (WebAppApiPhim)'
2025-05-24 15:53:57.382 +07:00 [INF] HTTP Response - RequestId: e8581859-7d19-4e2e-9520-a5894fb162a5, StatusCode: 200, ContentLength: null, ElapsedMs: 806
2025-05-24 15:53:57.394 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Streaming/thieu-dot-con-tim/episodes - 200 null application/json; charset=utf-8 831.895ms
2025-05-24 15:54:18.130 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/profile - null null
2025-05-24 15:54:18.137 +07:00 [INF] HTTP Request - RequestId: 3bfd832b-792a-420e-8c6f-68e98f7370f2, Method: GET, Path: /api/User/profile, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:54:18.151 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:54:18.160 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:54:18.162 +07:00 [INF] HTTP Response - RequestId: 3bfd832b-792a-420e-8c6f-68e98f7370f2, StatusCode: 401, ContentLength: null, ElapsedMs: 25
2025-05-24 15:54:18.165 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/profile, StatusCode: 401, ElapsedMs: 28, Category: Excellent
2025-05-24 15:54:18.169 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/profile - 401 0 null 39.3875ms
2025-05-24 15:54:32.941 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:54:34.679 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:54:34.760 +07:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:54:34.771 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:54:34.778 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:54:34.810 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:54:34.841 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:54:35.140 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:54:35.181 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:54:35.194 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:54:35.358 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:54:35.439 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:54:35.447 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:54:35.481 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:54:35.635 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:54:35.640 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:54:35.644 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:54:35.659 +07:00 [INF] Performance Metrics - WorkingSet: 131.64MB, PrivateMemory: 71.39MB, GC Memory: 20.84MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:54:35.666 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:54:35.669 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:54:36.013 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:54:36.015 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:54:36.017 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:54:36.018 +07:00 [INF] Hosting environment: Development
2025-05-24 15:54:36.020 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:54:36.654 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:54:36.942 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 298.2659ms
2025-05-24 15:54:36.999 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:54:36.999 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:54:36.999 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:54:37.034 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 35.6607ms
2025-05-24 15:54:37.043 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 45.3876ms
2025-05-24 15:54:37.095 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 95.9419ms
2025-05-24 15:54:37.163 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:54:37.397 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 234.2394ms
2025-05-24 15:54:49.217 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/profile - null null
2025-05-24 15:54:49.236 +07:00 [INF] HTTP Request - RequestId: 5eacb46c-6d39-43ab-a30f-4a92308df44b, Method: GET, Path: /api/User/profile, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:54:49.332 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:54:49.339 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:54:49.342 +07:00 [INF] HTTP Response - RequestId: 5eacb46c-6d39-43ab-a30f-4a92308df44b, StatusCode: 401, ContentLength: null, ElapsedMs: 111
2025-05-24 15:54:49.347 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/profile, StatusCode: 401, ElapsedMs: 117, Category: Good
2025-05-24 15:54:49.350 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/profile - 401 0 null 133.851ms
2025-05-24 15:54:56.657 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=2 - null null
2025-05-24 15:54:56.668 +07:00 [INF] HTTP Request - RequestId: 2f9bc261-74d9-4a95-af1e-190a9d29325f, Method: GET, Path: /api/User/favorites, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:54:56.680 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:54:56.683 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:54:56.684 +07:00 [INF] HTTP Response - RequestId: 2f9bc261-74d9-4a95-af1e-190a9d29325f, StatusCode: 401, ContentLength: null, ElapsedMs: 16
2025-05-24 15:54:56.687 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/favorites, StatusCode: 401, ElapsedMs: 18, Category: Excellent
2025-05-24 15:54:56.690 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=2 - 401 0 null 33.5093ms
2025-05-24 15:54:58.253 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=2 - null null
2025-05-24 15:54:58.259 +07:00 [INF] HTTP Request - RequestId: 1a1ee10e-a067-47d4-a009-be6827ed26bb, Method: GET, Path: /api/User/favorites, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:54:58.268 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:54:58.270 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:54:58.272 +07:00 [INF] HTTP Response - RequestId: 1a1ee10e-a067-47d4-a009-be6827ed26bb, StatusCode: 401, ContentLength: null, ElapsedMs: 12
2025-05-24 15:54:58.275 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/favorites, StatusCode: 401, ElapsedMs: 15, Category: Excellent
2025-05-24 15:54:58.278 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/favorites?page=1&limit=2 - 401 0 null 25.7793ms
2025-05-24 15:55:16.827 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - null 0
2025-05-24 15:55:16.842 +07:00 [INF] HTTP Request - RequestId: 2b82ce51-5615-4bff-b36a-deefccb48cf2, Method: POST, Path: /api/User/favorites/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:55:16.852 +07:00 [INF] CORS policy execution failed.
2025-05-24 15:55:16.855 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 15:55:16.859 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:55:16.861 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:55:16.863 +07:00 [INF] HTTP Response - RequestId: 2b82ce51-5615-4bff-b36a-deefccb48cf2, StatusCode: 401, ContentLength: null, ElapsedMs: 20
2025-05-24 15:55:16.865 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/User/favorites/trieu-duong-chi-vu-da, StatusCode: 401, ElapsedMs: 22, Category: Excellent
2025-05-24 15:55:16.870 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - 401 0 null 43.3535ms
2025-05-24 15:55:30.161 +07:00 [INF] Request starting HTTP/2 DELETE https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - null null
2025-05-24 15:55:30.165 +07:00 [INF] HTTP Request - RequestId: d346aafa-6e50-4c36-8610-dda36556acc7, Method: DELETE, Path: /api/User/favorites/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:55:30.171 +07:00 [INF] CORS policy execution failed.
2025-05-24 15:55:30.172 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 15:55:30.175 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:55:30.177 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:55:30.179 +07:00 [INF] HTTP Response - RequestId: d346aafa-6e50-4c36-8610-dda36556acc7, StatusCode: 401, ContentLength: null, ElapsedMs: 13
2025-05-24 15:55:30.182 +07:00 [WRN] Performance Metric - Method: DELETE, Path: /api/User/favorites/trieu-duong-chi-vu-da, StatusCode: 401, ElapsedMs: 16, Category: Excellent
2025-05-24 15:55:30.186 +07:00 [INF] Request finished HTTP/2 DELETE https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - 401 0 null 26.2097ms
2025-05-24 15:55:43.280 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/User/ratings/trieu-duong-chi-vu-da - application/json 40
2025-05-24 15:55:43.285 +07:00 [INF] HTTP Request - RequestId: fbb412ed-7b28-4d05-a74d-f3d7ca37cee1, Method: POST, Path: /api/User/ratings/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:55:43.315 +07:00 [INF] CORS policy execution failed.
2025-05-24 15:55:43.316 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 15:55:43.318 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:55:43.320 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:55:43.321 +07:00 [INF] HTTP Response - RequestId: fbb412ed-7b28-4d05-a74d-f3d7ca37cee1, StatusCode: 401, ContentLength: null, ElapsedMs: 36
2025-05-24 15:55:43.324 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/User/ratings/trieu-duong-chi-vu-da, StatusCode: 401, ElapsedMs: 39, Category: Excellent
2025-05-24 15:55:43.330 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/User/ratings/trieu-duong-chi-vu-da - 401 0 null 50.0017ms
2025-05-24 15:55:55.361 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=2 - null null
2025-05-24 15:55:55.366 +07:00 [INF] HTTP Request - RequestId: 43c0edc1-481f-49a7-af3d-b35f3cd2cbb9, Method: GET, Path: /api/User/history, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:55:55.374 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 15:55:55.379 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 15:55:55.381 +07:00 [INF] HTTP Response - RequestId: 43c0edc1-481f-49a7-af3d-b35f3cd2cbb9, StatusCode: 401, ContentLength: null, ElapsedMs: 14
2025-05-24 15:55:55.385 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/history, StatusCode: 401, ElapsedMs: 19, Category: Excellent
2025-05-24 15:55:55.389 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=2 - 401 0 null 28.1139ms
2025-05-24 15:59:03.170 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 15:59:05.170 +07:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:59:05.259 +07:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:59:05.270 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 15:59:05.278 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 15:59:05.325 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 15:59:05.365 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 15:59:05.747 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:59:05.786 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:59:05.799 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 15:59:05.990 +07:00 [INF] Executed DbCommand (49ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:59:06.078 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:59:06.089 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 15:59:06.128 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 15:59:06.286 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 15:59:06.293 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 15:59:06.299 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 15:59:06.315 +07:00 [INF] Performance Metrics - WorkingSet: 132.84MB, PrivateMemory: 72.45MB, GC Memory: 21.07MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 15:59:06.323 +07:00 [INF] MovieCacheService is starting.
2025-05-24 15:59:06.328 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 15:59:06.852 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 15:59:06.854 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 15:59:06.857 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 15:59:06.859 +07:00 [INF] Hosting environment: Development
2025-05-24 15:59:06.861 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 15:59:07.503 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 15:59:07.959 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 480.6045ms
2025-05-24 15:59:07.968 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 15:59:07.968 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 15:59:07.982 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 15:59:07.983 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 15.0329ms
2025-05-24 15:59:08.010 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 42.484ms
2025-05-24 15:59:08.088 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 106.9788ms
2025-05-24 15:59:08.151 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 15:59:08.472 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 321.0415ms
2025-05-24 15:59:17.849 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Auth/test-token - null null
2025-05-24 15:59:17.882 +07:00 [INF] HTTP Request - RequestId: ba11d6df-0967-46de-8f25-aa9efa453e3a, Method: GET, Path: /api/Auth/test-token, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 15:59:18.000 +07:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-05-24 15:59:18.003 +07:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-05-24 15:59:18.009 +07:00 [INF] HTTP Response - RequestId: ba11d6df-0967-46de-8f25-aa9efa453e3a, StatusCode: 405, ContentLength: null, ElapsedMs: 135
2025-05-24 15:59:18.015 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Auth/test-token, StatusCode: 405, ElapsedMs: 144, Category: Good
2025-05-24 15:59:18.020 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Auth/test-token - 405 0 null 171.5916ms
2025-05-24 16:00:17.959 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 16:00:19.992 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:00:20.067 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:00:20.077 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:00:20.084 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:00:20.113 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 16:00:20.148 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 16:00:20.493 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:00:20.554 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:00:20.570 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:00:20.749 +07:00 [INF] Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:00:20.866 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:00:20.875 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:00:20.912 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:00:21.095 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 16:00:21.100 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 16:00:21.105 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 16:00:21.117 +07:00 [INF] Performance Metrics - WorkingSet: 134.08MB, PrivateMemory: 72.47MB, GC Memory: 21.05MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 16:00:21.124 +07:00 [INF] MovieCacheService is starting.
2025-05-24 16:00:21.127 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 16:00:21.467 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 16:00:21.469 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 16:00:21.472 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 16:00:21.473 +07:00 [INF] Hosting environment: Development
2025-05-24 16:00:21.475 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 16:00:22.369 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 16:00:22.720 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 365.6743ms
2025-05-24 16:00:22.726 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:00:22.727 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 16:00:22.738 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 16:00:22.749 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 22.4585ms
2025-05-24 16:00:22.758 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 32.5754ms
2025-05-24 16:00:22.831 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 93.4329ms
2025-05-24 16:00:22.911 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:00:23.188 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 279.0257ms
2025-05-24 16:00:29.892 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 84
2025-05-24 16:00:29.915 +07:00 [INF] HTTP Request - RequestId: 4846ad5a-b95d-427e-b6d6-a05abe77dd28, Method: POST, Path: /api/Auth/register, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:00:29.948 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:00:29.950 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:00:30.055 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:00:30.092 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WebAppApiPhim.Controllers.RegisterRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:00:30.194 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:00:30.228 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:00:30.295 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim) in 194.6016ms
2025-05-24 16:00:30.299 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:00:30.306 +07:00 [INF] HTTP Response - RequestId: 4846ad5a-b95d-427e-b6d6-a05abe77dd28, StatusCode: 400, ContentLength: null, ElapsedMs: 397
2025-05-24 16:00:30.311 +07:00 [WRN] Error Response - RequestId: 4846ad5a-b95d-427e-b6d6-a05abe77dd28, StatusCode: 400, Body: o  t]o~ *f "b;F)2]1ga|/ose/mK3;cZjSM0 ;Tas8CZY9pb+d6\P?bOY}Ml]i;#>
2025-05-24 16:00:30.317 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/register, StatusCode: 400, ElapsedMs: 410, Category: Good
2025-05-24 16:00:30.332 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 400 null application/json; charset=utf-8 439.7127ms
2025-05-24 16:00:47.077 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 57
2025-05-24 16:00:47.085 +07:00 [INF] HTTP Request - RequestId: 73f7d73d-1309-4d9a-a12c-e6405213283c, Method: POST, Path: /api/Auth/login, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:00:47.090 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:00:47.092 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:00:47.095 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:00:47.104 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(WebAppApiPhim.Controllers.LoginRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:00:47.218 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:00:47.226 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:00:47.229 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim) in 122.38ms
2025-05-24 16:00:47.232 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:00:47.234 +07:00 [INF] HTTP Response - RequestId: 73f7d73d-1309-4d9a-a12c-e6405213283c, StatusCode: 401, ContentLength: null, ElapsedMs: 149
2025-05-24 16:00:47.237 +07:00 [WRN] Error Response - RequestId: 73f7d73d-1309-4d9a-a12c-e6405213283c, StatusCode: 401, Body: ({"success":false,"message":"Invalid email or password","data":null,"errors":null}
2025-05-24 16:00:47.240 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/login, StatusCode: 401, ElapsedMs: 155, Category: Good
2025-05-24 16:00:47.244 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 167.8214ms
2025-05-24 16:00:58.823 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/test-token - null 0
2025-05-24 16:00:58.830 +07:00 [INF] HTTP Request - RequestId: ed2b9388-0528-4a53-9d85-251e70db78b9, Method: POST, Path: /api/Auth/test-token, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:00:58.835 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:00:58.837 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:00:58.841 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:00:58.848 +07:00 [INF] Route matched with {action = "GenerateTestToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GenerateTestToken() on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:00:58.868 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:00:59.066 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-24 16:00:59.285 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 500), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 200), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [AvatarUrl], [ConcurrencyStamp], [CreatedAt], [DisplayName], [Email], [EmailConfirmed], [IsActive], [LastLoginAt], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
2025-05-24 16:00:59.326 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-05-24 16:00:59.402 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-05-24 16:00:59.414 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-05-24 16:00:59.440 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-24 16:00:59.539 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p21='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 500), @p4='?' (Size = 4000), @p22='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (Size = 256), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTime2), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [AvatarUrl] = @p3, [ConcurrencyStamp] = @p4, [CreatedAt] = @p5, [DisplayName] = @p6, [Email] = @p7, [EmailConfirmed] = @p8, [IsActive] = @p9, [LastLoginAt] = @p10, [LockoutEnabled] = @p11, [LockoutEnd] = @p12, [NormalizedEmail] = @p13, [NormalizedUserName] = @p14, [PasswordHash] = @p15, [PhoneNumber] = @p16, [PhoneNumberConfirmed] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UserName] = @p20
OUTPUT 1
WHERE [Id] = @p21 AND [ConcurrencyStamp] = @p22;
2025-05-24 16:00:59.660 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-24 16:00:59.776 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:00:59.787 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim) in 934.9757ms
2025-05-24 16:00:59.790 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:00:59.792 +07:00 [INF] HTTP Response - RequestId: ed2b9388-0528-4a53-9d85-251e70db78b9, StatusCode: 200, ContentLength: null, ElapsedMs: 962
2025-05-24 16:00:59.796 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/test-token - 200 null application/json; charset=utf-8 973.622ms
2025-05-24 16:01:13.885 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/profile - null null
2025-05-24 16:01:13.901 +07:00 [INF] HTTP Request - RequestId: eb2794d6-defe-41f2-84e7-a439f414fc02, Method: GET, Path: /api/User/profile, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:01:13.916 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 16:01:13.925 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 16:01:13.927 +07:00 [INF] HTTP Response - RequestId: eb2794d6-defe-41f2-84e7-a439f414fc02, StatusCode: 401, ContentLength: null, ElapsedMs: 26
2025-05-24 16:01:13.931 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/profile, StatusCode: 401, ElapsedMs: 30, Category: Excellent
2025-05-24 16:01:13.935 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/profile - 401 0 null 50.966ms
2025-05-24 16:02:15.965 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 16:02:17.889 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:02:17.953 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:02:17.961 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:02:17.966 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:02:17.991 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 16:02:18.026 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 16:02:18.319 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:02:18.356 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:02:18.367 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:02:18.509 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:02:18.589 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:02:18.597 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:02:18.628 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:02:18.783 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 16:02:18.789 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 16:02:18.794 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 16:02:18.808 +07:00 [INF] Performance Metrics - WorkingSet: 131.70MB, PrivateMemory: 71.54MB, GC Memory: 20.94MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 16:02:18.817 +07:00 [INF] MovieCacheService is starting.
2025-05-24 16:02:18.821 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 16:02:19.220 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 16:02:19.222 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 16:02:19.225 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 16:02:19.226 +07:00 [INF] Hosting environment: Development
2025-05-24 16:02:19.228 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 16:02:19.987 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 16:02:20.352 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 382.0077ms
2025-05-24 16:02:20.358 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 16:02:20.358 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:02:20.370 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 16:02:20.376 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 18.4801ms
2025-05-24 16:02:20.413 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 52.0105ms
2025-05-24 16:02:20.470 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 100.1786ms
2025-05-24 16:02:20.543 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:02:20.794 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 251.7927ms
2025-05-24 16:02:31.007 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/test-user-endpoints.html - null null
2025-05-24 16:02:31.038 +07:00 [INF] HTTP Request - RequestId: ad188cfc-8b4f-4c56-a47a-1cb25fda94cf, Method: GET, Path: /test-user-endpoints.html, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:02:31.161 +07:00 [INF] HTTP Response - RequestId: ad188cfc-8b4f-4c56-a47a-1cb25fda94cf, StatusCode: 404, ContentLength: null, ElapsedMs: 128
2025-05-24 16:02:31.166 +07:00 [WRN] Performance Metric - Method: GET, Path: /test-user-endpoints.html, StatusCode: 404, ElapsedMs: 135, Category: Good
2025-05-24 16:02:31.172 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/test-user-endpoints.html - 404 0 null 165.3015ms
2025-05-24 16:02:31.181 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/test-user-endpoints.html, Response status code: 404
2025-05-24 16:02:40.223 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/home - null null
2025-05-24 16:02:40.234 +07:00 [INF] HTTP Request - RequestId: 4ded6b42-8048-4acc-9713-bc320b42c41b, Method: GET, Path: /home, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:02:40.244 +07:00 [INF] HTTP Response - RequestId: 4ded6b42-8048-4acc-9713-bc320b42c41b, StatusCode: 404, ContentLength: null, ElapsedMs: 10
2025-05-24 16:02:40.251 +07:00 [WRN] Performance Metric - Method: GET, Path: /home, StatusCode: 404, ElapsedMs: 17, Category: Excellent
2025-05-24 16:02:40.256 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/home - 404 0 null 33.713ms
2025-05-24 16:02:40.263 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/home, Response status code: 404
2025-05-24 16:02:41.828 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:02:41.838 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 10.8122ms
2025-05-24 16:02:41.982 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:02:42.031 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 49.4288ms
2025-05-24 16:02:50.782 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/test-token - null 0
2025-05-24 16:02:50.793 +07:00 [INF] HTTP Request - RequestId: 7c6156fe-8e34-47dd-a13b-191b1564ce95, Method: POST, Path: /api/Auth/test-token, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:02:50.802 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:02:50.805 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:02:50.815 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:02:50.852 +07:00 [INF] Route matched with {action = "GenerateTestToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GenerateTestToken() on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:02:50.908 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:02:51.012 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-24 16:02:51.072 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:02:51.138 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim) in 276.9531ms
2025-05-24 16:02:51.142 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:02:51.146 +07:00 [INF] HTTP Response - RequestId: 7c6156fe-8e34-47dd-a13b-191b1564ce95, StatusCode: 200, ContentLength: null, ElapsedMs: 353
2025-05-24 16:02:51.157 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/test-token - 200 null application/json; charset=utf-8 375.7479ms
2025-05-24 16:03:23.606 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 16:03:25.463 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:03:25.538 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:03:25.548 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:03:25.555 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:03:25.588 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 16:03:25.619 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 16:03:25.919 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:03:25.951 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:03:25.962 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:03:26.115 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:03:26.194 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:03:26.201 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:03:26.231 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:03:26.368 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 16:03:26.373 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 16:03:26.377 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 16:03:26.390 +07:00 [INF] Performance Metrics - WorkingSet: 132.11MB, PrivateMemory: 71.70MB, GC Memory: 20.93MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 16:03:26.396 +07:00 [INF] MovieCacheService is starting.
2025-05-24 16:03:26.400 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 16:03:26.722 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 16:03:26.724 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 16:03:26.726 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 16:03:26.727 +07:00 [INF] Hosting environment: Development
2025-05-24 16:03:26.729 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 16:03:27.493 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 16:03:27.894 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 419.9559ms
2025-05-24 16:03:27.899 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:03:27.899 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 16:03:27.909 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 16:03:27.918 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 18.847ms
2025-05-24 16:03:27.930 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 31.1833ms
2025-05-24 16:03:28.008 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 99.3103ms
2025-05-24 16:03:28.104 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:03:28.434 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 329.9904ms
2025-05-24 16:03:37.451 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 84
2025-05-24 16:03:37.471 +07:00 [INF] HTTP Request - RequestId: f47a3ccd-52c9-48f4-babf-90c8c0ab9ad0, Method: POST, Path: /api/Auth/register, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:03:37.506 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:03:37.508 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:03:37.623 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:03:37.664 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WebAppApiPhim.Controllers.RegisterRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:03:37.753 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:03:37.787 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:03:37.850 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim) in 176.3407ms
2025-05-24 16:03:37.854 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:03:37.862 +07:00 [INF] HTTP Response - RequestId: f47a3ccd-52c9-48f4-babf-90c8c0ab9ad0, StatusCode: 400, ContentLength: null, ElapsedMs: 397
2025-05-24 16:03:37.867 +07:00 [WRN] Error Response - RequestId: f47a3ccd-52c9-48f4-babf-90c8c0ab9ad0, StatusCode: 400, Body: o  t]o~ *f "b;F)2]1ga|/ose/mK3;cZjSM0 ;Tas8CZY9pb+d6\P?bOY}Ml]i;#>
2025-05-24 16:03:37.873 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/register, StatusCode: 400, ElapsedMs: 409, Category: Good
2025-05-24 16:03:37.884 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 400 null application/json; charset=utf-8 433.911ms
2025-05-24 16:03:49.458 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 57
2025-05-24 16:03:49.466 +07:00 [INF] HTTP Request - RequestId: e67d68bd-a40e-4226-89e7-9f78720165b5, Method: POST, Path: /api/Auth/login, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:03:49.473 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:03:49.474 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:03:49.478 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:03:49.486 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(WebAppApiPhim.Controllers.LoginRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:03:49.599 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:03:49.609 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:03:49.612 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim) in 122.3661ms
2025-05-24 16:03:49.615 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:03:49.617 +07:00 [INF] HTTP Response - RequestId: e67d68bd-a40e-4226-89e7-9f78720165b5, StatusCode: 401, ContentLength: null, ElapsedMs: 150
2025-05-24 16:03:49.620 +07:00 [WRN] Error Response - RequestId: e67d68bd-a40e-4226-89e7-9f78720165b5, StatusCode: 401, Body: ({"success":false,"message":"Invalid email or password","data":null,"errors":null}
2025-05-24 16:03:49.623 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/login, StatusCode: 401, ElapsedMs: 156, Category: Good
2025-05-24 16:03:49.628 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 169.104ms
2025-05-24 16:04:00.518 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/test-token - null 0
2025-05-24 16:04:00.528 +07:00 [INF] HTTP Request - RequestId: 5dc7c693-29ba-41bf-9daf-f1df7fa07479, Method: POST, Path: /api/Auth/test-token, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:04:00.541 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:04:00.542 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:04:00.547 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:04:00.555 +07:00 [INF] Route matched with {action = "GenerateTestToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GenerateTestToken() on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:04:00.572 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:04:00.653 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-24 16:04:00.698 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:04:00.706 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim) in 147.2594ms
2025-05-24 16:04:00.709 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.GenerateTestToken (WebAppApiPhim)'
2025-05-24 16:04:00.711 +07:00 [INF] HTTP Response - RequestId: 5dc7c693-29ba-41bf-9daf-f1df7fa07479, StatusCode: 200, ContentLength: null, ElapsedMs: 182
2025-05-24 16:04:00.714 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/test-token - 200 null application/json; charset=utf-8 195.9568ms
2025-05-24 16:04:09.080 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/profile - null null
2025-05-24 16:04:09.086 +07:00 [INF] HTTP Request - RequestId: 41f5125d-780c-48af-9431-37581b4dd90d, Method: GET, Path: /api/User/profile, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:04:09.104 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 16:04:09.111 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 16:04:09.113 +07:00 [INF] HTTP Response - RequestId: 41f5125d-780c-48af-9431-37581b4dd90d, StatusCode: 401, ContentLength: null, ElapsedMs: 27
2025-05-24 16:04:09.116 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/profile, StatusCode: 401, ElapsedMs: 30, Category: Excellent
2025-05-24 16:04:09.120 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/profile - 401 0 null 40.6612ms
2025-05-24 16:04:23.605 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - null null
2025-05-24 16:04:23.612 +07:00 [INF] HTTP Request - RequestId: 1419ba39-aaab-4482-b37d-9bed46e21856, Method: GET, Path: /api/User/history, QueryString: ?page=1&limit=20, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:04:23.626 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 16:04:23.630 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 16:04:23.633 +07:00 [INF] HTTP Response - RequestId: 1419ba39-aaab-4482-b37d-9bed46e21856, StatusCode: 401, ContentLength: null, ElapsedMs: 20
2025-05-24 16:04:23.636 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/history, StatusCode: 401, ElapsedMs: 23, Category: Excellent
2025-05-24 16:04:23.640 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - 401 0 null 35.215ms
2025-05-24 16:04:25.186 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - null null
2025-05-24 16:04:25.191 +07:00 [INF] HTTP Request - RequestId: 1a0b886c-70ec-4955-9918-cea358f2b23b, Method: GET, Path: /api/User/history, QueryString: ?page=1&limit=20, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:04:25.199 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 16:04:25.201 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 16:04:25.203 +07:00 [INF] HTTP Response - RequestId: 1a0b886c-70ec-4955-9918-cea358f2b23b, StatusCode: 401, ContentLength: null, ElapsedMs: 12
2025-05-24 16:04:25.206 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/User/history, StatusCode: 401, ElapsedMs: 15, Category: Excellent
2025-05-24 16:04:25.210 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/User/history?page=1&limit=20 - 401 0 null 24.6994ms
2025-05-24 16:04:44.547 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - null 0
2025-05-24 16:04:44.553 +07:00 [INF] HTTP Request - RequestId: 27246574-af58-4b6d-b228-f81f4509a1f0, Method: POST, Path: /api/User/favorites/trieu-duong-chi-vu-da, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:04:44.559 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:04:44.561 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:04:44.564 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-05-24 16:04:44.567 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-05-24 16:04:44.570 +07:00 [INF] HTTP Response - RequestId: 27246574-af58-4b6d-b228-f81f4509a1f0, StatusCode: 401, ContentLength: null, ElapsedMs: 16
2025-05-24 16:04:44.574 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/User/favorites/trieu-duong-chi-vu-da, StatusCode: 401, ElapsedMs: 21, Category: Excellent
2025-05-24 16:04:44.580 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/User/favorites/trieu-duong-chi-vu-da - 401 0 null 33.2282ms
2025-05-24 16:08:45.077 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 16:08:46.913 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:08:46.981 +07:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:08:46.990 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:08:46.994 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:08:47.019 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 16:08:47.049 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 16:08:47.373 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:08:47.411 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:08:47.422 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:08:47.573 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:08:47.659 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:08:47.668 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:08:47.700 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:08:47.844 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 16:08:47.849 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 16:08:47.854 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 16:08:47.869 +07:00 [INF] Performance Metrics - WorkingSet: 131.70MB, PrivateMemory: 71.67MB, GC Memory: 20.93MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 16:08:47.875 +07:00 [INF] MovieCacheService is starting.
2025-05-24 16:08:47.878 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 16:08:48.231 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 16:08:48.233 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 16:08:48.236 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 16:08:48.238 +07:00 [INF] Hosting environment: Development
2025-05-24 16:08:48.240 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 16:08:48.808 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 16:08:49.192 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 405.8859ms
2025-05-24 16:08:49.196 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:08:49.215 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 16:08:49.196 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 16:08:49.237 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 41.6894ms
2025-05-24 16:08:49.246 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 50.5524ms
2025-05-24 16:08:49.341 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 126.8902ms
2025-05-24 16:08:49.409 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:08:49.666 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 257.6528ms
2025-05-24 16:08:56.247 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 84
2025-05-24 16:08:56.271 +07:00 [INF] HTTP Request - RequestId: 10b9363c-92be-4934-8607-c34b2cff6e9f, Method: POST, Path: /api/Auth/register, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:08:56.307 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:08:56.309 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:08:56.422 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:08:56.464 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(WebAppApiPhim.Controllers.RegisterRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:08:56.576 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:08:56.611 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:08:56.676 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim) in 202.8236ms
2025-05-24 16:08:56.680 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Register (WebAppApiPhim)'
2025-05-24 16:08:56.687 +07:00 [INF] HTTP Response - RequestId: 10b9363c-92be-4934-8607-c34b2cff6e9f, StatusCode: 400, ContentLength: null, ElapsedMs: 422
2025-05-24 16:08:56.691 +07:00 [WRN] Error Response - RequestId: 10b9363c-92be-4934-8607-c34b2cff6e9f, StatusCode: 400, Body: o  t]o~ *f "b;F)2]1ga|/ose/mK3;cZjSM0 ;Tas8CZY9pb+d6\P?bOY}Ml]i;#>
2025-05-24 16:08:56.696 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/register, StatusCode: 400, ElapsedMs: 434, Category: Good
2025-05-24 16:08:56.709 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 400 null application/json; charset=utf-8 462.5479ms
2025-05-24 16:09:05.144 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 57
2025-05-24 16:09:05.155 +07:00 [INF] HTTP Request - RequestId: f57305a7-4617-4bbb-9fbe-0d11d1712b5e, Method: POST, Path: /api/Auth/login, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:09:05.160 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:09:05.162 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:09:05.165 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:09:05.175 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(WebAppApiPhim.Controllers.LoginRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:09:05.309 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:09:05.316 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:09:05.319 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim) in 140.0058ms
2025-05-24 16:09:05.322 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:09:05.325 +07:00 [INF] HTTP Response - RequestId: f57305a7-4617-4bbb-9fbe-0d11d1712b5e, StatusCode: 401, ContentLength: null, ElapsedMs: 170
2025-05-24 16:09:05.329 +07:00 [WRN] Error Response - RequestId: f57305a7-4617-4bbb-9fbe-0d11d1712b5e, StatusCode: 401, Body: ({"success":false,"message":"Invalid email or password","data":null,"errors":null}
2025-05-24 16:09:05.332 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/login, StatusCode: 401, ElapsedMs: 178, Category: Good
2025-05-24 16:09:05.338 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 194.6628ms
2025-05-24 16:09:06.740 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 57
2025-05-24 16:09:06.745 +07:00 [INF] HTTP Request - RequestId: 97b8a08d-b4be-4b79-a86a-259006f28659, Method: POST, Path: /api/Auth/login, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 16:09:06.751 +07:00 [INF] CORS policy execution failed.
2025-05-24 16:09:06.752 +07:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-24 16:09:06.758 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:09:06.761 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(WebAppApiPhim.Controllers.LoginRequest) on controller WebAppApiPhim.Controllers.AuthController (WebAppApiPhim).
2025-05-24 16:09:06.782 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:09:06.788 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-24 16:09:06.791 +07:00 [INF] Executed action WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim) in 26.9335ms
2025-05-24 16:09:06.794 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.AuthController.Login (WebAppApiPhim)'
2025-05-24 16:09:06.797 +07:00 [INF] HTTP Response - RequestId: 97b8a08d-b4be-4b79-a86a-259006f28659, StatusCode: 401, ContentLength: null, ElapsedMs: 51
2025-05-24 16:09:06.801 +07:00 [WRN] Error Response - RequestId: 97b8a08d-b4be-4b79-a86a-259006f28659, StatusCode: 401, Body: ({"success":false,"message":"Invalid email or password","data":null,"errors":null}
2025-05-24 16:09:06.804 +07:00 [WRN] Performance Metric - Method: POST, Path: /api/Auth/login, StatusCode: 401, ElapsedMs: 59, Category: Excellent
2025-05-24 16:09:06.809 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 69.3445ms
2025-05-24 16:11:38.145 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 16:11:39.942 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:11:40.073 +07:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:11:40.082 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 16:11:40.087 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 16:11:40.113 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 16:11:40.156 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 16:11:40.462 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:11:40.501 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:11:40.513 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 16:11:40.690 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:11:40.777 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:11:40.784 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 16:11:40.813 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 16:11:40.981 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 16:11:40.986 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 16:11:40.992 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 16:11:41.006 +07:00 [INF] Performance Metrics - WorkingSet: 131.64MB, PrivateMemory: 71.59MB, GC Memory: 20.93MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 16:11:41.015 +07:00 [INF] MovieCacheService is starting.
2025-05-24 16:11:41.019 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 16:11:41.449 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 16:11:41.452 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 16:11:41.454 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 16:11:41.456 +07:00 [INF] Hosting environment: Development
2025-05-24 16:11:41.458 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 16:11:42.175 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 16:11:42.577 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 424.2134ms
2025-05-24 16:11:42.586 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 16:11:42.586 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 16:11:42.596 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 16:11:42.612 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 26.4569ms
2025-05-24 16:11:42.647 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 61.632ms
2025-05-24 16:11:42.714 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 119.0868ms
2025-05-24 16:11:42.802 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 16:11:43.101 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 299.7665ms
2025-05-24 17:57:50.463 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 17:57:55.861 +07:00 [INF] Executed DbCommand (205ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 17:57:55.983 +07:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 17:57:55.998 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 17:57:56.011 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 17:57:56.075 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 17:57:56.126 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-05-24 17:57:56.616 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 17:57:56.669 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 17:57:56.683 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 17:57:56.910 +07:00 [INF] Executed DbCommand (63ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 17:57:57.023 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 17:57:57.038 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 17:57:57.101 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 17:57:57.338 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 17:57:57.345 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 17:57:57.352 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 17:57:57.369 +07:00 [INF] Performance Metrics - WorkingSet: 134.88MB, PrivateMemory: 72.59MB, GC Memory: 20.95MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 17:57:57.378 +07:00 [INF] MovieCacheService is starting.
2025-05-24 17:57:57.384 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 17:57:58.051 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 17:57:58.054 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 17:57:58.057 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 17:57:58.059 +07:00 [INF] Hosting environment: Development
2025-05-24 17:57:58.061 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 17:57:59.811 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 17:58:00.237 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 442.4012ms
2025-05-24 17:58:00.293 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 17:58:00.293 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 17:58:00.295 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 17:58:00.306 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 12.9801ms
2025-05-24 17:58:00.336 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 39.9912ms
2025-05-24 17:58:00.431 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 136.5916ms
2025-05-24 17:58:00.495 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 17:58:00.791 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 296.7155ms
2025-05-24 17:58:15.940 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - null null
2025-05-24 17:58:15.965 +07:00 [INF] HTTP Request - RequestId: 68a1db4d-90f4-435c-b98a-7428f8a24e12, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 17:58:16.099 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 17:58:16.140 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 17:58:16.216 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=2
2025-05-24 17:58:16.228 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 17:58:16.255 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 17:58:16.611 +07:00 [INF] Received HTTP response headers after 349.689ms - 200
2025-05-24 17:58:16.622 +07:00 [INF] End processing HTTP request after 400.1861ms - 200
2025-05-24 17:58:16.725 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 17:58:16.730 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 17:58:16.733 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 17:58:16.833 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 17:58:16.839 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 17:58:16.841 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 17:58:16.944 +07:00 [INF] Received HTTP response headers after 208.7657ms - 200
2025-05-24 17:58:16.947 +07:00 [INF] End processing HTTP request after 216.5701ms - 200
2025-05-24 17:58:17.187 +07:00 [INF] Received HTTP response headers after 343.5713ms - 200
2025-05-24 17:58:17.190 +07:00 [INF] End processing HTTP request after 351.238ms - 200
2025-05-24 17:58:17.199 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 17:58:17.211 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 17:58:17.262 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 1113.4501ms
2025-05-24 17:58:17.266 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 17:58:17.272 +07:00 [INF] HTTP Response - RequestId: 68a1db4d-90f4-435c-b98a-7428f8a24e12, StatusCode: 200, ContentLength: null, ElapsedMs: 1316
2025-05-24 17:58:17.279 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=2 - 200 null application/json; charset=utf-8 1339.1652ms
2025-05-24 17:58:41.006 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh - null null
2025-05-24 17:58:41.029 +07:00 [INF] HTTP Request - RequestId: 4a717072-3243-4391-82b5-dd071ce116d7, Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 17:58:41.037 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 17:58:41.047 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 17:58:41.088 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 17:58:41.096 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:41.098 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 17:58:41.100 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 17:58:42.173 +07:00 [INF] Received HTTP response headers after 1070.2767ms - 200
2025-05-24 17:58:42.176 +07:00 [INF] End processing HTTP request after 1078.7461ms - 200
2025-05-24 17:58:42.357 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2332.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2332.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 17:58:42.398 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:42.400 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 17:58:42.402 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 17:58:42.721 +07:00 [INF] Received HTTP response headers after 316.9858ms - 200
2025-05-24 17:58:42.724 +07:00 [INF] End processing HTTP request after 323.9126ms - 200
2025-05-24 17:58:42.941 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 17:58:43.295 +07:00 [INF] Executed DbCommand (50ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 17:58:43.350 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:799c099a-4743-4075-bd5c-35f2bcd97d5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:799c099a-4743-4075-bd5c-35f2bcd97d5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 17:58:43.457 +07:00 [ERR] Error storing movie ve-thoi-nao-thieu-nu-truyen-tranh in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:799c099a-4743-4075-bd5c-35f2bcd97d5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
2025-05-24 17:58:43.550 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'MovieApiDb_Dev.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:799c099a-4743-4075-bd5c-35f2bcd97d5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 17:58:43.565 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:43.567 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 17:58:43.570 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 17:58:43.923 +07:00 [INF] Received HTTP response headers after 350.6063ms - 200
2025-05-24 17:58:43.926 +07:00 [INF] End processing HTTP request after 359.347ms - 200
2025-05-24 17:58:43.999 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 17:58:44.008 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:44.012 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 17:58:44.029 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 2978.5065ms
2025-05-24 17:58:44.033 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 17:58:44.035 +07:00 [INF] HTTP Response - RequestId: 4a717072-3243-4391-82b5-dd071ce116d7, StatusCode: 404, ContentLength: null, ElapsedMs: 3006
2025-05-24 17:58:44.039 +07:00 [WRN] Error Response - RequestId: 4a717072-3243-4391-82b5-dd071ce116d7, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 17:58:44.043 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, StatusCode: 404, ElapsedMs: 3014, Category: Very Slow
2025-05-24 17:58:44.053 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh - 404 null application/json; charset=utf-8 3046.7271ms
2025-05-24 17:58:48.596 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh?version=v1 - null null
2025-05-24 17:58:48.606 +07:00 [INF] HTTP Request - RequestId: 42583cb8-c3c3-4fb2-a2c2-3dcf7681174d, Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 17:58:48.617 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 17:58:48.620 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 17:58:48.627 +07:00 [INF] Cache hit for movie_detail_ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:48.666 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 17:58:48.693 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 17:58:48.699 +07:00 [INF] Cache hit for movie_detail_ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 17:58:48.715 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 17:58:48.738 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 17:58:48.794 +07:00 [ERR] Error processing episode data for movie ve-thoi-nao-thieu-nu-truyen-tranh
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 17:58:48.814 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-05-24 17:58:48.844 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 17:58:48.856 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 17:58:48.885 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 17:58:48.916 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 17:58:48.934 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 17:58:48.945 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 320.9427ms
2025-05-24 17:58:48.948 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 17:58:48.950 +07:00 [INF] HTTP Response - RequestId: 42583cb8-c3c3-4fb2-a2c2-3dcf7681174d, StatusCode: 200, ContentLength: null, ElapsedMs: 344
2025-05-24 17:58:48.954 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh?version=v1 - 200 null application/json; charset=utf-8 358.7095ms
2025-05-24 18:06:23.197 +07:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-24 18:06:25.598 +07:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 18:06:25.676 +07:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 18:06:25.685 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-24 18:06:25.690 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-24 18:06:25.723 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-24 18:06:25.751 +07:00 [INF] Applying migration '20250523142342_FixAvatarUrlNullable'.
2025-05-24 18:06:25.980 +07:00 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[AspNetUsers]') AND [c].[name] = N'DisplayName');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [AspNetUsers] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [AspNetUsers] ALTER COLUMN [DisplayName] nvarchar(200) NULL;
2025-05-24 18:06:26.026 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[AspNetUsers]') AND [c].[name] = N'AvatarUrl');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [AspNetUsers] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [AspNetUsers] ALTER COLUMN [AvatarUrl] nvarchar(500) NULL;
2025-05-24 18:06:26.037 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250523142342_FixAvatarUrlNullable', N'8.0.0');
2025-05-24 18:06:26.052 +07:00 [INF] Applying migration '20250524082854_AddTrailerUrlToCachedMovie'.
2025-05-24 18:06:26.177 +07:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Type');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Type] nvarchar(100) NULL;
2025-05-24 18:06:26.214 +07:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'RawData');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [RawData] ntext NULL;
2025-05-24 18:06:26.263 +07:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Quality');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Quality] nvarchar(50) NULL;
2025-05-24 18:06:26.305 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Language');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Language] nvarchar(50) NULL;
2025-05-24 18:06:26.347 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Genres');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Genres] nvarchar(500) NULL;
2025-05-24 18:06:26.383 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Duration');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Duration] nvarchar(50) NULL;
2025-05-24 18:06:26.423 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Director');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Director] nvarchar(500) NULL;
2025-05-24 18:06:26.461 +07:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Description');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var9 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Description] ntext NULL;
2025-05-24 18:06:26.506 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Country');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var10 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Country] nvarchar(200) NULL;
2025-05-24 18:06:26.542 +07:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[CachedMovies]') AND [c].[name] = N'Actors');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [CachedMovies] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [CachedMovies] ALTER COLUMN [Actors] nvarchar(1000) NULL;
2025-05-24 18:06:26.550 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [CachedMovies] ADD [TrailerUrl] nvarchar(1000) NULL;
2025-05-24 18:06:26.561 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250524082854_AddTrailerUrlToCachedMovie', N'8.0.0');
2025-05-24 18:06:26.966 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Genres] AS [g]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 18:06:27.324 +07:00 [INF] Executed DbCommand (56ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 1000), @p2='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p4='?' (Size = 200), @p5='?' (Size = 500), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (Size = 1000), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (Size = 200), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (DbType = DateTime2), @p15='?' (Size = 1000), @p16='?' (DbType = Boolean), @p17='?' (DbType = Int32), @p18='?' (Size = 200), @p19='?' (Size = 500), @p20='?' (DbType = DateTime2), @p21='?' (DbType = DateTime2), @p22='?' (Size = 1000), @p23='?' (DbType = Boolean), @p24='?' (DbType = Int32), @p25='?' (Size = 200), @p26='?' (Size = 500), @p27='?' (DbType = DateTime2), @p28='?' (DbType = DateTime2), @p29='?' (Size = 1000), @p30='?' (DbType = Boolean), @p31='?' (DbType = Int32), @p32='?' (Size = 200), @p33='?' (Size = 500), @p34='?' (DbType = DateTime2), @p35='?' (DbType = DateTime2), @p36='?' (Size = 1000), @p37='?' (DbType = Boolean), @p38='?' (DbType = Int32), @p39='?' (Size = 200), @p40='?' (Size = 500), @p41='?' (DbType = DateTime2), @p42='?' (DbType = DateTime2), @p43='?' (Size = 1000), @p44='?' (DbType = Boolean), @p45='?' (DbType = Int32), @p46='?' (Size = 200), @p47='?' (Size = 500), @p48='?' (DbType = DateTime2), @p49='?' (DbType = DateTime2), @p50='?' (Size = 1000), @p51='?' (DbType = Boolean), @p52='?' (DbType = Int32), @p53='?' (Size = 200), @p54='?' (Size = 500), @p55='?' (DbType = DateTime2), @p56='?' (DbType = DateTime2), @p57='?' (Size = 1000), @p58='?' (DbType = Boolean), @p59='?' (DbType = Int32), @p60='?' (Size = 200), @p61='?' (Size = 500), @p62='?' (DbType = DateTime2), @p63='?' (DbType = DateTime2), @p64='?' (Size = 1000), @p65='?' (DbType = Boolean), @p66='?' (DbType = Int32), @p67='?' (Size = 200), @p68='?' (Size = 500), @p69='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Genres] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2),
(@p21, @p22, @p23, @p24, @p25, @p26, @p27, 3),
(@p28, @p29, @p30, @p31, @p32, @p33, @p34, 4),
(@p35, @p36, @p37, @p38, @p39, @p40, @p41, 5),
(@p42, @p43, @p44, @p45, @p46, @p47, @p48, 6),
(@p49, @p50, @p51, @p52, @p53, @p54, @p55, 7),
(@p56, @p57, @p58, @p59, @p60, @p61, @p62, 8),
(@p63, @p64, @p65, @p66, @p67, @p68, @p69, 9)) AS i ([CreatedAt], [Description], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt])
VALUES (i.[CreatedAt], i.[Description], i.[IsActive], i.[MovieCount], i.[Name], i.[Slug], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 18:06:27.379 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Countries] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 18:06:27.442 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 10), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p4='?' (Size = 200), @p5='?' (Size = 500), @p6='?' (DbType = DateTime2), @p7='?' (Size = 10), @p8='?' (DbType = DateTime2), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (Size = 200), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (Size = 10), @p15='?' (DbType = DateTime2), @p16='?' (DbType = Boolean), @p17='?' (DbType = Int32), @p18='?' (Size = 200), @p19='?' (Size = 500), @p20='?' (DbType = DateTime2), @p21='?' (Size = 10), @p22='?' (DbType = DateTime2), @p23='?' (DbType = Boolean), @p24='?' (DbType = Int32), @p25='?' (Size = 200), @p26='?' (Size = 500), @p27='?' (DbType = DateTime2), @p28='?' (Size = 10), @p29='?' (DbType = DateTime2), @p30='?' (DbType = Boolean), @p31='?' (DbType = Int32), @p32='?' (Size = 200), @p33='?' (Size = 500), @p34='?' (DbType = DateTime2), @p35='?' (Size = 10), @p36='?' (DbType = DateTime2), @p37='?' (DbType = Boolean), @p38='?' (DbType = Int32), @p39='?' (Size = 200), @p40='?' (Size = 500), @p41='?' (DbType = DateTime2), @p42='?' (Size = 10), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Boolean), @p45='?' (DbType = Int32), @p46='?' (Size = 200), @p47='?' (Size = 500), @p48='?' (DbType = DateTime2), @p49='?' (Size = 10), @p50='?' (DbType = DateTime2), @p51='?' (DbType = Boolean), @p52='?' (DbType = Int32), @p53='?' (Size = 200), @p54='?' (Size = 500), @p55='?' (DbType = DateTime2), @p56='?' (Size = 10), @p57='?' (DbType = DateTime2), @p58='?' (DbType = Boolean), @p59='?' (DbType = Int32), @p60='?' (Size = 200), @p61='?' (Size = 500), @p62='?' (DbType = DateTime2), @p63='?' (Size = 10), @p64='?' (DbType = DateTime2), @p65='?' (DbType = Boolean), @p66='?' (DbType = Int32), @p67='?' (Size = 200), @p68='?' (Size = 500), @p69='?' (DbType = DateTime2), @p70='?' (Size = 10), @p71='?' (DbType = DateTime2), @p72='?' (DbType = Boolean), @p73='?' (DbType = Int32), @p74='?' (Size = 200), @p75='?' (Size = 500), @p76='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Countries] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2),
(@p21, @p22, @p23, @p24, @p25, @p26, @p27, 3),
(@p28, @p29, @p30, @p31, @p32, @p33, @p34, 4),
(@p35, @p36, @p37, @p38, @p39, @p40, @p41, 5),
(@p42, @p43, @p44, @p45, @p46, @p47, @p48, 6),
(@p49, @p50, @p51, @p52, @p53, @p54, @p55, 7),
(@p56, @p57, @p58, @p59, @p60, @p61, @p62, 8),
(@p63, @p64, @p65, @p66, @p67, @p68, @p69, 9),
(@p70, @p71, @p72, @p73, @p74, @p75, @p76, 10)) AS i ([Code], [CreatedAt], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Code], [CreatedAt], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt])
VALUES (i.[Code], i.[CreatedAt], i.[IsActive], i.[MovieCount], i.[Name], i.[Slug], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 18:06:27.457 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MovieTypes] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-24 18:06:27.501 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 1000), @p2='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p4='?' (Size = 200), @p5='?' (Size = 500), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (Size = 1000), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (Size = 200), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (DbType = DateTime2), @p15='?' (Size = 1000), @p16='?' (DbType = Boolean), @p17='?' (DbType = Int32), @p18='?' (Size = 200), @p19='?' (Size = 500), @p20='?' (DbType = DateTime2), @p21='?' (DbType = DateTime2), @p22='?' (Size = 1000), @p23='?' (DbType = Boolean), @p24='?' (DbType = Int32), @p25='?' (Size = 200), @p26='?' (Size = 500), @p27='?' (DbType = DateTime2), @p28='?' (DbType = DateTime2), @p29='?' (Size = 1000), @p30='?' (DbType = Boolean), @p31='?' (DbType = Int32), @p32='?' (Size = 200), @p33='?' (Size = 500), @p34='?' (DbType = DateTime2), @p35='?' (DbType = DateTime2), @p36='?' (Size = 1000), @p37='?' (DbType = Boolean), @p38='?' (DbType = Int32), @p39='?' (Size = 200), @p40='?' (Size = 500), @p41='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [MovieTypes] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2),
(@p21, @p22, @p23, @p24, @p25, @p26, @p27, 3),
(@p28, @p29, @p30, @p31, @p32, @p33, @p34, 4),
(@p35, @p36, @p37, @p38, @p39, @p40, @p41, 5)) AS i ([CreatedAt], [Description], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Description], [IsActive], [MovieCount], [Name], [Slug], [UpdatedAt])
VALUES (i.[CreatedAt], i.[Description], i.[IsActive], i.[MovieCount], i.[Name], i.[Slug], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-24 18:06:27.619 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.644 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.731 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetRoles] ([Id], [ConcurrencyStamp], [Name], [NormalizedName])
VALUES (@p0, @p1, @p2, @p3);
2025-05-24 18:06:27.755 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.763 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.771 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetRoles] ([Id], [ConcurrencyStamp], [Name], [NormalizedName])
VALUES (@p0, @p1, @p2, @p3);
2025-05-24 18:06:27.779 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.787 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-24 18:06:27.796 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetRoles] ([Id], [ConcurrencyStamp], [Name], [NormalizedName])
VALUES (@p0, @p1, @p2, @p3);
2025-05-24 18:06:27.835 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-05-24 18:06:28.020 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-24 18:06:28.137 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 500), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 200), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = Boolean), @p19='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [AvatarUrl], [ConcurrencyStamp], [CreatedAt], [DisplayName], [Email], [EmailConfirmed], [IsActive], [LastLoginAt], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
2025-05-24 18:06:28.164 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-05-24 18:06:28.237 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-05-24 18:06:28.251 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-05-24 18:06:28.282 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AvatarUrl], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[DisplayName], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastLoginAt], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-24 18:06:28.334 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p21='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 500), @p4='?' (Size = 4000), @p22='?' (Size = 4000), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (Size = 256), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTime2), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?' (Size = 256), @p14='?' (Size = 256), @p15='?' (Size = 4000), @p16='?' (Size = 4000), @p17='?' (DbType = Boolean), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [AvatarUrl] = @p3, [ConcurrencyStamp] = @p4, [CreatedAt] = @p5, [DisplayName] = @p6, [Email] = @p7, [EmailConfirmed] = @p8, [IsActive] = @p9, [LastLoginAt] = @p10, [LockoutEnabled] = @p11, [LockoutEnd] = @p12, [NormalizedEmail] = @p13, [NormalizedUserName] = @p14, [PasswordHash] = @p15, [PhoneNumber] = @p16, [PhoneNumberConfirmed] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UserName] = @p20
OUTPUT 1
WHERE [Id] = @p21 AND [ConcurrencyStamp] = @p22;
2025-05-24 18:06:28.427 +07:00 [INF] Enhanced Movie Cache Service is starting.
2025-05-24 18:06:28.434 +07:00 [INF] Image Cleanup Service is starting.
2025-05-24 18:06:28.440 +07:00 [INF] Performance Monitoring Service is starting.
2025-05-24 18:06:28.456 +07:00 [INF] Performance Metrics - WorkingSet: 147.64MB, PrivateMemory: 83.70MB, GC Memory: 29.61MB, GC Collections - Gen0: 0, Gen1: 0, Gen2: 0
2025-05-24 18:06:28.464 +07:00 [INF] MovieCacheService is starting.
2025-05-24 18:06:28.468 +07:00 [INF] CacheCleanupService is starting.
2025-05-24 18:06:28.992 +07:00 [INF] Now listening on: https://localhost:7056
2025-05-24 18:06:28.994 +07:00 [INF] Now listening on: http://localhost:5268
2025-05-24 18:06:28.997 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-24 18:06:28.998 +07:00 [INF] Hosting environment: Development
2025-05-24 18:06:29.000 +07:00 [INF] Content root path: C:\D\Leaning\API\APICode\WebAppApiPhim
2025-05-24 18:06:29.906 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.html - null null
2025-05-24 18:06:30.424 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.html - 200 null text/html;charset=utf-8 534.6008ms
2025-05-24 18:06:30.474 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_vs/browserLink - null null
2025-05-24 18:06:30.474 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - null null
2025-05-24 18:06:30.474 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/index.js - null null
2025-05-24 18:06:30.539 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/index.js - 200 null application/javascript;charset=utf-8 64.9335ms
2025-05-24 18:06:30.548 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 74.168ms
2025-05-24 18:06:30.626 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/_vs/browserLink - 200 null text/javascript; charset=UTF-8 152.1867ms
2025-05-24 18:06:30.720 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-24 18:06:31.055 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 335.9345ms
2025-05-24 18:06:40.818 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=10 - null null
2025-05-24 18:06:40.844 +07:00 [INF] HTTP Request - RequestId: 107daed4-b277-4a93-8086-83cb555939ca, Method: GET, Path: /api/Movies/latest, QueryString: ?page=1&limit=10, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:06:40.984 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 18:06:41.032 +07:00 [INF] Route matched with {action = "GetLatestMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] GetLatestMovies(Int32, Int32, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:06:41.124 +07:00 [INF] Fetching latest movies from https://api.dulieuphim.ink/phim-moi/v1?page=1&limit=10
2025-05-24 18:06:41.138 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 18:06:41.171 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-moi/v1?*
2025-05-24 18:06:41.489 +07:00 [INF] Received HTTP response headers after 309.8377ms - 200
2025-05-24 18:06:41.500 +07:00 [INF] End processing HTTP request after 369.2239ms - 200
2025-05-24 18:06:41.603 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:41.610 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.613 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.733 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:41.745 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.750 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.752 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:41.753 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:41.770 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:41.770 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.776 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.780 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.782 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.785 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.787 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:41.818 +07:00 [INF] Received HTTP response headers after 202.0237ms - 200
2025-05-24 18:06:41.822 +07:00 [INF] End processing HTTP request after 212.7442ms - 200
2025-05-24 18:06:42.017 +07:00 [INF] Received HTTP response headers after 261.4037ms - 200
2025-05-24 18:06:42.020 +07:00 [INF] End processing HTTP request after 274.404ms - 200
2025-05-24 18:06:42.104 +07:00 [INF] Received HTTP response headers after 314.4852ms - 200
2025-05-24 18:06:42.108 +07:00 [INF] End processing HTTP request after 337.1777ms - 200
2025-05-24 18:06:42.133 +07:00 [INF] Received HTTP response headers after 337.2487ms - 200
2025-05-24 18:06:42.138 +07:00 [INF] End processing HTTP request after 362.6324ms - 200
2025-05-24 18:06:42.142 +07:00 [INF] Received HTTP response headers after 335.117ms - 200
2025-05-24 18:06:42.146 +07:00 [INF] End processing HTTP request after 365.4426ms - 200
2025-05-24 18:06:42.163 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:42.165 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:42.180 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.188 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:42.190 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.201 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.201 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:42.206 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.208 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.221 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.223 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.233 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:42.404 +07:00 [INF] Received HTTP response headers after 193.3275ms - 200
2025-05-24 18:06:42.407 +07:00 [INF] End processing HTTP request after 227.5909ms - 200
2025-05-24 18:06:42.429 +07:00 [INF] Received HTTP response headers after 202.8683ms - 200
2025-05-24 18:06:42.432 +07:00 [INF] End processing HTTP request after 241.838ms - 200
2025-05-24 18:06:42.455 +07:00 [INF] Received HTTP response headers after 214.346ms - 200
2025-05-24 18:06:42.459 +07:00 [INF] End processing HTTP request after 237.7088ms - 200
2025-05-24 18:06:42.480 +07:00 [INF] Received HTTP response headers after 244.5656ms - 200
2025-05-24 18:06:42.483 +07:00 [INF] End processing HTTP request after 277.1933ms - 200
2025-05-24 18:06:49.661 +07:00 [INF] Executed DbCommand (7,509ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:06:49.666 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:49.668 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:06:49.867 +07:00 [INF] Received HTTP response headers after 196.7977ms - 200
2025-05-24 18:06:49.869 +07:00 [INF] End processing HTTP request after 203.2757ms - 200
2025-05-24 18:06:49.880 +07:00 [INF] Successfully fetched latest movies using v1
2025-05-24 18:06:49.895 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:06:49.956 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim) in 8912.7285ms
2025-05-24 18:06:49.959 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetLatestMovies (WebAppApiPhim)'
2025-05-24 18:06:49.967 +07:00 [INF] HTTP Response - RequestId: 107daed4-b277-4a93-8086-83cb555939ca, StatusCode: 200, ContentLength: null, ElapsedMs: 9130
2025-05-24 18:06:49.970 +07:00 [WRN] Slow Request Detected - RequestId: 107daed4-b277-4a93-8086-83cb555939ca, ElapsedMs: 9130, Path: /api/Movies/latest, Method: GET
2025-05-24 18:06:49.976 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/latest, StatusCode: 200, ElapsedMs: 9142, Category: Critical
2025-05-24 18:06:49.983 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/latest?page=1&limit=10 - 200 null application/json; charset=utf-8 9165.3979ms
2025-05-24 18:07:37.955 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/rai-tim-in-dau-phan-1?version=v1 - null null
2025-05-24 18:07:37.971 +07:00 [INF] HTTP Request - RequestId: 501e98fb-5928-48cd-8457-c8776b20107c, Method: GET, Path: /api/Movies/rai-tim-in-dau-phan-1, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:07:37.978 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:07:37.986 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:07:38.019 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:07:38.023 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=rai-tim-in-dau-phan-1
2025-05-24 18:07:38.025 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:07:38.027 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:07:38.486 +07:00 [INF] Received HTTP response headers after 457.2723ms - 200
2025-05-24 18:07:38.488 +07:00 [INF] End processing HTTP request after 463.4657ms - 200
2025-05-24 18:07:38.652 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:07:38.788 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
2025-05-24 18:07:38.890 +07:00 [WRN] Error fetching movie detail with v1: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 18:07:38.896 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: rai-tim-in-dau-phan-1
2025-05-24 18:07:38.899 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:07:38.910 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 921.0731ms
2025-05-24 18:07:38.912 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:07:38.914 +07:00 [INF] HTTP Response - RequestId: 501e98fb-5928-48cd-8457-c8776b20107c, StatusCode: 404, ContentLength: null, ElapsedMs: 942
2025-05-24 18:07:38.917 +07:00 [WRN] Error Response - RequestId: 501e98fb-5928-48cd-8457-c8776b20107c, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:07:38.920 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/rai-tim-in-dau-phan-1, StatusCode: 404, ElapsedMs: 948, Category: Acceptable
2025-05-24 18:07:38.927 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/rai-tim-in-dau-phan-1?version=v1 - 404 null application/json; charset=utf-8 972.4259ms
2025-05-24 18:07:48.920 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/rai-tim-in-dau-phan-1?version=v2 - null null
2025-05-24 18:07:48.932 +07:00 [INF] HTTP Request - RequestId: a29ae1de-176b-4e0b-8514-569da5158d27, Method: GET, Path: /api/Movies/rai-tim-in-dau-phan-1, QueryString: ?version=v2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:07:48.942 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:07:48.944 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:07:48.949 +07:00 [INF] Cache hit for movie_detail_rai-tim-in-dau-phan-1
2025-05-24 18:07:48.986 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:07:49.013 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 18:07:49.018 +07:00 [INF] Cache hit for movie_detail_rai-tim-in-dau-phan-1
2025-05-24 18:07:49.033 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE 0 = 1
2025-05-24 18:07:49.076 +07:00 [ERR] Error caching movie 
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.StreamingService.CacheMovieAsync(MovieDetailResponse movieDetail) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 83
2025-05-24 18:07:49.145 +07:00 [ERR] Error getting episodes for movie rai-tim-in-dau-phan-1
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.StreamingService.CacheMovieAsync(MovieDetailResponse movieDetail) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 83
   at WebAppApiPhim.Services.StreamingService.GetEpisodesAsync(String slug) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 140
2025-05-24 18:07:49.158 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:07:49.172 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 18:07:49.229 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 18:07:49.274 +07:00 [ERR] Error incrementing view count for movie rai-tim-in-dau-phan-1
System.InvalidOperationException: Unable to modify a row in table 'CachedMovies' because its key column 'Slug' is null.
   at Microsoft.EntityFrameworkCore.Update.Internal.SimpleRowKeyValueFactory`1.CreateKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.RowForeignKeyValueFactory`2.CreatePrincipalEquatableKeyValue(IReadOnlyModificationCommand command, Boolean fromOriginalValues)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.AddForeignKeyEdges()
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.TopologicalSort(IEnumerable`1 commands)
   at Microsoft.EntityFrameworkCore.Update.Internal.CommandBatchPreparer.BatchCommands(IList`1 entries, IUpdateAdapter updateAdapter)+MoveNext()
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.StreamingService.IncrementViewCountAsync(String slug) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 309
2025-05-24 18:07:49.282 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:07:49.292 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 344.8538ms
2025-05-24 18:07:49.294 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:07:49.297 +07:00 [INF] HTTP Response - RequestId: a29ae1de-176b-4e0b-8514-569da5158d27, StatusCode: 200, ContentLength: null, ElapsedMs: 365
2025-05-24 18:07:49.300 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/rai-tim-in-dau-phan-1?version=v2 - 200 null application/json; charset=utf-8 380.0953ms
2025-05-24 18:08:05.194 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trai-tim-in-dau-phan-1?version=v1 - null null
2025-05-24 18:08:05.200 +07:00 [INF] HTTP Request - RequestId: 0805682f-3698-4800-8976-1a7c05ef265d, Method: GET, Path: /api/Movies/trai-tim-in-dau-phan-1, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:08:05.204 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:05.206 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:08:05.214 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:08:05.220 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trai-tim-in-dau-phan-1
2025-05-24 18:08:05.221 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:05.223 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:05.593 +07:00 [INF] Received HTTP response headers after 368.849ms - 200
2025-05-24 18:08:05.596 +07:00 [INF] End processing HTTP request after 375.5827ms - 200
2025-05-24 18:08:05.726 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1057.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1057.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 18:08:05.735 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: trai-tim-in-dau-phan-1
2025-05-24 18:08:05.736 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:08:05.739 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 529.758ms
2025-05-24 18:08:05.741 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:05.743 +07:00 [INF] HTTP Response - RequestId: 0805682f-3698-4800-8976-1a7c05ef265d, StatusCode: 404, ContentLength: null, ElapsedMs: 543
2025-05-24 18:08:05.746 +07:00 [WRN] Error Response - RequestId: 0805682f-3698-4800-8976-1a7c05ef265d, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:08:05.749 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/trai-tim-in-dau-phan-1, StatusCode: 404, ElapsedMs: 549, Category: Acceptable
2025-05-24 18:08:05.753 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trai-tim-in-dau-phan-1?version=v1 - 404 null application/json; charset=utf-8 559.0779ms
2025-05-24 18:08:10.155 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/trai-tim-in-dau-phan-1 - null null
2025-05-24 18:08:10.161 +07:00 [INF] HTTP Request - RequestId: cd997911-43d6-48c4-809b-954df6b5aa5a, Method: GET, Path: /api/Movies/trai-tim-in-dau-phan-1, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:08:10.166 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:10.168 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:08:10.175 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:08:10.182 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=trai-tim-in-dau-phan-1
2025-05-24 18:08:10.183 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:10.185 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:10.279 +07:00 [INF] Received HTTP response headers after 92.4399ms - 200
2025-05-24 18:08:10.282 +07:00 [INF] End processing HTTP request after 98.4435ms - 200
2025-05-24 18:08:10.342 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1057.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 1057.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 18:08:10.348 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=trai-tim-in-dau-phan-1
2025-05-24 18:08:10.349 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 18:08:10.351 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 18:08:10.682 +07:00 [INF] Received HTTP response headers after 329.2071ms - 200
2025-05-24 18:08:10.684 +07:00 [INF] End processing HTTP request after 334.8176ms - 200
2025-05-24 18:08:10.689 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:08:10.733 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
2025-05-24 18:08:10.816 +07:00 [WRN] Error fetching movie detail with v3: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 18:08:10.822 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=trai-tim-in-dau-phan-1
2025-05-24 18:08:10.824 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:08:10.826 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:08:11.162 +07:00 [INF] Received HTTP response headers after 334.308ms - 200
2025-05-24 18:08:11.164 +07:00 [INF] End processing HTTP request after 340.7312ms - 200
2025-05-24 18:08:11.169 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE 0 = 1
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:08:11.212 +07:00 [ERR] Error storing movie  in database
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
2025-05-24 18:08:11.297 +07:00 [WRN] Error fetching movie detail with v2: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
System.InvalidOperationException: Unable to track an entity of type 'CachedMovie' because alternate key property 'Slug' is null. If the alternate key is not used in a relationship, then consider using a unique index instead. Unique indexes may contain nulls, while alternate keys may not.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 686
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 18:08:11.303 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: trai-tim-in-dau-phan-1
2025-05-24 18:08:11.305 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:08:11.308 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 1136.1243ms
2025-05-24 18:08:11.310 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:11.312 +07:00 [INF] HTTP Response - RequestId: cd997911-43d6-48c4-809b-954df6b5aa5a, StatusCode: 404, ContentLength: null, ElapsedMs: 1151
2025-05-24 18:08:11.315 +07:00 [WRN] Error Response - RequestId: cd997911-43d6-48c4-809b-954df6b5aa5a, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:08:11.318 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/trai-tim-in-dau-phan-1, StatusCode: 404, ElapsedMs: 1157, Category: Slow
2025-05-24 18:08:11.323 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/trai-tim-in-dau-phan-1 - 404 null application/json; charset=utf-8 1167.8814ms
2025-05-24 18:08:36.508 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh - null null
2025-05-24 18:08:36.530 +07:00 [INF] HTTP Request - RequestId: 4ac42013-f387-4aa2-a215-89f31f9d0b66, Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, QueryString: , ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:08:36.534 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:36.536 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:08:36.545 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:08:36.549 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:36.550 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:36.552 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:08:37.000 +07:00 [INF] Received HTTP response headers after 446.0258ms - 200
2025-05-24 18:08:37.002 +07:00 [INF] End processing HTTP request after 451.985ms - 200
2025-05-24 18:08:37.080 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2332.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 2332.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Utf8JsonReader.GetString()
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 18:08:37.086 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v3?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:37.087 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 18:08:37.090 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v3?*
2025-05-24 18:08:37.425 +07:00 [INF] Received HTTP response headers after 334.2114ms - 200
2025-05-24 18:08:37.428 +07:00 [INF] End processing HTTP request after 340.4681ms - 200
2025-05-24 18:08:37.451 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:08:37.534 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 18:08:37.555 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1850a138-a8cf-498a-bbe1-07ecd56b5e30
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1850a138-a8cf-498a-bbe1-07ecd56b5e30
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 18:08:37.653 +07:00 [ERR] Error storing movie ve-thoi-nao-thieu-nu-truyen-tranh in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1850a138-a8cf-498a-bbe1-07ecd56b5e30
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
2025-05-24 18:08:37.755 +07:00 [WRN] Error fetching movie detail with v3: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1850a138-a8cf-498a-bbe1-07ecd56b5e30
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 18:08:37.768 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:37.769 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:08:37.771 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:08:38.115 +07:00 [INF] Received HTTP response headers after 341.3489ms - 200
2025-05-24 18:08:38.117 +07:00 [INF] End processing HTTP request after 347.8567ms - 200
2025-05-24 18:08:38.187 +07:00 [WRN] Error fetching movie detail with v2: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.tmdb_season | LineNumber: 0 | BytePositionInLine: 81.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 18:08:38.194 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:38.196 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:08:38.199 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 1660.1778ms
2025-05-24 18:08:38.202 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:38.204 +07:00 [INF] HTTP Response - RequestId: 4ac42013-f387-4aa2-a215-89f31f9d0b66, StatusCode: 404, ContentLength: null, ElapsedMs: 1673
2025-05-24 18:08:38.208 +07:00 [WRN] Error Response - RequestId: 4ac42013-f387-4aa2-a215-89f31f9d0b66, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:08:38.211 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, StatusCode: 404, ElapsedMs: 1680, Category: Slow
2025-05-24 18:08:38.216 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh - 404 null application/json; charset=utf-8 1707.8681ms
2025-05-24 18:08:43.461 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh?version=v1 - null null
2025-05-24 18:08:43.465 +07:00 [INF] HTTP Request - RequestId: f5093455-5868-4005-8048-33577e0ccd7f, Method: GET, Path: /api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:08:43.477 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:43.480 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:08:43.484 +07:00 [INF] Cache hit for movie_detail_ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:43.493 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:08:43.501 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 18:08:43.504 +07:00 [INF] Cache hit for movie_detail_ve-thoi-nao-thieu-nu-truyen-tranh
2025-05-24 18:08:43.509 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 18:08:43.523 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 18:08:43.567 +07:00 [ERR] Error processing episode data for movie ve-thoi-nao-thieu-nu-truyen-tranh
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 18:08:43.578 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-05-24 18:08:43.586 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 18:08:43.593 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:08:43.607 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 18:08:43.626 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = 4000), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 18:08:43.634 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:08:43.637 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 153.6427ms
2025-05-24 18:08:43.639 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:08:43.641 +07:00 [INF] HTTP Response - RequestId: f5093455-5868-4005-8048-33577e0ccd7f, StatusCode: 200, ContentLength: null, ElapsedMs: 175
2025-05-24 18:08:43.644 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/ve-thoi-nao-thieu-nu-truyen-tranh?version=v1 - 200 null application/json; charset=utf-8 183.3792ms
2025-05-24 18:09:14.123 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/search?query=con%20trai%20ban%20me&page=1&limit=1 - null null
2025-05-24 18:09:14.146 +07:00 [INF] HTTP Request - RequestId: 3e90d424-df19-409d-ae7e-67105c444f5c, Method: GET, Path: /api/Movies/search, QueryString: ?query=con%20trai%20ban%20me&page=1&limit=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:09:14.152 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 18:09:14.160 +07:00 [INF] Route matched with {action = "SearchMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] SearchMovies(System.String, Int32, Int32) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:09:14.171 +07:00 [INF] Searching movies from https://api.dulieuphim.ink/phim-data/v1?name=con%20trai%20ban%20me&page=1&limit=1
2025-05-24 18:09:14.174 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 18:09:14.176 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-data/v1?*
2025-05-24 18:09:14.841 +07:00 [INF] Received HTTP response headers after 662.9343ms - 200
2025-05-24 18:09:14.844 +07:00 [INF] End processing HTTP request after 670.1935ms - 200
2025-05-24 18:09:14.854 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movie_Slug_0
2025-05-24 18:09:14.857 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:09:14.859 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/get-img/v2?*
2025-05-24 18:09:15.061 +07:00 [INF] Received HTTP response headers after 199.9567ms - 200
2025-05-24 18:09:15.064 +07:00 [INF] End processing HTTP request after 206.475ms - 200
2025-05-24 18:09:15.066 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:09:15.069 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim) in 905.381ms
2025-05-24 18:09:15.071 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 18:09:15.074 +07:00 [INF] HTTP Response - RequestId: 3e90d424-df19-409d-ae7e-67105c444f5c, StatusCode: 200, ContentLength: null, ElapsedMs: 927
2025-05-24 18:09:15.076 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/search?query=con%20trai%20ban%20me&page=1&limit=1 - 200 null application/json; charset=utf-8 953.643ms
2025-05-24 18:09:51.760 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v1 - null null
2025-05-24 18:09:51.783 +07:00 [INF] HTTP Request - RequestId: 4f939918-000f-4cbb-bb7b-6d24203762de, Method: GET, Path: /api/Movies/con-trai-ban-me, QueryString: ?version=v1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:09:51.789 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:09:51.791 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:09:51.801 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:09:51.806 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v1?slug=con-trai-ban-me
2025-05-24 18:09:51.807 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:09:51.810 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v1?*
2025-05-24 18:09:53.131 +07:00 [INF] Received HTTP response headers after 1319.1602ms - 200
2025-05-24 18:09:53.134 +07:00 [INF] End processing HTTP request after 1326.8432ms - 200
2025-05-24 18:09:53.200 +07:00 [WRN] Error fetching movie detail with v1: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 939.
System.Text.Json.JsonException: The JSON value could not be converted to System.String. Path: $.total_episodes | LineNumber: 0 | BytePositionInLine: 939.
 ---> System.InvalidOperationException: Cannot get the value of a token type 'Number' as a string.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_ExpectedString(JsonTokenType tokenType)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.ReadJsonAndSetMember(Object obj, ReadStack& state, Utf8JsonReader& reader)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value)
   at System.Text.Json.Serialization.JsonConverter`1.TryRead(Utf8JsonReader& reader, Type typeToConvert, JsonSerializerOptions options, ReadStack& state, T& value, Boolean& isPopulatedValue)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ReThrowWithPath(ReadStack& state, Utf8JsonReader& reader, Exception ex)
   at System.Text.Json.Serialization.JsonConverter`1.ReadCore(Utf8JsonReader& reader, JsonSerializerOptions options, ReadStack& state)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 utf8Json, JsonTypeInfo`1 jsonTypeInfo, Nullable`1 actualByteCount)
   at System.Text.Json.JsonSerializer.ReadFromSpan[TValue](ReadOnlySpan`1 json, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Deserialize[TValue](String json, JsonSerializerOptions options)
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 171
2025-05-24 18:09:53.207 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: con-trai-ban-me
2025-05-24 18:09:53.209 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:09:53.212 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 1417.4068ms
2025-05-24 18:09:53.215 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:09:53.217 +07:00 [INF] HTTP Response - RequestId: 4f939918-000f-4cbb-bb7b-6d24203762de, StatusCode: 404, ContentLength: null, ElapsedMs: 1433
2025-05-24 18:09:53.221 +07:00 [WRN] Error Response - RequestId: 4f939918-000f-4cbb-bb7b-6d24203762de, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:09:53.224 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/con-trai-ban-me, StatusCode: 404, ElapsedMs: 1440, Category: Slow
2025-05-24 18:09:53.228 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v1 - 404 null application/json; charset=utf-8 1469.2478ms
2025-05-24 18:09:58.497 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v2 - null null
2025-05-24 18:09:58.502 +07:00 [INF] HTTP Request - RequestId: f0cc5165-d6c8-4d17-a4f7-e71724a53baa, Method: GET, Path: /api/Movies/con-trai-ban-me, QueryString: ?version=v2, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:09:58.515 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:09:58.518 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:09:58.530 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:09:58.535 +07:00 [INF] Fetching movie detail from https://api.dulieuphim.ink/phim-chi-tiet/v2?slug=con-trai-ban-me
2025-05-24 18:09:58.536 +07:00 [INF] Start processing HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:09:58.538 +07:00 [INF] Sending HTTP request GET https://api.dulieuphim.ink/phim-chi-tiet/v2?*
2025-05-24 18:09:58.911 +07:00 [INF] Received HTTP response headers after 370.8112ms - 200
2025-05-24 18:09:58.913 +07:00 [INF] End processing HTTP request after 377.6171ms - 200
2025-05-24 18:09:58.930 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__movie_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__movie_Slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:09:58.945 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 18:09:58.956 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'WebAppApiPhim.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1977fcdf-f8a3-4df1-87f4-341b0dc36c5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1977fcdf-f8a3-4df1-87f4-341b0dc36c5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-24 18:09:59.023 +07:00 [ERR] Error storing movie con-trai-ban-me in database
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1977fcdf-f8a3-4df1-87f4-341b0dc36c5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
2025-05-24 18:09:59.118 +07:00 [WRN] Error fetching movie detail with v2: An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'OriginalName', table 'Phim.dbo.CachedMovies'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1977fcdf-f8a3-4df1-87f4-341b0dc36c5e
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at WebAppApiPhim.Services.MovieApiService.StoreMovieInDatabaseAsync(MovieDetailResponse movie) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 751
   at WebAppApiPhim.Services.MovieApiService.GetMovieDetailBySlugAsync(String slug, String version) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\MovieApiService.cs:line 182
2025-05-24 18:09:59.132 +07:00 [ERR] All API versions failed for GetMovieDetailBySlugAsync with slug: con-trai-ban-me
2025-05-24 18:09:59.134 +07:00 [INF] Executing NotFoundObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:09:59.136 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 613.2259ms
2025-05-24 18:09:59.138 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:09:59.140 +07:00 [INF] HTTP Response - RequestId: f0cc5165-d6c8-4d17-a4f7-e71724a53baa, StatusCode: 404, ContentLength: null, ElapsedMs: 637
2025-05-24 18:09:59.143 +07:00 [WRN] Error Response - RequestId: f0cc5165-d6c8-4d17-a4f7-e71724a53baa, StatusCode: 404, Body: #{"success":false,"message":"Movie not found","data":null,"errors":null}
2025-05-24 18:09:59.146 +07:00 [WRN] Performance Metric - Method: GET, Path: /api/Movies/con-trai-ban-me, StatusCode: 404, ElapsedMs: 643, Category: Acceptable
2025-05-24 18:09:59.151 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v2 - 404 null application/json; charset=utf-8 653.5772ms
2025-05-24 18:10:02.568 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v3 - null null
2025-05-24 18:10:02.572 +07:00 [INF] HTTP Request - RequestId: 8d9c0550-9ab7-47ea-ae10-b0b332be6f23, Method: GET, Path: /api/Movies/con-trai-ban-me, QueryString: ?version=v3, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:10:02.576 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:10:02.578 +07:00 [INF] Route matched with {action = "GetMovieDetail", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieDetailViewModel]]] GetMovieDetail(System.String, System.String) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:10:02.582 +07:00 [INF] Cache hit for movie_detail_con-trai-ban-me
2025-05-24 18:10:02.592 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Actors], [t].[Country], [t].[Description], [t].[Director], [t].[Duration], [t].[Genres], [t].[Language], [t].[LastUpdated], [t].[Name], [t].[OriginalName], [t].[PosterUrl], [t].[Quality], [t].[RawData], [t].[Slug], [t].[ThumbUrl], [t].[TrailerUrl], [t].[Type], [t].[ViewCount], [t].[Year], [t].[Id0], [c0].[Id], [c0].[EmbedUrl], [c0].[EpisodeName], [c0].[EpisodeSlug], [c0].[LastUpdated], [c0].[M3u8Url], [c0].[MovieSlug], [c0].[ServerName], [t].[AverageRating], [t].[CommentCount], [t].[FavoriteCount], [t].[LastUpdated0], [t].[MovieSlug], [t].[RatingCount], [t].[ViewCount0]
FROM (
    SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year], [m].[Id] AS [Id0], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated] AS [LastUpdated0], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount] AS [ViewCount0]
    FROM [CachedMovies] AS [c]
    LEFT JOIN [MovieStatistics] AS [m] ON [c].[Slug] = [m].[MovieSlug]
    WHERE [c].[Slug] = @__slug_0
) AS [t]
LEFT JOIN [CachedEpisodes] AS [c0] ON [t].[Slug] = [c0].[MovieSlug]
ORDER BY [t].[Id], [t].[Id0]
2025-05-24 18:10:02.599 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 18:10:02.602 +07:00 [INF] Cache hit for movie_detail_con-trai-ban-me
2025-05-24 18:10:02.606 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__movieDetail_Slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__movieDetail_Slug_0
2025-05-24 18:10:02.613 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__movieSlug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__movieSlug_0
2025-05-24 18:10:02.657 +07:00 [ERR] Error processing episode data for movie con-trai-ban-me
System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.
   at System.Text.Json.JsonElement.GetProperty(String propertyName)
   at WebAppApiPhim.Services.StreamingService.ProcessEpisodesAsync(String movieSlug, List`1 episodes) in C:\D\Leaning\API\APICode\WebAppApiPhim\Services\StreamingService.cs:line 338
2025-05-24 18:10:02.667 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 500), @p14='?' (Size = 1000), @p15='?' (Size = 1000), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CachedMovies] ([Actors], [Country], [Description], [Director], [Duration], [Genres], [Language], [LastUpdated], [Name], [OriginalName], [PosterUrl], [Quality], [RawData], [Slug], [ThumbUrl], [TrailerUrl], [Type], [ViewCount], [Year])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-05-24 18:10:02.673 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[EmbedUrl], [c].[EpisodeName], [c].[EpisodeSlug], [c].[LastUpdated], [c].[M3u8Url], [c].[MovieSlug], [c].[ServerName]
FROM [CachedEpisodes] AS [c]
WHERE [c].[MovieSlug] = @__slug_0
ORDER BY [c].[ServerName], [c].[EpisodeName]
2025-05-24 18:10:02.679 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Actors], [c].[Country], [c].[Description], [c].[Director], [c].[Duration], [c].[Genres], [c].[Language], [c].[LastUpdated], [c].[Name], [c].[OriginalName], [c].[PosterUrl], [c].[Quality], [c].[RawData], [c].[Slug], [c].[ThumbUrl], [c].[TrailerUrl], [c].[Type], [c].[ViewCount], [c].[Year]
FROM [CachedMovies] AS [c]
WHERE [c].[Slug] = @__slug_0
2025-05-24 18:10:02.686 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__slug_0='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[AverageRating], [m].[CommentCount], [m].[FavoriteCount], [m].[LastUpdated], [m].[MovieSlug], [m].[RatingCount], [m].[ViewCount]
FROM [MovieStatistics] AS [m]
WHERE [m].[MovieSlug] = @__slug_0
2025-05-24 18:10:02.699 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p18='?' (DbType = Int32), @p0='?' (Size = 1000), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (Size = 500), @p4='?' (Size = 50), @p5='?' (Size = 500), @p6='?' (Size = 50), @p7='?' (DbType = DateTime2), @p8='?' (Size = 500), @p9='?' (Size = 500), @p10='?' (Size = 1000), @p11='?' (Size = 50), @p12='?' (Size = -1), @p13='?' (Size = 1000), @p14='?' (Size = 1000), @p15='?' (Size = 100), @p16='?' (DbType = Int32), @p17='?' (Size = 10), @p19='?' (DbType = Double), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime2), @p23='?' (Size = 500), @p24='?' (DbType = Int32), @p25='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [CachedMovies] SET [Actors] = @p0, [Country] = @p1, [Description] = @p2, [Director] = @p3, [Duration] = @p4, [Genres] = @p5, [Language] = @p6, [LastUpdated] = @p7, [Name] = @p8, [OriginalName] = @p9, [PosterUrl] = @p10, [Quality] = @p11, [RawData] = @p12, [ThumbUrl] = @p13, [TrailerUrl] = @p14, [Type] = @p15, [ViewCount] = @p16, [Year] = @p17
OUTPUT 1
WHERE [Id] = @p18;
INSERT INTO [MovieStatistics] ([AverageRating], [CommentCount], [FavoriteCount], [LastUpdated], [MovieSlug], [RatingCount], [ViewCount])
OUTPUT INSERTED.[Id]
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-05-24 18:10:02.704 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieDetailViewModel, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:10:02.706 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim) in 124.7744ms
2025-05-24 18:10:02.708 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.GetMovieDetail (WebAppApiPhim)'
2025-05-24 18:10:02.710 +07:00 [INF] HTTP Response - RequestId: 8d9c0550-9ab7-47ea-ae10-b0b332be6f23, StatusCode: 200, ContentLength: null, ElapsedMs: 137
2025-05-24 18:10:02.713 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/con-trai-ban-me?version=v3 - 200 null application/json; charset=utf-8 145.3561ms
2025-05-24 18:10:38.143 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Movies/search?query=con%20trai%20ban%20me&page=1&limit=1 - null null
2025-05-24 18:10:38.167 +07:00 [INF] HTTP Request - RequestId: c17c3965-7792-486b-ba28-a4dc276830e9, Method: GET, Path: /api/Movies/search, QueryString: ?query=con%20trai%20ban%20me&page=1&limit=1, ClientIP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0, UserId: Anonymous
2025-05-24 18:10:38.172 +07:00 [INF] Executing endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 18:10:38.174 +07:00 [INF] Route matched with {action = "SearchMovies", controller = "Movies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[WebAppApiPhim.Models.ApiResponse`1[WebAppApiPhim.Models.MovieListResponse]]] SearchMovies(System.String, Int32, Int32) on controller WebAppApiPhim.Controllers.MoviesController (WebAppApiPhim).
2025-05-24 18:10:38.178 +07:00 [INF] Cache hit for search_movies_con trai ban me_1_1
2025-05-24 18:10:38.182 +07:00 [INF] Executing OkObjectResult, writing value of type 'WebAppApiPhim.Models.ApiResponse`1[[WebAppApiPhim.Models.MovieListResponse, WebAppApiPhim, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-24 18:10:38.184 +07:00 [INF] Executed action WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim) in 6.7921ms
2025-05-24 18:10:38.187 +07:00 [INF] Executed endpoint 'WebAppApiPhim.Controllers.MoviesController.SearchMovies (WebAppApiPhim)'
2025-05-24 18:10:38.189 +07:00 [INF] HTTP Response - RequestId: c17c3965-7792-486b-ba28-a4dc276830e9, StatusCode: 200, ContentLength: null, ElapsedMs: 22
2025-05-24 18:10:38.194 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Movies/search?query=con%20trai%20ban%20me&page=1&limit=1 - 200 null application/json; charset=utf-8 50.9812ms
